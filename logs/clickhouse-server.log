2025.01.05 00:04:42.125438 [ 1 ] {} <Information> SentryWriter: Sending crash reports is disabled
2025.01.05 00:04:42.125748 [ 1 ] {} <Trace> Pipe: Pipe capacity is 1.00 MiB
2025.01.05 00:04:42.221738 [ 1 ] {} <Information> Application: Starting ClickHouse 24.3.6.48 (revision: 54484, git hash: b2d33c3c45da4e215454c8abc631bf9f80d7d3a7, build id: BFCD7C77C469B755ADCCA3E131D51BA8233CE5B9), PID 1
2025.01.05 00:04:42.222191 [ 1 ] {} <Information> Application: starting up
2025.01.05 00:04:42.222920 [ 1 ] {} <Information> Application: OS name: Linux, version: 5.15.133.1-microsoft-standard-WSL2, architecture: x86_64
2025.01.05 00:04:42.229783 [ 1 ] {} <Information> Application: Available RAM: 7.68 GiB; physical cores: 16; logical cores: 16.
2025.01.05 00:04:42.230034 [ 1 ] {} <Information> Application: Available CPU instruction sets: SSE, SSE2, SSE3, SSSE3, SSE41, SSE42, F16C, POPCNT, BMI1, BMI2, PCLMUL, AES, AVX, FMA, AVX2, ADX, RDRAND, RDSEED, RDTSCP, CLFLUSHOPT, XSAVE, OSXSAVE
2025.01.05 00:04:42.230397 [ 1 ] {} <Trace> AsynchronousMetrics: Scanning /sys/class/thermal
2025.01.05 00:04:42.232744 [ 1 ] {} <Trace> AsynchronousMetrics: Scanning /sys/block
2025.01.05 00:04:42.239233 [ 1 ] {} <Trace> AsynchronousMetrics: Scanning /sys/devices/system/edac
2025.01.05 00:04:42.239497 [ 1 ] {} <Trace> AsynchronousMetrics: Scanning /sys/class/hwmon
2025.01.05 00:04:42.244301 [ 1 ] {} <Warning> Context: Linux is not using a fast clock source. Performance can be degraded. Check /sys/devices/system/clocksource/clocksource0/current_clocksource
2025.01.05 00:04:42.245354 [ 1 ] {} <Warning> Context: Linux transparent hugepages are set to "always". Check /sys/kernel/mm/transparent_hugepage/enabled
2025.01.05 00:04:42.247330 [ 1 ] {} <Warning> Context: Delay accounting is not enabled, OSIOWaitMicroseconds will not be gathered. You can enable it using `echo 1 > /proc/sys/kernel/task_delayacct` or by using sysctl.
2025.01.05 00:04:42.451675 [ 1 ] {} <Information> Application: Integrity check of the executable successfully passed (checksum: D34CDAEEFB528223A6C6224C30F54451)
2025.01.05 00:04:42.451972 [ 1 ] {} <Information> Application: It looks like the process has no CAP_IPC_LOCK capability, binary mlock will be disabled. It could happen due to incorrect ClickHouse package installation. You could resolve the problem manually with 'sudo setcap cap_ipc_lock=+ep /usr/bin/clickhouse'. Note that it will not work on 'nosuid' mounted filesystems.
2025.01.05 00:04:42.463855 [ 1 ] {} <Debug> Application: rlimit on number of file descriptors is 262144
2025.01.05 00:04:42.465323 [ 1 ] {} <Debug> Application: rlimit on number of threads is 18446744073709551615
2025.01.05 00:04:42.465530 [ 1 ] {} <Debug> Application: Initializing DateLUT.
2025.01.05 00:04:42.465708 [ 1 ] {} <Trace> Application: Initialized DateLUT with time zone 'UTC'.
2025.01.05 00:04:42.466559 [ 1 ] {} <Debug> Context: Setting up /var/lib/clickhouse/tmp/ to store temporary data in it
2025.01.05 00:04:42.498599 [ 1 ] {} <Debug> Application: Configuration parameter 'interserver_http_host' doesn't exist or exists and empty. Will use '3d7492cdf22e' as replica host.
2025.01.05 00:04:42.498804 [ 1 ] {} <Debug> Application: Initializing interserver credentials.
2025.01.05 00:04:42.499016 [ 1 ] {} <Information> Application: Lowered uncompressed cache size to 3.84 GiB because the system has limited RAM
2025.01.05 00:04:42.499285 [ 1 ] {} <Information> Application: Lowered mark cache size to 3.84 GiB because the system has limited RAM
2025.01.05 00:04:42.499621 [ 1 ] {} <Information> Application: Lowered index mark cache size to 3.84 GiB because the system has limited RAM
2025.01.05 00:04:42.499894 [ 1 ] {} <Trace> NamedCollectionsUtils: Loaded 0 collections from config
2025.01.05 00:04:42.505442 [ 1 ] {} <Trace> NamedCollectionsUtils: Loaded 0 collections from SQL
2025.01.05 00:04:42.506378 [ 1 ] {} <Information> CgroupsMemoryUsageObserver: Will read the current memory usage from '/sys/fs/cgroup/memory/memory.stat' (cgroups version: v1)
2025.01.05 00:04:42.506546 [ 1 ] {} <Information> CgroupsMemoryUsageObserver: Initialized cgroups memory limit observer, wait time is 15 sec
2025.01.05 00:04:42.507576 [ 1 ] {} <Debug> ConfigReloader: Loading config '/etc/clickhouse-server/config.xml'
2025.01.05 00:04:42.508073 [ 1 ] {} <Debug> ConfigProcessor: Processing configuration file '/etc/clickhouse-server/config.xml'.
2025.01.05 00:04:42.509171 [ 1 ] {} <Debug> ConfigProcessor: Merging configuration file '/etc/clickhouse-server/config.d/docker_related_config.xml'.
2025.01.05 00:04:42.521475 [ 1 ] {} <Debug> ConfigProcessor: Saved preprocessed configuration to '/var/lib/clickhouse/preprocessed_configs/config.xml'.
2025.01.05 00:04:42.521798 [ 1 ] {} <Debug> ConfigReloader: Loaded config '/etc/clickhouse-server/config.xml', performing update on configuration
2025.01.05 00:04:42.525499 [ 1 ] {} <Information> Application: Setting max_server_memory_usage was set to 6.91 GiB (7.68 GiB available * 0.90 max_server_memory_usage_to_ram_ratio)
2025.01.05 00:04:42.525831 [ 1 ] {} <Information> CgroupsMemoryUsageObserver: Set new limits, soft limit: 6.22 GiB, hard limit: 6.56 GiB
2025.01.05 00:04:42.526074 [ 1 ] {} <Information> Application: Setting merges_mutations_memory_usage_soft_limit was set to 3.84 GiB (7.68 GiB available * 0.50 merges_mutations_memory_usage_to_ram_ratio)
2025.01.05 00:04:42.526272 [ 1 ] {} <Information> Application: Merges and mutations memory limit is set to 3.84 GiB
2025.01.05 00:04:42.526762 [ 1 ] {} <Information> BackgroundSchedulePool/BgBufSchPool: Create BackgroundSchedulePool with 16 threads
2025.01.05 00:04:42.528704 [ 1 ] {} <Information> BackgroundSchedulePool/BgSchPool: Create BackgroundSchedulePool with 512 threads
2025.01.05 00:04:42.679970 [ 1 ] {} <Information> BackgroundSchedulePool/BgMBSchPool: Create BackgroundSchedulePool with 16 threads
2025.01.05 00:04:42.682126 [ 1 ] {} <Information> BackgroundSchedulePool/BgDistSchPool: Create BackgroundSchedulePool with 16 threads
2025.01.05 00:04:42.684569 [ 1 ] {} <Information> CertificateReloader: One of paths is empty. Cannot apply new configuration for certificates. Fill all paths and try again.
2025.01.05 00:04:42.684772 [ 1 ] {} <Debug> ConfigReloader: Loaded config '/etc/clickhouse-server/config.xml', performed update on configuration
2025.01.05 00:04:42.764476 [ 1 ] {} <Warning> Application: Listen [::]:9009 failed: Poco::Exception. Code: 1000, e.code() = 0, DNS error: EAI: Address family for hostname not supported (version 24.3.6.48 (official build)). If it is an IPv6 or IPv4 address and your host has disabled IPv6 or IPv4, then consider to specify not disabled IPv4 or IPv6 address to listen in <listen_host> element of configuration file. Example for disabled IPv6: <listen_host>0.0.0.0</listen_host> . Example for disabled IPv4: <listen_host>::</listen_host>
2025.01.05 00:04:42.765078 [ 1 ] {} <Information> Application: Listening for replica communication (interserver): http://0.0.0.0:9009
2025.01.05 00:04:42.766395 [ 1 ] {} <Debug> ConfigReloader: Loading config '/etc/clickhouse-server/users.xml'
2025.01.05 00:04:42.766550 [ 1 ] {} <Debug> ConfigProcessor: Processing configuration file '/etc/clickhouse-server/users.xml'.
2025.01.05 00:04:42.769388 [ 1 ] {} <Debug> ConfigProcessor: Saved preprocessed configuration to '/var/lib/clickhouse/preprocessed_configs/users.xml'.
2025.01.05 00:04:42.769530 [ 1 ] {} <Debug> ConfigReloader: Loaded config '/etc/clickhouse-server/users.xml', performing update on configuration
2025.01.05 00:04:42.770252 [ 1 ] {} <Debug> ConfigReloader: Loaded config '/etc/clickhouse-server/users.xml', performed update on configuration
2025.01.05 00:04:42.770770 [ 1 ] {} <Debug> Access(user directories): Added users_xml access storage 'users_xml', path: /etc/clickhouse-server/users.xml
2025.01.05 00:04:42.775012 [ 1 ] {} <Warning> Access(local_directory): File /var/lib/clickhouse/access/users.list doesn't exist
2025.01.05 00:04:42.775300 [ 1 ] {} <Warning> Access(local_directory): Recovering lists in directory /var/lib/clickhouse/access/
2025.01.05 00:04:42.784986 [ 1 ] {} <Debug> Access(user directories): Added local_directory access storage 'local_directory', path: /var/lib/clickhouse/access/
2025.01.05 00:04:42.785276 [ 1 ] {} <Information> CgroupsMemoryUsageObserver: Started cgroup current memory usage observer thread
2025.01.05 00:04:42.785472 [ 616 ] {} <Information> CgroupsMemoryUsageObserver: Memory amount initially available to the process is 7.68 GiB
2025.01.05 00:04:42.787016 [ 1 ] {} <Information> Context: Initialized background executor for merges and mutations with num_threads=16, num_tasks=32, scheduling_policy=round_robin
2025.01.05 00:04:42.791373 [ 1 ] {} <Information> Context: Initialized background executor for move operations with num_threads=8, num_tasks=8
2025.01.05 00:04:42.792703 [ 1 ] {} <Information> Context: Initialized background executor for fetches with num_threads=16, num_tasks=16
2025.01.05 00:04:42.794242 [ 1 ] {} <Information> Context: Initialized background executor for common operations (e.g. clearing old parts) with num_threads=8, num_tasks=8
2025.01.05 00:04:42.796906 [ 1 ] {} <Information> DNSCacheUpdater: Update period 15 seconds
2025.01.05 00:04:42.797095 [ 1 ] {} <Information> Application: Loading metadata from /var/lib/clickhouse/
2025.01.05 00:04:42.802321 [ 65 ] {} <Debug> DNSResolver: Updating DNS cache
2025.01.05 00:04:42.855258 [ 1 ] {} <Information> DatabaseAtomic (system): Metadata processed, database system has 0 tables and 0 dictionaries in total.
2025.01.05 00:04:42.855467 [ 1 ] {} <Information> TablesLoader: Parsed metadata of 0 tables in 1 databases in 0.0061795 sec
2025.01.05 00:04:42.855637 [ 1 ] {} <Trace> ReferentialDeps: No tables
2025.01.05 00:04:42.855799 [ 1 ] {} <Trace> LoadingDeps: No tables
2025.01.05 00:04:42.856044 [ 1 ] {} <Debug> AsyncLoader: Prioritize load job 'startup Atomic database system': BgStartup -> FgLoad
2025.01.05 00:04:42.856211 [ 1 ] {} <Debug> AsyncLoader: Prioritize load job 'startup Ordinary database system': BgStartup -> FgLoad
2025.01.05 00:04:42.856386 [ 1 ] {} <Debug> AsyncLoader: Schedule load job 'startup Ordinary database system' into FgLoad
2025.01.05 00:04:42.856604 [ 1 ] {} <Debug> AsyncLoader: Schedule load job 'startup Atomic database system' into FgLoad
2025.01.05 00:04:42.856781 [ 1 ] {} <Debug> AsyncLoader: Change current priority: none -> 0
2025.01.05 00:04:42.856968 [ 1 ] {} <Debug> AsyncLoader: Spawn loader worker #1 in FgLoad
2025.01.05 00:04:42.857353 [ 1 ] {} <Debug> AsyncLoader: Wait load job 'startup Atomic database system' in FgLoad
2025.01.05 00:04:42.857495 [ 681 ] {} <Debug> AsyncLoader: Execute load job 'startup Ordinary database system' in FgLoad
2025.01.05 00:04:42.857781 [ 681 ] {} <Debug> AsyncLoader: Finish load job 'startup Ordinary database system' with status OK
2025.01.05 00:04:42.857975 [ 681 ] {} <Debug> AsyncLoader: Spawn loader worker #2 in FgLoad
2025.01.05 00:04:42.858207 [ 681 ] {} <Debug> AsyncLoader: Execute load job 'startup Atomic database system' in FgLoad
2025.01.05 00:04:42.858421 [ 682 ] {} <Debug> AsyncLoader: Stop worker in FgLoad
2025.01.05 00:04:42.859367 [ 681 ] {} <Debug> AsyncLoader: Finish load job 'startup Atomic database system' with status OK
2025.01.05 00:04:42.859611 [ 681 ] {} <Debug> AsyncLoader: Stop worker in FgLoad
2025.01.05 00:04:42.859402 [ 1 ] {} <Debug> SystemLog: Creating system.query_log from query_log
2025.01.05 00:04:42.859806 [ 681 ] {} <Debug> AsyncLoader: Change current priority: 0 -> none
2025.01.05 00:04:42.861019 [ 1 ] {} <Debug> SystemLog: Creating system.query_thread_log from query_thread_log
2025.01.05 00:04:42.861508 [ 1 ] {} <Debug> SystemLog: Creating system.part_log from part_log
2025.01.05 00:04:42.861933 [ 1 ] {} <Debug> SystemLog: Creating system.trace_log from trace_log
2025.01.05 00:04:42.862394 [ 1 ] {} <Debug> SystemLog: Creating system.crash_log from crash_log
2025.01.05 00:04:42.862722 [ 1 ] {} <Debug> SystemLog: Not creating system.text_log since corresponding section 'text_log' is missing from config
2025.01.05 00:04:42.862869 [ 1 ] {} <Debug> SystemLog: Creating system.metric_log from metric_log
2025.01.05 00:04:42.867960 [ 1 ] {} <Debug> SystemLog: Not creating system.filesystem_cache_log since corresponding section 'filesystem_cache_log' is missing from config
2025.01.05 00:04:42.868208 [ 1 ] {} <Debug> SystemLog: Not creating system.filesystem_read_prefetches_log since corresponding section 'filesystem_read_prefetches_log' is missing from config
2025.01.05 00:04:42.868366 [ 1 ] {} <Debug> SystemLog: Creating system.asynchronous_metric_log from asynchronous_metric_log
2025.01.05 00:04:42.868721 [ 1 ] {} <Debug> SystemLog: Creating system.opentelemetry_span_log from opentelemetry_span_log
2025.01.05 00:04:42.869265 [ 1 ] {} <Debug> SystemLog: Creating system.query_views_log from query_views_log
2025.01.05 00:04:42.869474 [ 65 ] {} <Debug> DNSResolver: Updated DNS cache
2025.01.05 00:04:42.869854 [ 1 ] {} <Debug> SystemLog: Not creating system.zookeeper_log since corresponding section 'zookeeper_log' is missing from config
2025.01.05 00:04:42.870061 [ 1 ] {} <Debug> SystemLog: Not creating system.session_log since corresponding section 'session_log' is missing from config
2025.01.05 00:04:42.870220 [ 1 ] {} <Debug> SystemLog: Not creating system.transactions_info_log since corresponding section 'transactions_info_log' is missing from config
2025.01.05 00:04:42.870387 [ 1 ] {} <Debug> SystemLog: Creating system.processors_profile_log from processors_profile_log
2025.01.05 00:04:42.870746 [ 1 ] {} <Debug> SystemLog: Creating system.asynchronous_insert_log from asynchronous_insert_log
2025.01.05 00:04:42.871177 [ 1 ] {} <Debug> SystemLog: Creating system.backup_log from backup_log
2025.01.05 00:04:42.871525 [ 1 ] {} <Debug> SystemLog: Creating system.s3queue_log from s3queue_log
2025.01.05 00:04:42.871897 [ 1 ] {} <Debug> SystemLog: Creating system.blob_storage_log from blob_storage_log
2025.01.05 00:04:42.886528 [ 1 ] {} <Information> DatabaseCatalog: Found 0 partially dropped tables. Will load them and retry removal.
2025.01.05 00:04:42.919892 [ 1 ] {} <Information> DatabaseAtomic (default): Metadata processed, database default has 0 tables and 0 dictionaries in total.
2025.01.05 00:04:42.920080 [ 1 ] {} <Information> TablesLoader: Parsed metadata of 0 tables in 1 databases in 0.0023826 sec
2025.01.05 00:04:42.920219 [ 1 ] {} <Trace> ReferentialDeps: No tables
2025.01.05 00:04:42.920371 [ 1 ] {} <Trace> LoadingDeps: No tables
2025.01.05 00:04:42.920532 [ 1 ] {} <Information> loadMetadata: Start synchronous loading of databases
2025.01.05 00:04:42.920676 [ 1 ] {} <Information> loadMetadata: Start synchronous startup of databases
2025.01.05 00:04:42.920815 [ 1 ] {} <Debug> AsyncLoader: Prioritize load job 'startup Atomic database default': BgStartup -> FgLoad
2025.01.05 00:04:42.920968 [ 1 ] {} <Debug> AsyncLoader: Prioritize load job 'startup Ordinary database default': BgStartup -> FgLoad
2025.01.05 00:04:42.921100 [ 1 ] {} <Debug> AsyncLoader: Schedule load job 'startup Ordinary database default' into FgLoad
2025.01.05 00:04:42.921227 [ 1 ] {} <Debug> AsyncLoader: Schedule load job 'startup Atomic database default' into FgLoad
2025.01.05 00:04:42.921368 [ 1 ] {} <Debug> AsyncLoader: Change current priority: none -> 0
2025.01.05 00:04:42.921507 [ 1 ] {} <Debug> AsyncLoader: Spawn loader worker #1 in FgLoad
2025.01.05 00:04:42.921746 [ 1 ] {} <Debug> AsyncLoader: Wait load job 'startup Atomic database default' in FgLoad
2025.01.05 00:04:42.921839 [ 696 ] {} <Debug> AsyncLoader: Execute load job 'startup Ordinary database default' in FgLoad
2025.01.05 00:04:42.922059 [ 696 ] {} <Debug> AsyncLoader: Finish load job 'startup Ordinary database default' with status OK
2025.01.05 00:04:42.922189 [ 696 ] {} <Debug> AsyncLoader: Spawn loader worker #2 in FgLoad
2025.01.05 00:04:42.922398 [ 696 ] {} <Debug> AsyncLoader: Execute load job 'startup Atomic database default' in FgLoad
2025.01.05 00:04:42.922574 [ 697 ] {} <Debug> AsyncLoader: Stop worker in FgLoad
2025.01.05 00:04:42.922773 [ 696 ] {} <Debug> AsyncLoader: Finish load job 'startup Atomic database default' with status OK
2025.01.05 00:04:42.922905 [ 696 ] {} <Debug> AsyncLoader: Stop worker in FgLoad
2025.01.05 00:04:42.923054 [ 696 ] {} <Debug> AsyncLoader: Change current priority: 0 -> none
2025.01.05 00:04:42.926653 [ 1 ] {} <Information> UserDefinedSQLObjectsLoaderFromDisk: Loading user defined objects from /var/lib/clickhouse/user_defined/
2025.01.05 00:04:42.929454 [ 1 ] {} <Debug> UserDefinedSQLObjectsLoaderFromDisk: User defined objects loaded
2025.01.05 00:04:42.929598 [ 1 ] {} <Debug> Application: Loaded metadata.
2025.01.05 00:04:42.929775 [ 1 ] {} <Trace> Pipe: Pipe capacity is 1.00 MiB
2025.01.05 00:04:42.929958 [ 1 ] {} <Information> Application: Tasks stats provider: procfs
2025.01.05 00:04:42.930103 [ 1 ] {} <Information> Application: It looks like the process has no CAP_SYS_NICE capability, the setting 'os_thread_priority' will have no effect. It could happen due to incorrect ClickHouse package installation. You could resolve the problem manually with 'sudo setcap cap_sys_nice=+ep /usr/bin/clickhouse'. Note that it will not work on 'nosuid' mounted filesystems.
2025.01.05 00:04:43.029580 [ 1 ] {} <Warning> Application: Listen [::]:8123 failed: Poco::Exception. Code: 1000, e.code() = 0, DNS error: EAI: Address family for hostname not supported (version 24.3.6.48 (official build)). If it is an IPv6 or IPv4 address and your host has disabled IPv6 or IPv4, then consider to specify not disabled IPv4 or IPv6 address to listen in <listen_host> element of configuration file. Example for disabled IPv6: <listen_host>0.0.0.0</listen_host> . Example for disabled IPv4: <listen_host>::</listen_host>
2025.01.05 00:04:43.233718 [ 1 ] {} <Warning> Application: Listen [::]:9000 failed: Poco::Exception. Code: 1000, e.code() = 0, DNS error: EAI: Address family for hostname not supported (version 24.3.6.48 (official build)). If it is an IPv6 or IPv4 address and your host has disabled IPv6 or IPv4, then consider to specify not disabled IPv4 or IPv6 address to listen in <listen_host> element of configuration file. Example for disabled IPv6: <listen_host>0.0.0.0</listen_host> . Example for disabled IPv4: <listen_host>::</listen_host>
2025.01.05 00:04:43.238122 [ 1 ] {} <Warning> Application: Listen [::]:9004 failed: Poco::Exception. Code: 1000, e.code() = 0, DNS error: EAI: Address family for hostname not supported (version 24.3.6.48 (official build)). If it is an IPv6 or IPv4 address and your host has disabled IPv6 or IPv4, then consider to specify not disabled IPv4 or IPv6 address to listen in <listen_host> element of configuration file. Example for disabled IPv6: <listen_host>0.0.0.0</listen_host> . Example for disabled IPv4: <listen_host>::</listen_host>
2025.01.05 00:04:43.239411 [ 1 ] {} <Warning> Application: Listen [::]:9005 failed: Poco::Exception. Code: 1000, e.code() = 0, DNS error: EAI: Address family for hostname not supported (version 24.3.6.48 (official build)). If it is an IPv6 or IPv4 address and your host has disabled IPv6 or IPv4, then consider to specify not disabled IPv4 or IPv6 address to listen in <listen_host> element of configuration file. Example for disabled IPv6: <listen_host>0.0.0.0</listen_host> . Example for disabled IPv4: <listen_host>::</listen_host>
2025.01.05 00:04:43.240516 [ 1 ] {} <Trace> MySQLHandlerFactory: Failed to create SSL context. SSL will be disabled. Error: Poco::Exception. Code: 1000, e.code() = 0, SSL Exception: Configuration error: no certificate file has been specified (version 24.3.6.48 (official build))
2025.01.05 00:04:43.240910 [ 1 ] {} <Trace> MySQLHandlerFactory: Failed to read RSA key pair from server certificate. Error: Code: 139. DB::Exception: Certificate file is not set. (NO_ELEMENTS_IN_CONFIG) (version 24.3.6.48 (official build))
2025.01.05 00:04:43.241120 [ 1 ] {} <Trace> MySQLHandlerFactory: Generating new RSA key pair.
2025.01.05 00:04:43.359606 [ 1 ] {} <Information> CertificateReloader: One of paths is empty. Cannot apply new configuration for certificates. Fill all paths and try again.
2025.01.05 00:04:43.360966 [ 1 ] {} <Trace> AsynchronousMetrics: MemoryTracking: was 47.18 MiB, peak 47.19 MiB, free memory in arenas 24.14 MiB, will set to 528.80 MiB (RSS), difference: 481.62 MiB
2025.01.05 00:04:43.365307 [ 1 ] {} <Trace> AsynchronousMetrics: Update heavy metrics. Update period 1 sec. Update heavy metrics period 120 sec. Heavy metrics calculation elapsed: 3.77e-05 sec.
2025.01.05 00:04:43.371732 [ 1 ] {} <Information> Application: Listening for http://0.0.0.0:8123
2025.01.05 00:04:43.372114 [ 1 ] {} <Information> Application: Listening for native protocol (tcp): 0.0.0.0:9000
2025.01.05 00:04:43.372390 [ 1 ] {} <Information> Application: Listening for MySQL compatibility protocol: 0.0.0.0:9004
2025.01.05 00:04:43.373351 [ 1 ] {} <Information> Application: Listening for PostgreSQL compatibility protocol: 0.0.0.0:9005
2025.01.05 00:04:43.373528 [ 1 ] {} <Information> Application: Ready for connections.
2025.01.05 00:04:49.873943 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushing system log, 3814 entries to flush up to offset 3814
2025.01.05 00:04:49.875280 [ 687 ] {} <Debug> SystemLog (system.asynchronous_metric_log): Creating new table system.asynchronous_metric_log for AsynchronousMetricLog
2025.01.05 00:04:49.892071 [ 687 ] {} <Trace> StoragePolicy (default): Storage policy default created, total volumes 1
2025.01.05 00:04:49.919217 [ 687 ] {} <Debug> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Loading data parts
2025.01.05 00:04:49.926399 [ 687 ] {} <Debug> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): There are no data parts
2025.01.05 00:04:49.977749 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:04:49.978843 [ 687 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 549.59 GiB.
2025.01.05 00:04:49.995475 [ 687 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_1_1_0 (state Temporary)
2025.01.05 00:04:50.000694 [ 696 ] {} <Trace> AsynchronousMetrics: MemoryTracking: was 538.09 MiB, peak 538.09 MiB, free memory in arenas 14.15 MiB, will set to 530.98 MiB (RSS), difference: -7.12 MiB
2025.01.05 00:04:50.009071 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Renaming temporary part tmp_insert_202501_1_1_0 to 202501_1_1_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:04:50.015511 [ 687 ] {} <Error> void DB::SystemLog<DB::AsynchronousMetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::AsynchronousMetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/tmp_insert_202501_1_1_0/"] ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/202501_1_1_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::AsynchronousMetricLogElement>::savingThreadFunction() @ 0x000000001104f30c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000cccfe94
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:04:50.016090 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushed system log up to offset 3814
2025.01.05 00:04:50.374033 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushing system log, 8 entries to flush up to offset 8
2025.01.05 00:04:50.374058 [ 688 ] {} <Trace> SystemLog (system.trace_log): Flushing system log, 11 entries to flush up to offset 11
2025.01.05 00:04:50.374270 [ 694 ] {} <Debug> SystemLog (system.metric_log): Creating new table system.metric_log for MetricLog
2025.01.05 00:04:50.374435 [ 688 ] {} <Debug> SystemLog (system.trace_log): Creating new table system.trace_log for TraceLog
2025.01.05 00:04:50.396587 [ 688 ] {} <Debug> system.trace_log (e1acc488-6507-4627-a115-261d46c24a4a): Loading data parts
2025.01.05 00:04:50.405869 [ 688 ] {} <Debug> system.trace_log (e1acc488-6507-4627-a115-261d46c24a4a): There are no data parts
2025.01.05 00:04:50.414278 [ 694 ] {} <Debug> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Loading data parts
2025.01.05 00:04:50.420159 [ 694 ] {} <Debug> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): There are no data parts
2025.01.05 00:04:50.445107 [ 688 ] {} <Trace> system.trace_log (e1acc488-6507-4627-a115-261d46c24a4a): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:04:50.446207 [ 688 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 549.52 GiB.
2025.01.05 00:04:50.469440 [ 688 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_1_1_0 (state Temporary)
2025.01.05 00:04:50.487791 [ 688 ] {} <Trace> system.trace_log (e1acc488-6507-4627-a115-261d46c24a4a): Renaming temporary part tmp_insert_202501_1_1_0 to 202501_1_1_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:04:50.492086 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:04:50.493172 [ 694 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 549.52 GiB.
2025.01.05 00:04:50.496075 [ 688 ] {} <Error> void DB::SystemLog<DB::TraceLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::TraceLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/e1a/e1acc488-6507-4627-a115-261d46c24a4a/tmp_insert_202501_1_1_0/"] ["/var/lib/clickhouse/store/e1a/e1acc488-6507-4627-a115-261d46c24a4a/202501_1_1_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::TraceLogElement>::savingThreadFunction() @ 0x0000000011091a8c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::TraceLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::TraceLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000ccd1c14
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:04:50.496591 [ 688 ] {} <Trace> SystemLog (system.trace_log): Flushed system log up to offset 11
2025.01.05 00:04:50.519341 [ 694 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_1_1_0 (state Temporary)
2025.01.05 00:04:50.561639 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Renaming temporary part tmp_insert_202501_1_1_0 to 202501_1_1_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:04:50.572057 [ 694 ] {} <Error> void DB::SystemLog<DB::MetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::MetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/tmp_insert_202501_1_1_0/"] ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/202501_1_1_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::MetricLogElement>::savingThreadFunction() @ 0x000000001105dfec
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000ccd0554
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:04:50.573048 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushed system log up to offset 8
2025.01.05 00:04:51.000667 [ 696 ] {} <Trace> AsynchronousMetrics: MemoryTracking: was 526.13 MiB, peak 539.06 MiB, free memory in arenas 33.75 MiB, will set to 533.38 MiB (RSS), difference: 7.25 MiB
2025.01.05 00:04:57.019036 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushing system log, 4916 entries to flush up to offset 8730
2025.01.05 00:04:57.034363 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:04:57.035603 [ 687 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 549.41 GiB.
2025.01.05 00:04:57.059239 [ 687 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_2_2_0 (state Temporary)
2025.01.05 00:04:57.080426 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Renaming temporary part tmp_insert_202501_2_2_0 to 202501_2_2_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:04:57.087670 [ 687 ] {} <Error> void DB::SystemLog<DB::AsynchronousMetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::AsynchronousMetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/tmp_insert_202501_2_2_0/"] ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/202501_2_2_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::AsynchronousMetricLogElement>::savingThreadFunction() @ 0x000000001104f30c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000cccfe94
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:04:57.088319 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushed system log up to offset 8730
2025.01.05 00:04:57.791105 [ 616 ] {} <Trace> CgroupsMemoryUsageObserver: Read current memory usage 225.67 MiB from cgroups
2025.01.05 00:04:57.869862 [ 134 ] {} <Debug> DNSResolver: Updating DNS cache
2025.01.05 00:04:57.870891 [ 134 ] {} <Debug> DNSResolver: Updated DNS cache
2025.01.05 00:04:57.999416 [ 688 ] {} <Trace> SystemLog (system.trace_log): Flushing system log, 2 entries to flush up to offset 13
2025.01.05 00:04:58.000747 [ 696 ] {} <Trace> AsynchronousMetrics: MemoryTracking: was 533.36 MiB, peak 541.61 MiB, free memory in arenas 29.02 MiB, will set to 524.46 MiB (RSS), difference: -8.90 MiB
2025.01.05 00:04:58.006991 [ 688 ] {} <Trace> system.trace_log (e1acc488-6507-4627-a115-261d46c24a4a): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:04:58.007922 [ 688 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 548.40 GiB.
2025.01.05 00:04:58.030360 [ 688 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_2_2_0 (state Temporary)
2025.01.05 00:04:58.048515 [ 688 ] {} <Trace> system.trace_log (e1acc488-6507-4627-a115-261d46c24a4a): Renaming temporary part tmp_insert_202501_2_2_0 to 202501_2_2_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:04:58.053920 [ 688 ] {} <Error> void DB::SystemLog<DB::TraceLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::TraceLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/e1a/e1acc488-6507-4627-a115-261d46c24a4a/tmp_insert_202501_2_2_0/"] ["/var/lib/clickhouse/store/e1a/e1acc488-6507-4627-a115-261d46c24a4a/202501_2_2_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::TraceLogElement>::savingThreadFunction() @ 0x0000000011091a8c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::TraceLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::TraceLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000ccd1c14
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:04:58.054346 [ 688 ] {} <Trace> SystemLog (system.trace_log): Flushed system log up to offset 13
2025.01.05 00:04:58.076358 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushing system log, 8 entries to flush up to offset 16
2025.01.05 00:04:58.182392 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:04:58.183990 [ 694 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 548.40 GiB.
2025.01.05 00:04:58.266754 [ 694 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_2_2_0 (state Temporary)
2025.01.05 00:04:58.356865 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Renaming temporary part tmp_insert_202501_2_2_0 to 202501_2_2_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:04:58.370271 [ 694 ] {} <Error> void DB::SystemLog<DB::MetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::MetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/tmp_insert_202501_2_2_0/"] ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/202501_2_2_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::MetricLogElement>::savingThreadFunction() @ 0x000000001105dfec
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000ccd0554
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:04:58.370691 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushed system log up to offset 16
2025.01.05 00:04:59.000510 [ 696 ] {} <Trace> AsynchronousMetrics: MemoryTracking: was 524.52 MiB, peak 541.61 MiB, free memory in arenas 42.76 MiB, will set to 533.59 MiB (RSS), difference: 9.07 MiB
2025.01.05 00:05:01.000896 [ 696 ] {} <Trace> AsynchronousMetrics: MemoryTracking: was 533.59 MiB, peak 541.61 MiB, free memory in arenas 40.86 MiB, will set to 531.85 MiB (RSS), difference: -1.74 MiB
2025.01.05 00:05:04.000742 [ 696 ] {} <Trace> AsynchronousMetrics: MemoryTracking: was 530.88 MiB, peak 541.61 MiB, free memory in arenas 28.03 MiB, will set to 523.44 MiB (RSS), difference: -7.45 MiB
2025.01.05 00:05:04.088786 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushing system log, 4305 entries to flush up to offset 13035
2025.01.05 00:05:04.092478 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:05:04.093815 [ 687 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.55 GiB.
2025.01.05 00:05:04.111491 [ 687 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_3_3_0 (state Temporary)
2025.01.05 00:05:04.124733 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Renaming temporary part tmp_insert_202501_3_3_0 to 202501_3_3_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:05:04.128449 [ 687 ] {} <Error> void DB::SystemLog<DB::AsynchronousMetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::AsynchronousMetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/tmp_insert_202501_3_3_0/"] ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/202501_3_3_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::AsynchronousMetricLogElement>::savingThreadFunction() @ 0x000000001104f30c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000cccfe94
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:05:04.128763 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushed system log up to offset 13035
2025.01.05 00:05:05.000513 [ 696 ] {} <Trace> AsynchronousMetrics: MemoryTracking: was 523.42 MiB, peak 541.61 MiB, free memory in arenas 29.25 MiB, will set to 521.43 MiB (RSS), difference: -1.99 MiB
2025.01.05 00:05:05.871055 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushing system log, 7 entries to flush up to offset 23
2025.01.05 00:05:05.892576 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:05:05.893417 [ 694 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.62 GiB.
2025.01.05 00:05:05.919381 [ 694 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_3_3_0 (state Temporary)
2025.01.05 00:05:05.943502 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Renaming temporary part tmp_insert_202501_3_3_0 to 202501_3_3_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:05:05.950914 [ 694 ] {} <Error> void DB::SystemLog<DB::MetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::MetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/tmp_insert_202501_3_3_0/"] ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/202501_3_3_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::MetricLogElement>::savingThreadFunction() @ 0x000000001105dfec
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000ccd0554
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:05:05.951395 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushed system log up to offset 23
2025.01.05 00:05:06.000784 [ 696 ] {} <Trace> AsynchronousMetrics: MemoryTracking: was 521.37 MiB, peak 541.61 MiB, free memory in arenas 40.71 MiB, will set to 537.98 MiB (RSS), difference: 16.61 MiB
2025.01.05 00:05:11.129014 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushing system log, 4305 entries to flush up to offset 17340
2025.01.05 00:05:11.132371 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:05:11.133722 [ 687 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.62 GiB.
2025.01.05 00:05:11.174702 [ 687 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_4_4_0 (state Temporary)
2025.01.05 00:05:11.187914 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Renaming temporary part tmp_insert_202501_4_4_0 to 202501_4_4_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:05:11.192092 [ 687 ] {} <Error> void DB::SystemLog<DB::AsynchronousMetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::AsynchronousMetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/tmp_insert_202501_4_4_0/"] ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/202501_4_4_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::AsynchronousMetricLogElement>::savingThreadFunction() @ 0x000000001104f30c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000cccfe94
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:05:11.192692 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushed system log up to offset 17340
2025.01.05 00:05:12.000721 [ 696 ] {} <Trace> AsynchronousMetrics: MemoryTracking: was 537.79 MiB, peak 546.04 MiB, free memory in arenas 39.15 MiB, will set to 535.47 MiB (RSS), difference: -2.32 MiB
2025.01.05 00:05:12.791621 [ 616 ] {} <Trace> CgroupsMemoryUsageObserver: Read current memory usage 242.10 MiB from cgroups
2025.01.05 00:05:12.871316 [ 166 ] {} <Debug> DNSResolver: Updating DNS cache
2025.01.05 00:05:12.871801 [ 166 ] {} <Debug> DNSResolver: Updated DNS cache
2025.01.05 00:05:13.054723 [ 688 ] {} <Trace> SystemLog (system.trace_log): Flushing system log, 2 entries to flush up to offset 15
2025.01.05 00:05:13.055485 [ 688 ] {} <Trace> system.trace_log (e1acc488-6507-4627-a115-261d46c24a4a): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:05:13.057178 [ 688 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.62 GiB.
2025.01.05 00:05:13.074198 [ 688 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_3_3_0 (state Temporary)
2025.01.05 00:05:13.086946 [ 688 ] {} <Trace> system.trace_log (e1acc488-6507-4627-a115-261d46c24a4a): Renaming temporary part tmp_insert_202501_3_3_0 to 202501_3_3_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:05:13.090782 [ 688 ] {} <Error> void DB::SystemLog<DB::TraceLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::TraceLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/e1a/e1acc488-6507-4627-a115-261d46c24a4a/tmp_insert_202501_3_3_0/"] ["/var/lib/clickhouse/store/e1a/e1acc488-6507-4627-a115-261d46c24a4a/202501_3_3_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::TraceLogElement>::savingThreadFunction() @ 0x0000000011091a8c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::TraceLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::TraceLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000ccd1c14
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:05:13.091166 [ 688 ] {} <Trace> SystemLog (system.trace_log): Flushed system log up to offset 15
2025.01.05 00:05:13.451673 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushing system log, 8 entries to flush up to offset 31
2025.01.05 00:05:13.506393 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:05:13.508483 [ 694 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.62 GiB.
2025.01.05 00:05:13.540580 [ 694 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_4_4_0 (state Temporary)
2025.01.05 00:05:13.568038 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Renaming temporary part tmp_insert_202501_4_4_0 to 202501_4_4_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:05:13.574997 [ 694 ] {} <Error> void DB::SystemLog<DB::MetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::MetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/tmp_insert_202501_4_4_0/"] ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/202501_4_4_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::MetricLogElement>::savingThreadFunction() @ 0x000000001105dfec
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000ccd0554
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:05:13.575837 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushed system log up to offset 31
2025.01.05 00:05:14.000569 [ 696 ] {} <Trace> AsynchronousMetrics: MemoryTracking: was 535.43 MiB, peak 548.37 MiB, free memory in arenas 54.34 MiB, will set to 548.93 MiB (RSS), difference: 13.50 MiB
2025.01.05 00:05:18.193178 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushing system log, 4307 entries to flush up to offset 21647
2025.01.05 00:05:18.196148 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:05:18.197272 [ 687 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.62 GiB.
2025.01.05 00:05:18.212001 [ 687 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_5_5_0 (state Temporary)
2025.01.05 00:05:18.224584 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Renaming temporary part tmp_insert_202501_5_5_0 to 202501_5_5_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:05:18.228454 [ 687 ] {} <Error> void DB::SystemLog<DB::AsynchronousMetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::AsynchronousMetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/tmp_insert_202501_5_5_0/"] ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/202501_5_5_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::AsynchronousMetricLogElement>::savingThreadFunction() @ 0x000000001104f30c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000cccfe94
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:05:18.228777 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushed system log up to offset 21647
2025.01.05 00:05:19.000569 [ 696 ] {} <Trace> AsynchronousMetrics: MemoryTracking: was 548.91 MiB, peak 557.16 MiB, free memory in arenas 54.79 MiB, will set to 556.88 MiB (RSS), difference: 7.96 MiB
2025.01.05 00:05:20.591378 [ 688 ] {} <Trace> SystemLog (system.trace_log): Flushing system log, 6 entries to flush up to offset 21
2025.01.05 00:05:20.591981 [ 688 ] {} <Trace> system.trace_log (e1acc488-6507-4627-a115-261d46c24a4a): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:05:20.592577 [ 688 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.62 GiB.
2025.01.05 00:05:20.606288 [ 688 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_4_4_0 (state Temporary)
2025.01.05 00:05:20.618438 [ 688 ] {} <Trace> system.trace_log (e1acc488-6507-4627-a115-261d46c24a4a): Renaming temporary part tmp_insert_202501_4_4_0 to 202501_4_4_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:05:20.622833 [ 688 ] {} <Error> void DB::SystemLog<DB::TraceLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::TraceLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/e1a/e1acc488-6507-4627-a115-261d46c24a4a/tmp_insert_202501_4_4_0/"] ["/var/lib/clickhouse/store/e1a/e1acc488-6507-4627-a115-261d46c24a4a/202501_4_4_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::TraceLogElement>::savingThreadFunction() @ 0x0000000011091a8c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::TraceLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::TraceLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000ccd1c14
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:05:20.623225 [ 688 ] {} <Trace> SystemLog (system.trace_log): Flushed system log up to offset 21
2025.01.05 00:05:21.076211 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushing system log, 8 entries to flush up to offset 39
2025.01.05 00:05:21.146537 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:05:21.148444 [ 694 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.62 GiB.
2025.01.05 00:05:21.179887 [ 694 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_5_5_0 (state Temporary)
2025.01.05 00:05:21.221464 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Renaming temporary part tmp_insert_202501_5_5_0 to 202501_5_5_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:05:21.230636 [ 694 ] {} <Error> void DB::SystemLog<DB::MetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::MetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/tmp_insert_202501_5_5_0/"] ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/202501_5_5_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::MetricLogElement>::savingThreadFunction() @ 0x000000001105dfec
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000ccd0554
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:05:21.231102 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushed system log up to offset 39
2025.01.05 00:05:22.000605 [ 696 ] {} <Trace> AsynchronousMetrics: MemoryTracking: was 556.80 MiB, peak 569.74 MiB, free memory in arenas 45.15 MiB, will set to 547.24 MiB (RSS), difference: -9.56 MiB
2025.01.05 00:05:25.229338 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushing system log, 4305 entries to flush up to offset 25952
2025.01.05 00:05:25.233057 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:05:25.234300 [ 687 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.62 GiB.
2025.01.05 00:05:25.248368 [ 687 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_6_6_0 (state Temporary)
2025.01.05 00:05:25.260066 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Renaming temporary part tmp_insert_202501_6_6_0 to 202501_6_6_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:05:25.264223 [ 687 ] {} <Error> void DB::SystemLog<DB::AsynchronousMetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::AsynchronousMetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/tmp_insert_202501_6_6_0/"] ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/202501_6_6_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::AsynchronousMetricLogElement>::savingThreadFunction() @ 0x000000001104f30c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000cccfe94
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:05:25.264953 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushed system log up to offset 25952
2025.01.05 00:05:27.793103 [ 616 ] {} <Trace> CgroupsMemoryUsageObserver: Read current memory usage 253.07 MiB from cgroups
2025.01.05 00:05:27.872737 [ 158 ] {} <Debug> DNSResolver: Updating DNS cache
2025.01.05 00:05:27.874274 [ 158 ] {} <Debug> DNSResolver: Updated DNS cache
2025.01.05 00:05:28.124040 [ 688 ] {} <Trace> SystemLog (system.trace_log): Flushing system log, 6 entries to flush up to offset 27
2025.01.05 00:05:28.126916 [ 688 ] {} <Trace> system.trace_log (e1acc488-6507-4627-a115-261d46c24a4a): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:05:28.131176 [ 688 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.62 GiB.
2025.01.05 00:05:28.161231 [ 688 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_5_5_0 (state Temporary)
2025.01.05 00:05:28.172766 [ 688 ] {} <Trace> system.trace_log (e1acc488-6507-4627-a115-261d46c24a4a): Renaming temporary part tmp_insert_202501_5_5_0 to 202501_5_5_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:05:28.177289 [ 688 ] {} <Error> void DB::SystemLog<DB::TraceLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::TraceLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/e1a/e1acc488-6507-4627-a115-261d46c24a4a/tmp_insert_202501_5_5_0/"] ["/var/lib/clickhouse/store/e1a/e1acc488-6507-4627-a115-261d46c24a4a/202501_5_5_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::TraceLogElement>::savingThreadFunction() @ 0x0000000011091a8c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::TraceLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::TraceLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000ccd1c14
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:05:28.177712 [ 688 ] {} <Trace> SystemLog (system.trace_log): Flushed system log up to offset 27
2025.01.05 00:05:28.731737 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushing system log, 7 entries to flush up to offset 46
2025.01.05 00:05:28.754380 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:05:28.756268 [ 694 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.62 GiB.
2025.01.05 00:05:28.782938 [ 694 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_6_6_0 (state Temporary)
2025.01.05 00:05:28.804458 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Renaming temporary part tmp_insert_202501_6_6_0 to 202501_6_6_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:05:28.811173 [ 694 ] {} <Error> void DB::SystemLog<DB::MetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::MetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/tmp_insert_202501_6_6_0/"] ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/202501_6_6_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::MetricLogElement>::savingThreadFunction() @ 0x000000001105dfec
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000ccd0554
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:05:28.811571 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushed system log up to offset 46
2025.01.05 00:05:29.001702 [ 696 ] {} <Trace> AsynchronousMetrics: MemoryTracking: was 546.22 MiB, peak 569.74 MiB, free memory in arenas 46.01 MiB, will set to 547.77 MiB (RSS), difference: 1.55 MiB
2025.01.05 00:05:32.265873 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushing system log, 4305 entries to flush up to offset 30257
2025.01.05 00:05:32.269057 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:05:32.270916 [ 687 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.62 GiB.
2025.01.05 00:05:32.288042 [ 687 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_7_7_0 (state Temporary)
2025.01.05 00:05:32.299480 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Renaming temporary part tmp_insert_202501_7_7_0 to 202501_7_7_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:05:32.302836 [ 687 ] {} <Error> void DB::SystemLog<DB::AsynchronousMetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::AsynchronousMetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/tmp_insert_202501_7_7_0/"] ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/202501_7_7_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::AsynchronousMetricLogElement>::savingThreadFunction() @ 0x000000001104f30c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000cccfe94
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:05:32.303180 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushed system log up to offset 30257
2025.01.05 00:05:33.001837 [ 696 ] {} <Trace> AsynchronousMetrics: MemoryTracking: was 547.76 MiB, peak 569.74 MiB, free memory in arenas 45.98 MiB, will set to 545.05 MiB (RSS), difference: -2.71 MiB
2025.01.05 00:05:34.001774 [ 696 ] {} <Trace> AsynchronousMetrics: MemoryTracking: was 545.05 MiB, peak 569.74 MiB, free memory in arenas 46.10 MiB, will set to 547.04 MiB (RSS), difference: 2.00 MiB
2025.01.05 00:05:36.312634 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushing system log, 8 entries to flush up to offset 54
2025.01.05 00:05:36.335672 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:05:36.337837 [ 694 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.70 GiB.
2025.01.05 00:05:36.365037 [ 694 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_7_7_0 (state Temporary)
2025.01.05 00:05:36.387245 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Renaming temporary part tmp_insert_202501_7_7_0 to 202501_7_7_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:05:36.394698 [ 694 ] {} <Error> void DB::SystemLog<DB::MetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::MetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/tmp_insert_202501_7_7_0/"] ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/202501_7_7_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::MetricLogElement>::savingThreadFunction() @ 0x000000001105dfec
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000ccd0554
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:05:36.395305 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushed system log up to offset 54
2025.01.05 00:05:37.002178 [ 696 ] {} <Trace> AsynchronousMetrics: MemoryTracking: was 546.99 MiB, peak 569.74 MiB, free memory in arenas 45.46 MiB, will set to 543.90 MiB (RSS), difference: -3.09 MiB
2025.01.05 00:05:39.304178 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushing system log, 4305 entries to flush up to offset 34562
2025.01.05 00:05:39.311979 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:05:39.313615 [ 687 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.70 GiB.
2025.01.05 00:05:39.333686 [ 687 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_8_8_0 (state Temporary)
2025.01.05 00:05:39.345000 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Renaming temporary part tmp_insert_202501_8_8_0 to 202501_8_8_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:05:39.348755 [ 687 ] {} <Error> void DB::SystemLog<DB::AsynchronousMetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::AsynchronousMetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/tmp_insert_202501_8_8_0/"] ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/202501_8_8_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::AsynchronousMetricLogElement>::savingThreadFunction() @ 0x000000001104f30c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000cccfe94
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:05:39.349140 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushed system log up to offset 34562
2025.01.05 00:05:42.794564 [ 616 ] {} <Trace> CgroupsMemoryUsageObserver: Read current memory usage 251.54 MiB from cgroups
2025.01.05 00:05:42.875832 [ 206 ] {} <Debug> DNSResolver: Updating DNS cache
2025.01.05 00:05:42.877580 [ 206 ] {} <Debug> DNSResolver: Updated DNS cache
2025.01.05 00:05:43.895631 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushing system log, 8 entries to flush up to offset 62
2025.01.05 00:05:43.915656 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:05:43.916392 [ 694 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.70 GiB.
2025.01.05 00:05:43.943567 [ 694 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_8_8_0 (state Temporary)
2025.01.05 00:05:43.964950 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Renaming temporary part tmp_insert_202501_8_8_0 to 202501_8_8_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:05:43.972330 [ 694 ] {} <Error> void DB::SystemLog<DB::MetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::MetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/tmp_insert_202501_8_8_0/"] ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/202501_8_8_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::MetricLogElement>::savingThreadFunction() @ 0x000000001105dfec
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000ccd0554
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:05:43.972744 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushed system log up to offset 62
2025.01.05 00:05:46.349722 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushing system log, 4305 entries to flush up to offset 38867
2025.01.05 00:05:46.362204 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:05:46.366904 [ 687 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.70 GiB.
2025.01.05 00:05:46.387714 [ 687 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_9_9_0 (state Temporary)
2025.01.05 00:05:46.399305 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Renaming temporary part tmp_insert_202501_9_9_0 to 202501_9_9_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:05:46.402762 [ 687 ] {} <Error> void DB::SystemLog<DB::AsynchronousMetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::AsynchronousMetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/tmp_insert_202501_9_9_0/"] ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/202501_9_9_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::AsynchronousMetricLogElement>::savingThreadFunction() @ 0x000000001104f30c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000cccfe94
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:05:46.403460 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushed system log up to offset 38867
2025.01.05 00:05:47.000655 [ 696 ] {} <Trace> AsynchronousMetrics: MemoryTracking: was 545.51 MiB, peak 569.74 MiB, free memory in arenas 45.10 MiB, will set to 544.40 MiB (RSS), difference: -1.10 MiB
2025.01.05 00:05:51.473130 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushing system log, 7 entries to flush up to offset 69
2025.01.05 00:05:51.504283 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:05:51.506573 [ 694 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.70 GiB.
2025.01.05 00:05:51.551116 [ 694 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_9_9_0 (state Temporary)
2025.01.05 00:05:51.599796 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Renaming temporary part tmp_insert_202501_9_9_0 to 202501_9_9_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:05:51.607741 [ 694 ] {} <Error> void DB::SystemLog<DB::MetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::MetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/tmp_insert_202501_9_9_0/"] ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/202501_9_9_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::MetricLogElement>::savingThreadFunction() @ 0x000000001105dfec
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000ccd0554
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:05:51.608208 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushed system log up to offset 69
2025.01.05 00:05:52.001105 [ 696 ] {} <Trace> AsynchronousMetrics: MemoryTracking: was 544.34 MiB, peak 569.74 MiB, free memory in arenas 44.67 MiB, will set to 543.32 MiB (RSS), difference: -1.03 MiB
2025.01.05 00:05:53.404644 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushing system log, 4305 entries to flush up to offset 43172
2025.01.05 00:05:53.411023 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:05:53.412894 [ 687 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.70 GiB.
2025.01.05 00:05:53.431436 [ 687 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_10_10_0 (state Temporary)
2025.01.05 00:05:53.444789 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Renaming temporary part tmp_insert_202501_10_10_0 to 202501_10_10_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:05:53.448574 [ 687 ] {} <Error> void DB::SystemLog<DB::AsynchronousMetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::AsynchronousMetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/tmp_insert_202501_10_10_0/"] ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/202501_10_10_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::AsynchronousMetricLogElement>::savingThreadFunction() @ 0x000000001104f30c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000cccfe94
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:05:53.449410 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushed system log up to offset 43172
2025.01.05 00:05:54.000616 [ 696 ] {} <Trace> AsynchronousMetrics: MemoryTracking: was 543.30 MiB, peak 569.74 MiB, free memory in arenas 54.00 MiB, will set to 555.96 MiB (RSS), difference: 12.66 MiB
2025.01.05 00:05:57.795941 [ 616 ] {} <Trace> CgroupsMemoryUsageObserver: Read current memory usage 263.03 MiB from cgroups
2025.01.05 00:05:57.879104 [ 165 ] {} <Debug> DNSResolver: Updating DNS cache
2025.01.05 00:05:57.880446 [ 165 ] {} <Debug> DNSResolver: Updated DNS cache
2025.01.05 00:05:59.109185 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushing system log, 8 entries to flush up to offset 77
2025.01.05 00:05:59.127350 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:05:59.129512 [ 694 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.70 GiB.
2025.01.05 00:05:59.160585 [ 694 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_10_10_0 (state Temporary)
2025.01.05 00:05:59.186715 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Renaming temporary part tmp_insert_202501_10_10_0 to 202501_10_10_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:05:59.194625 [ 694 ] {} <Error> void DB::SystemLog<DB::MetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::MetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/tmp_insert_202501_10_10_0/"] ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/202501_10_10_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::MetricLogElement>::savingThreadFunction() @ 0x000000001105dfec
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000ccd0554
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:05:59.195084 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushed system log up to offset 77
2025.01.05 00:06:00.000678 [ 696 ] {} <Trace> AsynchronousMetrics: MemoryTracking: was 555.91 MiB, peak 569.74 MiB, free memory in arenas 53.90 MiB, will set to 554.59 MiB (RSS), difference: -1.32 MiB
2025.01.05 00:06:00.450628 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushing system log, 4305 entries to flush up to offset 47477
2025.01.05 00:06:00.454154 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:06:00.455765 [ 687 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.70 GiB.
2025.01.05 00:06:00.473626 [ 687 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_11_11_0 (state Temporary)
2025.01.05 00:06:00.483955 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Renaming temporary part tmp_insert_202501_11_11_0 to 202501_11_11_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:06:00.487734 [ 687 ] {} <Error> void DB::SystemLog<DB::AsynchronousMetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::AsynchronousMetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/tmp_insert_202501_11_11_0/"] ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/202501_11_11_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::AsynchronousMetricLogElement>::savingThreadFunction() @ 0x000000001104f30c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000cccfe94
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:06:00.488110 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushed system log up to offset 47477
2025.01.05 00:06:01.002476 [ 696 ] {} <Trace> AsynchronousMetrics: MemoryTracking: was 554.57 MiB, peak 569.74 MiB, free memory in arenas 45.43 MiB, will set to 550.54 MiB (RSS), difference: -4.03 MiB
2025.01.05 00:06:06.696131 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushing system log, 7 entries to flush up to offset 84
2025.01.05 00:06:06.718848 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:06:06.720730 [ 694 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.85 GiB.
2025.01.05 00:06:06.751973 [ 694 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_11_11_0 (state Temporary)
2025.01.05 00:06:06.776253 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Renaming temporary part tmp_insert_202501_11_11_0 to 202501_11_11_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:06:06.784231 [ 694 ] {} <Error> void DB::SystemLog<DB::MetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::MetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/tmp_insert_202501_11_11_0/"] ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/202501_11_11_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::MetricLogElement>::savingThreadFunction() @ 0x000000001105dfec
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000ccd0554
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:06:06.784619 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushed system log up to offset 84
2025.01.05 00:06:07.488518 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushing system log, 4305 entries to flush up to offset 51782
2025.01.05 00:06:07.491532 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:06:07.493127 [ 687 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.85 GiB.
2025.01.05 00:06:07.515188 [ 687 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_12_12_0 (state Temporary)
2025.01.05 00:06:07.526971 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Renaming temporary part tmp_insert_202501_12_12_0 to 202501_12_12_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:06:07.530731 [ 687 ] {} <Error> void DB::SystemLog<DB::AsynchronousMetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::AsynchronousMetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/tmp_insert_202501_12_12_0/"] ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/202501_12_12_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::AsynchronousMetricLogElement>::savingThreadFunction() @ 0x000000001104f30c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000cccfe94
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:06:07.531041 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushed system log up to offset 51782
2025.01.05 00:06:12.797646 [ 616 ] {} <Trace> CgroupsMemoryUsageObserver: Read current memory usage 256.80 MiB from cgroups
2025.01.05 00:06:12.882523 [ 159 ] {} <Debug> DNSResolver: Updating DNS cache
2025.01.05 00:06:12.884092 [ 159 ] {} <Debug> DNSResolver: Updated DNS cache
2025.01.05 00:06:14.284983 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushing system log, 8 entries to flush up to offset 92
2025.01.05 00:06:14.332030 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:06:14.333869 [ 694 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.85 GiB.
2025.01.05 00:06:14.360035 [ 694 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_12_12_0 (state Temporary)
2025.01.05 00:06:14.382747 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Renaming temporary part tmp_insert_202501_12_12_0 to 202501_12_12_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:06:14.389924 [ 694 ] {} <Error> void DB::SystemLog<DB::MetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::MetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/tmp_insert_202501_12_12_0/"] ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/202501_12_12_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::MetricLogElement>::savingThreadFunction() @ 0x000000001105dfec
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000ccd0554
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:06:14.390280 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushed system log up to offset 92
2025.01.05 00:06:14.531476 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushing system log, 4305 entries to flush up to offset 56087
2025.01.05 00:06:14.539628 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:06:14.541352 [ 687 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.85 GiB.
2025.01.05 00:06:14.560099 [ 687 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_13_13_0 (state Temporary)
2025.01.05 00:06:14.573298 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Renaming temporary part tmp_insert_202501_13_13_0 to 202501_13_13_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:06:14.578339 [ 687 ] {} <Error> void DB::SystemLog<DB::AsynchronousMetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::AsynchronousMetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/tmp_insert_202501_13_13_0/"] ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/202501_13_13_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::AsynchronousMetricLogElement>::savingThreadFunction() @ 0x000000001104f30c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000cccfe94
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:06:14.578642 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushed system log up to offset 56087
2025.01.05 00:06:15.001216 [ 696 ] {} <Trace> AsynchronousMetrics: MemoryTracking: was 549.57 MiB, peak 569.74 MiB, free memory in arenas 46.91 MiB, will set to 544.29 MiB (RSS), difference: -5.27 MiB
2025.01.05 00:06:21.578876 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushing system log, 4305 entries to flush up to offset 60392
2025.01.05 00:06:21.582044 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:06:21.583830 [ 687 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.85 GiB.
2025.01.05 00:06:21.604512 [ 687 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_14_14_0 (state Temporary)
2025.01.05 00:06:21.618776 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Renaming temporary part tmp_insert_202501_14_14_0 to 202501_14_14_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:06:21.622870 [ 687 ] {} <Error> void DB::SystemLog<DB::AsynchronousMetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::AsynchronousMetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/tmp_insert_202501_14_14_0/"] ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/202501_14_14_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::AsynchronousMetricLogElement>::savingThreadFunction() @ 0x000000001104f30c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000cccfe94
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:06:21.623324 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushed system log up to offset 60392
2025.01.05 00:06:21.891323 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushing system log, 8 entries to flush up to offset 100
2025.01.05 00:06:21.913663 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:06:21.915727 [ 694 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.85 GiB.
2025.01.05 00:06:21.940896 [ 694 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_13_13_0 (state Temporary)
2025.01.05 00:06:21.964040 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Renaming temporary part tmp_insert_202501_13_13_0 to 202501_13_13_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:06:21.972010 [ 694 ] {} <Error> void DB::SystemLog<DB::MetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::MetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/tmp_insert_202501_13_13_0/"] ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/202501_13_13_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::MetricLogElement>::savingThreadFunction() @ 0x000000001105dfec
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000ccd0554
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:06:21.972459 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushed system log up to offset 100
2025.01.05 00:06:22.001065 [ 696 ] {} <Trace> AsynchronousMetrics: MemoryTracking: was 544.21 MiB, peak 569.74 MiB, free memory in arenas 36.36 MiB, will set to 540.73 MiB (RSS), difference: -3.48 MiB
2025.01.05 00:06:27.799623 [ 616 ] {} <Trace> CgroupsMemoryUsageObserver: Read current memory usage 247.97 MiB from cgroups
2025.01.05 00:06:27.885437 [ 160 ] {} <Debug> DNSResolver: Updating DNS cache
2025.01.05 00:06:27.887073 [ 160 ] {} <Debug> DNSResolver: Updated DNS cache
2025.01.05 00:06:28.624021 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushing system log, 4305 entries to flush up to offset 64697
2025.01.05 00:06:28.626950 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:06:28.628827 [ 687 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.94 GiB.
2025.01.05 00:06:28.645133 [ 687 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_15_15_0 (state Temporary)
2025.01.05 00:06:28.658819 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Renaming temporary part tmp_insert_202501_15_15_0 to 202501_15_15_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:06:28.662962 [ 687 ] {} <Error> void DB::SystemLog<DB::AsynchronousMetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::AsynchronousMetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/tmp_insert_202501_15_15_0/"] ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/202501_15_15_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::AsynchronousMetricLogElement>::savingThreadFunction() @ 0x000000001104f30c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000cccfe94
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:06:28.663266 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushed system log up to offset 64697
2025.01.05 00:06:29.001378 [ 696 ] {} <Trace> AsynchronousMetrics: MemoryTracking: was 540.97 MiB, peak 569.74 MiB, free memory in arenas 47.42 MiB, will set to 543.53 MiB (RSS), difference: 2.56 MiB
2025.01.05 00:06:29.472735 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushing system log, 7 entries to flush up to offset 107
2025.01.05 00:06:29.490839 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:06:29.493321 [ 694 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.94 GiB.
2025.01.05 00:06:29.526307 [ 694 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_14_14_0 (state Temporary)
2025.01.05 00:06:29.546971 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Renaming temporary part tmp_insert_202501_14_14_0 to 202501_14_14_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:06:29.554661 [ 694 ] {} <Error> void DB::SystemLog<DB::MetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::MetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/tmp_insert_202501_14_14_0/"] ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/202501_14_14_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::MetricLogElement>::savingThreadFunction() @ 0x000000001105dfec
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000ccd0554
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:06:29.555570 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushed system log up to offset 107
2025.01.05 00:06:35.663803 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushing system log, 4305 entries to flush up to offset 69002
2025.01.05 00:06:35.668219 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:06:35.670031 [ 687 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.94 GiB.
2025.01.05 00:06:35.698660 [ 687 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_16_16_0 (state Temporary)
2025.01.05 00:06:35.712490 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Renaming temporary part tmp_insert_202501_16_16_0 to 202501_16_16_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:06:35.716303 [ 687 ] {} <Error> void DB::SystemLog<DB::AsynchronousMetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::AsynchronousMetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/tmp_insert_202501_16_16_0/"] ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/202501_16_16_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::AsynchronousMetricLogElement>::savingThreadFunction() @ 0x000000001104f30c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000cccfe94
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:06:35.716616 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushed system log up to offset 69002
2025.01.05 00:06:37.056895 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushing system log, 8 entries to flush up to offset 115
2025.01.05 00:06:37.080776 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:06:37.082758 [ 694 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.94 GiB.
2025.01.05 00:06:37.112659 [ 694 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_15_15_0 (state Temporary)
2025.01.05 00:06:37.139261 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Renaming temporary part tmp_insert_202501_15_15_0 to 202501_15_15_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:06:37.146457 [ 694 ] {} <Error> void DB::SystemLog<DB::MetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::MetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/tmp_insert_202501_15_15_0/"] ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/202501_15_15_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::MetricLogElement>::savingThreadFunction() @ 0x000000001105dfec
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000ccd0554
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:06:37.147022 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushed system log up to offset 115
2025.01.05 00:06:42.717606 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushing system log, 4305 entries to flush up to offset 73307
2025.01.05 00:06:42.725590 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:06:42.727252 [ 687 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.94 GiB.
2025.01.05 00:06:42.750514 [ 687 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_17_17_0 (state Temporary)
2025.01.05 00:06:42.763820 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Renaming temporary part tmp_insert_202501_17_17_0 to 202501_17_17_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:06:42.768517 [ 687 ] {} <Error> void DB::SystemLog<DB::AsynchronousMetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::AsynchronousMetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/tmp_insert_202501_17_17_0/"] ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/202501_17_17_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::AsynchronousMetricLogElement>::savingThreadFunction() @ 0x000000001104f30c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000cccfe94
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:06:42.768928 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushed system log up to offset 73307
2025.01.05 00:06:42.802008 [ 616 ] {} <Trace> CgroupsMemoryUsageObserver: Read current memory usage 251.18 MiB from cgroups
2025.01.05 00:06:42.888705 [ 176 ] {} <Debug> DNSResolver: Updating DNS cache
2025.01.05 00:06:42.890421 [ 176 ] {} <Debug> DNSResolver: Updated DNS cache
2025.01.05 00:06:44.021833 [ 696 ] {} <Trace> AsynchronousMetrics: Update heavy metrics. Update period 1 sec. Update heavy metrics period 120 sec. Heavy metrics calculation elapsed: 0.0171189 sec.
2025.01.05 00:06:44.647328 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushing system log, 7 entries to flush up to offset 122
2025.01.05 00:06:44.669604 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:06:44.671476 [ 694 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.94 GiB.
2025.01.05 00:06:44.705279 [ 694 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_16_16_0 (state Temporary)
2025.01.05 00:06:44.728796 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Renaming temporary part tmp_insert_202501_16_16_0 to 202501_16_16_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:06:44.737807 [ 694 ] {} <Error> void DB::SystemLog<DB::MetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::MetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/tmp_insert_202501_16_16_0/"] ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/202501_16_16_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::MetricLogElement>::savingThreadFunction() @ 0x000000001105dfec
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000ccd0554
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:06:44.738540 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushed system log up to offset 122
2025.01.05 00:06:45.000633 [ 696 ] {} <Trace> AsynchronousMetrics: MemoryTracking: was 543.93 MiB, peak 569.74 MiB, free memory in arenas 48.73 MiB, will set to 542.78 MiB (RSS), difference: -1.15 MiB
2025.01.05 00:06:49.769339 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushing system log, 4305 entries to flush up to offset 77612
2025.01.05 00:06:49.772455 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:06:49.781468 [ 687 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.94 GiB.
2025.01.05 00:06:49.826016 [ 687 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_18_18_0 (state Temporary)
2025.01.05 00:06:49.844716 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Renaming temporary part tmp_insert_202501_18_18_0 to 202501_18_18_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:06:49.853571 [ 687 ] {} <Error> void DB::SystemLog<DB::AsynchronousMetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::AsynchronousMetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/tmp_insert_202501_18_18_0/"] ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/202501_18_18_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::AsynchronousMetricLogElement>::savingThreadFunction() @ 0x000000001104f30c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000cccfe94
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:06:49.858457 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushed system log up to offset 77612
2025.01.05 00:06:52.238855 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushing system log, 8 entries to flush up to offset 130
2025.01.05 00:06:52.258480 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:06:52.259430 [ 694 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.94 GiB.
2025.01.05 00:06:52.281866 [ 694 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_17_17_0 (state Temporary)
2025.01.05 00:06:52.304074 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Renaming temporary part tmp_insert_202501_17_17_0 to 202501_17_17_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:06:52.311288 [ 694 ] {} <Error> void DB::SystemLog<DB::MetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::MetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/tmp_insert_202501_17_17_0/"] ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/202501_17_17_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::MetricLogElement>::savingThreadFunction() @ 0x000000001105dfec
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000ccd0554
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:06:52.311721 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushed system log up to offset 130
2025.01.05 00:06:56.862409 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushing system log, 4307 entries to flush up to offset 81919
2025.01.05 00:06:56.870474 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:06:56.873503 [ 687 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.94 GiB.
2025.01.05 00:06:56.898381 [ 687 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_19_19_0 (state Temporary)
2025.01.05 00:06:56.912848 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Renaming temporary part tmp_insert_202501_19_19_0 to 202501_19_19_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:06:56.918152 [ 687 ] {} <Error> void DB::SystemLog<DB::AsynchronousMetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::AsynchronousMetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/tmp_insert_202501_19_19_0/"] ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/202501_19_19_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::AsynchronousMetricLogElement>::savingThreadFunction() @ 0x000000001104f30c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000cccfe94
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:06:56.918765 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushed system log up to offset 81919
2025.01.05 00:06:57.806270 [ 616 ] {} <Trace> CgroupsMemoryUsageObserver: Read current memory usage 250.02 MiB from cgroups
2025.01.05 00:06:57.891608 [ 202 ] {} <Debug> DNSResolver: Updating DNS cache
2025.01.05 00:06:57.892807 [ 202 ] {} <Debug> DNSResolver: Updated DNS cache
2025.01.05 00:06:58.000654 [ 696 ] {} <Trace> AsynchronousMetrics: MemoryTracking: was 542.72 MiB, peak 569.74 MiB, free memory in arenas 48.80 MiB, will set to 544.71 MiB (RSS), difference: 2.00 MiB
2025.01.05 00:06:59.815457 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushing system log, 7 entries to flush up to offset 137
2025.01.05 00:06:59.841964 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:06:59.844795 [ 694 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.94 GiB.
2025.01.05 00:06:59.904420 [ 694 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_18_18_0 (state Temporary)
2025.01.05 00:06:59.953867 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Renaming temporary part tmp_insert_202501_18_18_0 to 202501_18_18_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:06:59.963633 [ 694 ] {} <Error> void DB::SystemLog<DB::MetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::MetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/tmp_insert_202501_18_18_0/"] ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/202501_18_18_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::MetricLogElement>::savingThreadFunction() @ 0x000000001105dfec
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000ccd0554
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:06:59.964252 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushed system log up to offset 137
2025.01.05 00:07:00.000515 [ 696 ] {} <Trace> AsynchronousMetrics: MemoryTracking: was 544.66 MiB, peak 569.74 MiB, free memory in arenas 67.61 MiB, will set to 562.63 MiB (RSS), difference: 17.97 MiB
2025.01.05 00:07:03.919338 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushing system log, 4305 entries to flush up to offset 86224
2025.01.05 00:07:03.924241 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:07:03.926103 [ 687 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.93 GiB.
2025.01.05 00:07:03.945388 [ 687 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_20_20_0 (state Temporary)
2025.01.05 00:07:03.959091 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Renaming temporary part tmp_insert_202501_20_20_0 to 202501_20_20_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:07:03.963692 [ 687 ] {} <Error> void DB::SystemLog<DB::AsynchronousMetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::AsynchronousMetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/tmp_insert_202501_20_20_0/"] ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/202501_20_20_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::AsynchronousMetricLogElement>::savingThreadFunction() @ 0x000000001104f30c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000cccfe94
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:07:03.964014 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushed system log up to offset 86224
2025.01.05 00:07:04.001513 [ 696 ] {} <Trace> AsynchronousMetrics: MemoryTracking: was 562.61 MiB, peak 570.86 MiB, free memory in arenas 56.40 MiB, will set to 559.77 MiB (RSS), difference: -2.84 MiB
2025.01.05 00:07:07.464873 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushing system log, 8 entries to flush up to offset 145
2025.01.05 00:07:07.494948 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:07:07.497028 [ 694 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.93 GiB.
2025.01.05 00:07:07.527772 [ 694 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_19_19_0 (state Temporary)
2025.01.05 00:07:07.552400 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Renaming temporary part tmp_insert_202501_19_19_0 to 202501_19_19_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:07:07.559653 [ 694 ] {} <Error> void DB::SystemLog<DB::MetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::MetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/tmp_insert_202501_19_19_0/"] ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/202501_19_19_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::MetricLogElement>::savingThreadFunction() @ 0x000000001105dfec
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000ccd0554
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:07:07.560096 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushed system log up to offset 145
2025.01.05 00:07:08.000598 [ 696 ] {} <Trace> AsynchronousMetrics: MemoryTracking: was 559.73 MiB, peak 572.66 MiB, free memory in arenas 56.30 MiB, will set to 557.91 MiB (RSS), difference: -1.81 MiB
2025.01.05 00:07:10.964512 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushing system log, 4305 entries to flush up to offset 90529
2025.01.05 00:07:10.967413 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:07:10.969197 [ 687 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.93 GiB.
2025.01.05 00:07:10.987538 [ 687 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_21_21_0 (state Temporary)
2025.01.05 00:07:10.999294 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Renaming temporary part tmp_insert_202501_21_21_0 to 202501_21_21_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:07:11.000559 [ 696 ] {} <Trace> AsynchronousMetrics: MemoryTracking: was 566.15 MiB, peak 572.66 MiB, free memory in arenas 59.73 MiB, will set to 560.62 MiB (RSS), difference: -5.53 MiB
2025.01.05 00:07:11.003648 [ 687 ] {} <Error> void DB::SystemLog<DB::AsynchronousMetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::AsynchronousMetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/tmp_insert_202501_21_21_0/"] ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/202501_21_21_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::AsynchronousMetricLogElement>::savingThreadFunction() @ 0x000000001104f30c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000cccfe94
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:07:11.004045 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushed system log up to offset 90529
2025.01.05 00:07:12.001373 [ 696 ] {} <Trace> AsynchronousMetrics: MemoryTracking: was 552.37 MiB, peak 572.66 MiB, free memory in arenas 67.41 MiB, will set to 560.62 MiB (RSS), difference: 8.25 MiB
2025.01.05 00:07:12.809644 [ 616 ] {} <Trace> CgroupsMemoryUsageObserver: Read current memory usage 268.13 MiB from cgroups
2025.01.05 00:07:12.895062 [ 203 ] {} <Debug> DNSResolver: Updating DNS cache
2025.01.05 00:07:12.896059 [ 203 ] {} <Debug> DNSResolver: Updated DNS cache
2025.01.05 00:07:13.188514 [ 688 ] {} <Trace> SystemLog (system.trace_log): Flushing system log, 2 entries to flush up to offset 29
2025.01.05 00:07:13.190813 [ 688 ] {} <Trace> system.trace_log (e1acc488-6507-4627-a115-261d46c24a4a): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:07:13.192279 [ 688 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.93 GiB.
2025.01.05 00:07:13.209126 [ 688 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_6_6_0 (state Temporary)
2025.01.05 00:07:13.221950 [ 688 ] {} <Trace> system.trace_log (e1acc488-6507-4627-a115-261d46c24a4a): Renaming temporary part tmp_insert_202501_6_6_0 to 202501_6_6_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:07:13.227344 [ 688 ] {} <Error> void DB::SystemLog<DB::TraceLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::TraceLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/e1a/e1acc488-6507-4627-a115-261d46c24a4a/tmp_insert_202501_6_6_0/"] ["/var/lib/clickhouse/store/e1a/e1acc488-6507-4627-a115-261d46c24a4a/202501_6_6_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::TraceLogElement>::savingThreadFunction() @ 0x0000000011091a8c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::TraceLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::TraceLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000ccd1c14
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:07:13.227918 [ 688 ] {} <Trace> SystemLog (system.trace_log): Flushed system log up to offset 29
2025.01.05 00:07:15.061009 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushing system log, 8 entries to flush up to offset 153
2025.01.05 00:07:15.083542 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:07:15.085681 [ 694 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.93 GiB.
2025.01.05 00:07:15.115832 [ 694 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_20_20_0 (state Temporary)
2025.01.05 00:07:15.143492 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Renaming temporary part tmp_insert_202501_20_20_0 to 202501_20_20_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:07:15.152739 [ 694 ] {} <Error> void DB::SystemLog<DB::MetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::MetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/tmp_insert_202501_20_20_0/"] ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/202501_20_20_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::MetricLogElement>::savingThreadFunction() @ 0x000000001105dfec
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000ccd0554
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:07:15.153469 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushed system log up to offset 153
2025.01.05 00:07:16.002019 [ 696 ] {} <Trace> AsynchronousMetrics: MemoryTracking: was 560.83 MiB, peak 573.77 MiB, free memory in arenas 86.33 MiB, will set to 580.31 MiB (RSS), difference: 19.48 MiB
2025.01.05 00:07:18.004302 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushing system log, 4305 entries to flush up to offset 94834
2025.01.05 00:07:18.007440 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:07:18.009117 [ 687 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.93 GiB.
2025.01.05 00:07:18.031080 [ 687 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_22_22_0 (state Temporary)
2025.01.05 00:07:18.042582 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Renaming temporary part tmp_insert_202501_22_22_0 to 202501_22_22_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:07:18.046727 [ 687 ] {} <Error> void DB::SystemLog<DB::AsynchronousMetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::AsynchronousMetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/tmp_insert_202501_22_22_0/"] ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/202501_22_22_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::AsynchronousMetricLogElement>::savingThreadFunction() @ 0x000000001104f30c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000cccfe94
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:07:18.047304 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushed system log up to offset 94834
2025.01.05 00:07:20.728989 [ 688 ] {} <Trace> SystemLog (system.trace_log): Flushing system log, 4 entries to flush up to offset 33
2025.01.05 00:07:20.729905 [ 688 ] {} <Trace> system.trace_log (e1acc488-6507-4627-a115-261d46c24a4a): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:07:20.732029 [ 688 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.93 GiB.
2025.01.05 00:07:20.750772 [ 688 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_7_7_0 (state Temporary)
2025.01.05 00:07:20.762765 [ 688 ] {} <Trace> system.trace_log (e1acc488-6507-4627-a115-261d46c24a4a): Renaming temporary part tmp_insert_202501_7_7_0 to 202501_7_7_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:07:20.767346 [ 688 ] {} <Error> void DB::SystemLog<DB::TraceLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::TraceLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/e1a/e1acc488-6507-4627-a115-261d46c24a4a/tmp_insert_202501_7_7_0/"] ["/var/lib/clickhouse/store/e1a/e1acc488-6507-4627-a115-261d46c24a4a/202501_7_7_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::TraceLogElement>::savingThreadFunction() @ 0x0000000011091a8c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::TraceLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::TraceLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000ccd1c14
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:07:20.767861 [ 688 ] {} <Trace> SystemLog (system.trace_log): Flushed system log up to offset 33
2025.01.05 00:07:22.654642 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushing system log, 7 entries to flush up to offset 160
2025.01.05 00:07:22.677875 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:07:22.680018 [ 694 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.93 GiB.
2025.01.05 00:07:22.708948 [ 694 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_21_21_0 (state Temporary)
2025.01.05 00:07:22.733521 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Renaming temporary part tmp_insert_202501_21_21_0 to 202501_21_21_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:07:22.742360 [ 694 ] {} <Error> void DB::SystemLog<DB::MetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::MetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/tmp_insert_202501_21_21_0/"] ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/202501_21_21_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::MetricLogElement>::savingThreadFunction() @ 0x000000001105dfec
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000ccd0554
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:07:22.742908 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushed system log up to offset 160
2025.01.05 00:07:23.002057 [ 696 ] {} <Trace> AsynchronousMetrics: MemoryTracking: was 580.43 MiB, peak 593.36 MiB, free memory in arenas 90.11 MiB, will set to 579.02 MiB (RSS), difference: -1.41 MiB
2025.01.05 00:07:25.048570 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushing system log, 4920 entries to flush up to offset 99754
2025.01.05 00:07:25.062973 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:07:25.064951 [ 687 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.93 GiB.
2025.01.05 00:07:25.087128 [ 687 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_23_23_0 (state Temporary)
2025.01.05 00:07:25.099867 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Renaming temporary part tmp_insert_202501_23_23_0 to 202501_23_23_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:07:25.104777 [ 687 ] {} <Error> void DB::SystemLog<DB::AsynchronousMetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::AsynchronousMetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/tmp_insert_202501_23_23_0/"] ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/202501_23_23_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::AsynchronousMetricLogElement>::savingThreadFunction() @ 0x000000001104f30c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000cccfe94
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:07:25.105618 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushed system log up to offset 99754
2025.01.05 00:07:27.811980 [ 616 ] {} <Trace> CgroupsMemoryUsageObserver: Read current memory usage 286.66 MiB from cgroups
2025.01.05 00:07:27.897407 [ 204 ] {} <Debug> DNSResolver: Updating DNS cache
2025.01.05 00:07:27.899389 [ 204 ] {} <Debug> DNSResolver: Updated DNS cache
2025.01.05 00:07:28.269033 [ 688 ] {} <Trace> SystemLog (system.trace_log): Flushing system log, 2 entries to flush up to offset 35
2025.01.05 00:07:28.270000 [ 688 ] {} <Trace> system.trace_log (e1acc488-6507-4627-a115-261d46c24a4a): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:07:28.271950 [ 688 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.93 GiB.
2025.01.05 00:07:28.292772 [ 688 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_8_8_0 (state Temporary)
2025.01.05 00:07:28.307560 [ 688 ] {} <Trace> system.trace_log (e1acc488-6507-4627-a115-261d46c24a4a): Renaming temporary part tmp_insert_202501_8_8_0 to 202501_8_8_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:07:28.313714 [ 688 ] {} <Error> void DB::SystemLog<DB::TraceLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::TraceLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/e1a/e1acc488-6507-4627-a115-261d46c24a4a/tmp_insert_202501_8_8_0/"] ["/var/lib/clickhouse/store/e1a/e1acc488-6507-4627-a115-261d46c24a4a/202501_8_8_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::TraceLogElement>::savingThreadFunction() @ 0x0000000011091a8c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::TraceLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::TraceLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000ccd1c14
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:07:28.314130 [ 688 ] {} <Trace> SystemLog (system.trace_log): Flushed system log up to offset 35
2025.01.05 00:07:30.244067 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushing system log, 8 entries to flush up to offset 168
2025.01.05 00:07:30.265411 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:07:30.267077 [ 694 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.93 GiB.
2025.01.05 00:07:30.307604 [ 694 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_22_22_0 (state Temporary)
2025.01.05 00:07:30.336968 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Renaming temporary part tmp_insert_202501_22_22_0 to 202501_22_22_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:07:30.344625 [ 694 ] {} <Error> void DB::SystemLog<DB::MetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::MetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/tmp_insert_202501_22_22_0/"] ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/202501_22_22_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::MetricLogElement>::savingThreadFunction() @ 0x000000001105dfec
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000ccd0554
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:07:30.345191 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushed system log up to offset 168
2025.01.05 00:07:32.106140 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushing system log, 4305 entries to flush up to offset 104059
2025.01.05 00:07:32.112349 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:07:32.114949 [ 687 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.93 GiB.
2025.01.05 00:07:32.135891 [ 687 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_24_24_0 (state Temporary)
2025.01.05 00:07:32.150074 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Renaming temporary part tmp_insert_202501_24_24_0 to 202501_24_24_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:07:32.154326 [ 687 ] {} <Error> void DB::SystemLog<DB::AsynchronousMetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::AsynchronousMetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/tmp_insert_202501_24_24_0/"] ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/202501_24_24_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::AsynchronousMetricLogElement>::savingThreadFunction() @ 0x000000001104f30c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000cccfe94
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:07:32.154952 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushed system log up to offset 104059
2025.01.05 00:07:37.845632 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushing system log, 7 entries to flush up to offset 175
2025.01.05 00:07:37.866074 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:07:37.867926 [ 694 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.93 GiB.
2025.01.05 00:07:37.898332 [ 694 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_23_23_0 (state Temporary)
2025.01.05 00:07:37.924438 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Renaming temporary part tmp_insert_202501_23_23_0 to 202501_23_23_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:07:37.931717 [ 694 ] {} <Error> void DB::SystemLog<DB::MetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::MetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/tmp_insert_202501_23_23_0/"] ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/202501_23_23_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::MetricLogElement>::savingThreadFunction() @ 0x000000001105dfec
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000ccd0554
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:07:37.932221 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushed system log up to offset 175
2025.01.05 00:07:38.000514 [ 696 ] {} <Trace> AsynchronousMetrics: MemoryTracking: was 579.62 MiB, peak 593.36 MiB, free memory in arenas 90.16 MiB, will set to 576.18 MiB (RSS), difference: -3.44 MiB
2025.01.05 00:07:39.155288 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushing system log, 4305 entries to flush up to offset 108364
2025.01.05 00:07:39.158127 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:07:39.159204 [ 687 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.93 GiB.
2025.01.05 00:07:39.172724 [ 687 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_25_25_0 (state Temporary)
2025.01.05 00:07:39.185130 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Renaming temporary part tmp_insert_202501_25_25_0 to 202501_25_25_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:07:39.189251 [ 687 ] {} <Error> void DB::SystemLog<DB::AsynchronousMetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::AsynchronousMetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/tmp_insert_202501_25_25_0/"] ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/202501_25_25_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::AsynchronousMetricLogElement>::savingThreadFunction() @ 0x000000001104f30c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000cccfe94
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:07:39.189634 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushed system log up to offset 108364
2025.01.05 00:07:42.812867 [ 616 ] {} <Trace> CgroupsMemoryUsageObserver: Read current memory usage 283.68 MiB from cgroups
2025.01.05 00:07:42.900871 [ 205 ] {} <Debug> DNSResolver: Updating DNS cache
2025.01.05 00:07:42.901441 [ 205 ] {} <Debug> DNSResolver: Updated DNS cache
2025.01.05 00:07:45.433078 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushing system log, 8 entries to flush up to offset 183
2025.01.05 00:07:45.463531 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:07:45.464825 [ 694 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.93 GiB.
2025.01.05 00:07:45.486789 [ 694 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_24_24_0 (state Temporary)
2025.01.05 00:07:45.509472 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Renaming temporary part tmp_insert_202501_24_24_0 to 202501_24_24_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:07:45.516981 [ 694 ] {} <Error> void DB::SystemLog<DB::MetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::MetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/tmp_insert_202501_24_24_0/"] ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/202501_24_24_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::MetricLogElement>::savingThreadFunction() @ 0x000000001105dfec
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000ccd0554
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:07:45.517715 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushed system log up to offset 183
2025.01.05 00:07:46.000830 [ 696 ] {} <Trace> AsynchronousMetrics: MemoryTracking: was 576.14 MiB, peak 593.36 MiB, free memory in arenas 82.74 MiB, will set to 569.04 MiB (RSS), difference: -7.10 MiB
2025.01.05 00:07:46.190276 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushing system log, 4305 entries to flush up to offset 112669
2025.01.05 00:07:46.193915 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:07:46.195241 [ 687 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.93 GiB.
2025.01.05 00:07:46.217452 [ 687 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_26_26_0 (state Temporary)
2025.01.05 00:07:46.230670 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Renaming temporary part tmp_insert_202501_26_26_0 to 202501_26_26_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:07:46.235123 [ 687 ] {} <Error> void DB::SystemLog<DB::AsynchronousMetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::AsynchronousMetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/tmp_insert_202501_26_26_0/"] ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/202501_26_26_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::AsynchronousMetricLogElement>::savingThreadFunction() @ 0x000000001104f30c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000cccfe94
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:07:46.235630 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushed system log up to offset 112669
2025.01.05 00:07:46.769039 [ 48 ] {} <Trace> HTTPHandler-factory: HTTP Request for HTTPHandler-factory. Method: POST, Address: 172.26.0.6:58232, User-Agent: python-httpx/0.28.1, Length: 14, Content Type: , Transfer Encoding: identity, X-Forwarded-For: (none)
2025.01.05 00:07:46.770496 [ 48 ] {} <Trace> DynamicQueryHandler: Request URI: /
2025.01.05 00:07:46.770844 [ 48 ] {} <Debug> HTTP-Session: 47519b2e-d4d3-49f0-9d7f-f83985596214 Authenticating user 'default' from 172.26.0.6:58232
2025.01.05 00:07:46.771419 [ 48 ] {} <Debug> HTTP-Session: 47519b2e-d4d3-49f0-9d7f-f83985596214 Authenticated with global context as user 94309d50-4f52-5250-31bd-74fecac179db
2025.01.05 00:07:46.771562 [ 48 ] {} <Debug> HTTP-Session: 47519b2e-d4d3-49f0-9d7f-f83985596214 Creating session context with user_id: 94309d50-4f52-5250-31bd-74fecac179db
2025.01.05 00:07:46.771915 [ 48 ] {} <Trace> ContextAccess (default): Settings: readonly = 0, allow_ddl = true, allow_introspection_functions = false
2025.01.05 00:07:46.772101 [ 48 ] {} <Trace> ContextAccess (default): List of all grants: GRANT SHOW, SELECT, INSERT, ALTER, CREATE, DROP, UNDROP TABLE, TRUNCATE, OPTIMIZE, BACKUP, KILL QUERY, KILL TRANSACTION, MOVE PARTITION BETWEEN SHARDS, ACCESS MANAGEMENT, SYSTEM, dictGet, displaySecretsInShowAndSelect, INTROSPECTION, SOURCES, CLUSTER ON *.* WITH GRANT OPTION, GRANT SET DEFINER ON * WITH GRANT OPTION, GRANT ALTER NAMED COLLECTION, CREATE NAMED COLLECTION, DROP NAMED COLLECTION, SHOW NAMED COLLECTIONS, NAMED COLLECTION ON * WITH GRANT OPTION
2025.01.05 00:07:46.772449 [ 48 ] {} <Trace> ContextAccess (default): List of all grants including implicit: GRANT SHOW, SELECT, INSERT, ALTER, CREATE, DROP, UNDROP TABLE, TRUNCATE, OPTIMIZE, BACKUP, KILL QUERY, KILL TRANSACTION, MOVE PARTITION BETWEEN SHARDS, ACCESS MANAGEMENT, SYSTEM, dictGet, displaySecretsInShowAndSelect, INTROSPECTION, SOURCES, CLUSTER ON *.* WITH GRANT OPTION, GRANT SET DEFINER ON * WITH GRANT OPTION, GRANT ALTER NAMED COLLECTION, CREATE NAMED COLLECTION, DROP NAMED COLLECTION, SHOW NAMED COLLECTIONS, NAMED COLLECTION ON * WITH GRANT OPTION
2025.01.05 00:07:46.772597 [ 48 ] {} <Trace> HTTP-Session: 47519b2e-d4d3-49f0-9d7f-f83985596214 Creating query context from session context, user_id: 94309d50-4f52-5250-31bd-74fecac179db, parent context user: default
2025.01.05 00:07:46.773084 [ 48 ] {9161ac57-8ae5-4b80-a455-d43448e04301} <Debug> executeQuery: (from 172.26.0.6:58232) SHOW DATABASES (stage: Complete)
2025.01.05 00:07:46.773406 [ 48 ] {9161ac57-8ae5-4b80-a455-d43448e04301} <Debug> executeQuery: (internal) SELECT name FROM system.databases ORDER BY name (stage: Complete)
2025.01.05 00:07:46.774112 [ 48 ] {9161ac57-8ae5-4b80-a455-d43448e04301} <Trace> Planner: Query SELECT __table1.name AS name FROM system.databases AS __table1 ORDER BY __table1.name ASC to stage Complete
2025.01.05 00:07:46.774274 [ 48 ] {9161ac57-8ae5-4b80-a455-d43448e04301} <Trace> ContextAccess (default): Access granted: SELECT(name) ON system.databases
2025.01.05 00:07:46.774781 [ 48 ] {9161ac57-8ae5-4b80-a455-d43448e04301} <Trace> Planner: Query SELECT __table1.name AS name FROM system.databases AS __table1 ORDER BY __table1.name ASC from stage FetchColumns to stage Complete
2025.01.05 00:07:46.775210 [ 48 ] {9161ac57-8ae5-4b80-a455-d43448e04301} <Trace> ContextAccess (default): Access granted: SHOW DATABASES ON *.*
2025.01.05 00:07:46.778569 [ 48 ] {9161ac57-8ae5-4b80-a455-d43448e04301} <Debug> executeQuery: Read 4 rows, 85.00 B in 0.005516 sec., 725.1631617113851 rows/sec., 15.05 KiB/sec.
2025.01.05 00:07:46.779570 [ 48 ] {9161ac57-8ae5-4b80-a455-d43448e04301} <Debug> DynamicQueryHandler: Done processing query
2025.01.05 00:07:46.779750 [ 48 ] {9161ac57-8ae5-4b80-a455-d43448e04301} <Debug> MemoryTracker: Peak memory usage (for query): 4.00 MiB.
2025.01.05 00:07:46.779886 [ 48 ] {} <Debug> HTTP-Session: 47519b2e-d4d3-49f0-9d7f-f83985596214 Logout, user_id: 94309d50-4f52-5250-31bd-74fecac179db
2025.01.05 00:07:47.001849 [ 696 ] {} <Trace> AsynchronousMetrics: MemoryTracking: was 569.06 MiB, peak 593.36 MiB, free memory in arenas 86.64 MiB, will set to 570.99 MiB (RSS), difference: 1.93 MiB
2025.01.05 00:07:50.386863 [ 684 ] {} <Trace> SystemLog (system.processors_profile_log): Flushing system log, 12 entries to flush up to offset 12
2025.01.05 00:07:50.387159 [ 682 ] {} <Trace> SystemLog (system.query_log): Flushing system log, 2 entries to flush up to offset 2
2025.01.05 00:07:50.388635 [ 684 ] {} <Debug> SystemLog (system.processors_profile_log): Creating new table system.processors_profile_log for ProcessorsProfileLog
2025.01.05 00:07:50.389505 [ 682 ] {} <Debug> SystemLog (system.query_log): Creating new table system.query_log for QueryLog
2025.01.05 00:07:50.428963 [ 684 ] {} <Debug> system.processors_profile_log (a78c3597-bcb7-4103-a298-cd83b740745d): Loading data parts
2025.01.05 00:07:50.430326 [ 682 ] {} <Debug> system.query_log (e8fd04c9-4eac-43ac-800b-3ecfbd18c5b3): Loading data parts
2025.01.05 00:07:50.433682 [ 684 ] {} <Debug> system.processors_profile_log (a78c3597-bcb7-4103-a298-cd83b740745d): There are no data parts
2025.01.05 00:07:50.435089 [ 682 ] {} <Debug> system.query_log (e8fd04c9-4eac-43ac-800b-3ecfbd18c5b3): There are no data parts
2025.01.05 00:07:50.465229 [ 684 ] {} <Trace> system.processors_profile_log (a78c3597-bcb7-4103-a298-cd83b740745d): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:07:50.466133 [ 684 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.93 GiB.
2025.01.05 00:07:50.470863 [ 682 ] {} <Trace> system.query_log (e8fd04c9-4eac-43ac-800b-3ecfbd18c5b3): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:07:50.472179 [ 682 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.93 GiB.
2025.01.05 00:07:50.483273 [ 684 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_1_1_0 (state Temporary)
2025.01.05 00:07:50.490308 [ 682 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_1_1_0 (state Temporary)
2025.01.05 00:07:50.498589 [ 684 ] {} <Trace> system.processors_profile_log (a78c3597-bcb7-4103-a298-cd83b740745d): Renaming temporary part tmp_insert_202501_1_1_0 to 202501_1_1_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:07:50.505324 [ 684 ] {} <Error> void DB::SystemLog<DB::ProcessorProfileLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::ProcessorProfileLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/a78/a78c3597-bcb7-4103-a298-cd83b740745d/tmp_insert_202501_1_1_0/"] ["/var/lib/clickhouse/store/a78/a78c3597-bcb7-4103-a298-cd83b740745d/202501_1_1_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::ProcessorProfileLogElement>::savingThreadFunction() @ 0x00000000110a7a0c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::ProcessorProfileLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::ProcessorProfileLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000ccd2594
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:07:50.505677 [ 682 ] {} <Trace> system.query_log (e8fd04c9-4eac-43ac-800b-3ecfbd18c5b3): Renaming temporary part tmp_insert_202501_1_1_0 to 202501_1_1_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:07:50.505800 [ 684 ] {} <Trace> SystemLog (system.processors_profile_log): Flushed system log up to offset 12
2025.01.05 00:07:50.511707 [ 682 ] {} <Error> void DB::SystemLog<DB::QueryLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::QueryLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/e8f/e8fd04c9-4eac-43ac-800b-3ecfbd18c5b3/tmp_insert_202501_1_1_0/"] ["/var/lib/clickhouse/store/e8f/e8fd04c9-4eac-43ac-800b-3ecfbd18c5b3/202501_1_1_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::QueryLogElement>::savingThreadFunction() @ 0x000000001107432c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::QueryLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::QueryLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000ccd0f14
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:07:50.512264 [ 682 ] {} <Trace> SystemLog (system.query_log): Flushed system log up to offset 2
2025.01.05 00:07:51.000663 [ 696 ] {} <Trace> AsynchronousMetrics: MemoryTracking: was 575.33 MiB, peak 593.36 MiB, free memory in arenas 79.40 MiB, will set to 566.06 MiB (RSS), difference: -9.27 MiB
2025.01.05 00:07:53.017987 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushing system log, 8 entries to flush up to offset 191
2025.01.05 00:07:53.037892 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:07:53.038988 [ 694 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.93 GiB.
2025.01.05 00:07:53.070195 [ 694 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_25_25_0 (state Temporary)
2025.01.05 00:07:53.092880 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Renaming temporary part tmp_insert_202501_25_25_0 to 202501_25_25_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:07:53.102321 [ 694 ] {} <Error> void DB::SystemLog<DB::MetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::MetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/tmp_insert_202501_25_25_0/"] ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/202501_25_25_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::MetricLogElement>::savingThreadFunction() @ 0x000000001105dfec
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000ccd0554
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:07:53.102791 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushed system log up to offset 191
2025.01.05 00:07:53.236618 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushing system log, 4305 entries to flush up to offset 116974
2025.01.05 00:07:53.241278 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:07:53.242585 [ 687 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.93 GiB.
2025.01.05 00:07:53.258097 [ 687 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_27_27_0 (state Temporary)
2025.01.05 00:07:53.269533 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Renaming temporary part tmp_insert_202501_27_27_0 to 202501_27_27_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:07:53.273581 [ 687 ] {} <Error> void DB::SystemLog<DB::AsynchronousMetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::AsynchronousMetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/tmp_insert_202501_27_27_0/"] ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/202501_27_27_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::AsynchronousMetricLogElement>::savingThreadFunction() @ 0x000000001104f30c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000cccfe94
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:07:53.274014 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushed system log up to offset 116974
2025.01.05 00:07:57.814214 [ 616 ] {} <Trace> CgroupsMemoryUsageObserver: Read current memory usage 273.63 MiB from cgroups
2025.01.05 00:07:57.902038 [ 231 ] {} <Debug> DNSResolver: Updating DNS cache
2025.01.05 00:07:57.902604 [ 231 ] {} <Debug> DNSResolver: Updated DNS cache
2025.01.05 00:08:00.274390 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushing system log, 4305 entries to flush up to offset 121279
2025.01.05 00:08:00.281722 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:08:00.283400 [ 687 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.93 GiB.
2025.01.05 00:08:00.299670 [ 687 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_28_28_0 (state Temporary)
2025.01.05 00:08:00.313942 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Renaming temporary part tmp_insert_202501_28_28_0 to 202501_28_28_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:08:00.318533 [ 687 ] {} <Error> void DB::SystemLog<DB::AsynchronousMetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::AsynchronousMetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/tmp_insert_202501_28_28_0/"] ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/202501_28_28_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::AsynchronousMetricLogElement>::savingThreadFunction() @ 0x000000001104f30c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000cccfe94
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:08:00.318975 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushed system log up to offset 121279
2025.01.05 00:08:00.603742 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushing system log, 7 entries to flush up to offset 198
2025.01.05 00:08:00.624487 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:08:00.626671 [ 694 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.93 GiB.
2025.01.05 00:08:00.661158 [ 694 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_26_26_0 (state Temporary)
2025.01.05 00:08:00.689598 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Renaming temporary part tmp_insert_202501_26_26_0 to 202501_26_26_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:08:00.699739 [ 694 ] {} <Error> void DB::SystemLog<DB::MetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::MetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/tmp_insert_202501_26_26_0/"] ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/202501_26_26_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::MetricLogElement>::savingThreadFunction() @ 0x000000001105dfec
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000ccd0554
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:08:00.700417 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushed system log up to offset 198
2025.01.05 00:08:01.000724 [ 696 ] {} <Trace> AsynchronousMetrics: MemoryTracking: was 565.79 MiB, peak 593.36 MiB, free memory in arenas 89.28 MiB, will set to 574.77 MiB (RSS), difference: 8.98 MiB
2025.01.05 00:08:07.319456 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushing system log, 4305 entries to flush up to offset 125584
2025.01.05 00:08:07.327189 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:08:07.328927 [ 687 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.93 GiB.
2025.01.05 00:08:07.354176 [ 687 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_29_29_0 (state Temporary)
2025.01.05 00:08:07.367484 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Renaming temporary part tmp_insert_202501_29_29_0 to 202501_29_29_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:08:07.371279 [ 687 ] {} <Error> void DB::SystemLog<DB::AsynchronousMetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::AsynchronousMetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/tmp_insert_202501_29_29_0/"] ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/202501_29_29_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::AsynchronousMetricLogElement>::savingThreadFunction() @ 0x000000001104f30c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000cccfe94
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:08:07.371624 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushed system log up to offset 125584
2025.01.05 00:08:08.200760 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushing system log, 8 entries to flush up to offset 206
2025.01.05 00:08:08.220142 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:08:08.221728 [ 694 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.93 GiB.
2025.01.05 00:08:08.246668 [ 694 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_27_27_0 (state Temporary)
2025.01.05 00:08:08.272910 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Renaming temporary part tmp_insert_202501_27_27_0 to 202501_27_27_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:08:08.282143 [ 694 ] {} <Error> void DB::SystemLog<DB::MetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::MetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/tmp_insert_202501_27_27_0/"] ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/202501_27_27_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::MetricLogElement>::savingThreadFunction() @ 0x000000001105dfec
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000ccd0554
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:08:08.282755 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushed system log up to offset 206
2025.01.05 00:08:12.815061 [ 616 ] {} <Trace> CgroupsMemoryUsageObserver: Read current memory usage 284.05 MiB from cgroups
2025.01.05 00:08:12.903144 [ 236 ] {} <Debug> DNSResolver: Updating DNS cache
2025.01.05 00:08:12.903593 [ 236 ] {} <Debug> DNSResolver: Updated DNS cache
2025.01.05 00:08:14.372019 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushing system log, 4305 entries to flush up to offset 129889
2025.01.05 00:08:14.375091 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:08:14.376537 [ 687 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.93 GiB.
2025.01.05 00:08:14.392654 [ 687 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_30_30_0 (state Temporary)
2025.01.05 00:08:14.406501 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Renaming temporary part tmp_insert_202501_30_30_0 to 202501_30_30_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:08:14.410532 [ 687 ] {} <Error> void DB::SystemLog<DB::AsynchronousMetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::AsynchronousMetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/tmp_insert_202501_30_30_0/"] ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/202501_30_30_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::AsynchronousMetricLogElement>::savingThreadFunction() @ 0x000000001104f30c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000cccfe94
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:08:14.411233 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushed system log up to offset 129889
2025.01.05 00:08:15.783862 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushing system log, 7 entries to flush up to offset 213
2025.01.05 00:08:15.818529 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:08:15.820706 [ 694 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.93 GiB.
2025.01.05 00:08:15.852675 [ 694 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_28_28_0 (state Temporary)
2025.01.05 00:08:15.879049 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Renaming temporary part tmp_insert_202501_28_28_0 to 202501_28_28_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:08:15.886086 [ 694 ] {} <Error> void DB::SystemLog<DB::MetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::MetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/tmp_insert_202501_28_28_0/"] ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/202501_28_28_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::MetricLogElement>::savingThreadFunction() @ 0x000000001105dfec
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000ccd0554
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:08:15.886536 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushed system log up to offset 213
2025.01.05 00:08:20.625057 [ 48 ] {} <Trace> HTTPHandler-factory: HTTP Request for HTTPHandler-factory. Method: POST, Address: 172.26.0.6:38796, User-Agent: python-httpx/0.28.1, Length: 35, Content Type: , Transfer Encoding: identity, X-Forwarded-For: (none)
2025.01.05 00:08:20.625615 [ 48 ] {} <Trace> DynamicQueryHandler: Request URI: /
2025.01.05 00:08:20.626092 [ 48 ] {} <Debug> HTTP-Session: f1ea3455-e1e0-4da6-a425-f86d63f21792 Authenticating user 'default' from 172.26.0.6:38796
2025.01.05 00:08:20.626480 [ 48 ] {} <Debug> HTTP-Session: f1ea3455-e1e0-4da6-a425-f86d63f21792 Authenticated with global context as user 94309d50-4f52-5250-31bd-74fecac179db
2025.01.05 00:08:20.626929 [ 48 ] {} <Debug> HTTP-Session: f1ea3455-e1e0-4da6-a425-f86d63f21792 Creating session context with user_id: 94309d50-4f52-5250-31bd-74fecac179db
2025.01.05 00:08:20.627349 [ 48 ] {} <Trace> HTTP-Session: f1ea3455-e1e0-4da6-a425-f86d63f21792 Creating query context from session context, user_id: 94309d50-4f52-5250-31bd-74fecac179db, parent context user: default
2025.01.05 00:08:20.627764 [ 48 ] {e83e6939-908d-483d-a784-5608ac24989d} <Debug> executeQuery: (from 172.26.0.6:38796) CREATE DATABASE IF NOT EXISTS lolke (stage: Complete)
2025.01.05 00:08:20.628202 [ 48 ] {e83e6939-908d-483d-a784-5608ac24989d} <Trace> ContextAccess (default): Access granted: CREATE DATABASE ON lolke.*
2025.01.05 00:08:20.654532 [ 48 ] {e83e6939-908d-483d-a784-5608ac24989d} <Information> DatabaseAtomic (lolke): Metadata processed, database lolke has 0 tables and 0 dictionaries in total.
2025.01.05 00:08:20.654674 [ 48 ] {e83e6939-908d-483d-a784-5608ac24989d} <Information> TablesLoader: Parsed metadata of 0 tables in 1 databases in 0.0021793 sec
2025.01.05 00:08:20.654828 [ 48 ] {e83e6939-908d-483d-a784-5608ac24989d} <Trace> ReferentialDeps: No tables
2025.01.05 00:08:20.654953 [ 48 ] {e83e6939-908d-483d-a784-5608ac24989d} <Trace> LoadingDeps: No tables
2025.01.05 00:08:20.655136 [ 48 ] {e83e6939-908d-483d-a784-5608ac24989d} <Debug> AsyncLoader: Prioritize load job 'startup Atomic database lolke': BgStartup -> FgLoad
2025.01.05 00:08:20.655260 [ 48 ] {e83e6939-908d-483d-a784-5608ac24989d} <Debug> AsyncLoader: Prioritize load job 'startup Ordinary database lolke': BgStartup -> FgLoad
2025.01.05 00:08:20.655388 [ 48 ] {e83e6939-908d-483d-a784-5608ac24989d} <Debug> AsyncLoader: Schedule load job 'startup Ordinary database lolke' into FgLoad
2025.01.05 00:08:20.655510 [ 48 ] {e83e6939-908d-483d-a784-5608ac24989d} <Debug> AsyncLoader: Schedule load job 'startup Atomic database lolke' into FgLoad
2025.01.05 00:08:20.655664 [ 48 ] {e83e6939-908d-483d-a784-5608ac24989d} <Debug> AsyncLoader: Change current priority: none -> 0
2025.01.05 00:08:20.655801 [ 48 ] {e83e6939-908d-483d-a784-5608ac24989d} <Debug> AsyncLoader: Spawn loader worker #1 in FgLoad
2025.01.05 00:08:20.656141 [ 48 ] {e83e6939-908d-483d-a784-5608ac24989d} <Debug> AsyncLoader: Wait load job 'startup Atomic database lolke' in FgLoad
2025.01.05 00:08:20.656234 [ 708 ] {} <Debug> AsyncLoader: Execute load job 'startup Ordinary database lolke' in FgLoad
2025.01.05 00:08:20.656620 [ 708 ] {} <Debug> AsyncLoader: Finish load job 'startup Ordinary database lolke' with status OK
2025.01.05 00:08:20.656953 [ 708 ] {} <Debug> AsyncLoader: Spawn loader worker #2 in FgLoad
2025.01.05 00:08:20.657164 [ 708 ] {} <Debug> AsyncLoader: Execute load job 'startup Atomic database lolke' in FgLoad
2025.01.05 00:08:20.657387 [ 710 ] {} <Debug> AsyncLoader: Stop worker in FgLoad
2025.01.05 00:08:20.657570 [ 708 ] {} <Debug> AsyncLoader: Finish load job 'startup Atomic database lolke' with status OK
2025.01.05 00:08:20.657702 [ 708 ] {} <Debug> AsyncLoader: Stop worker in FgLoad
2025.01.05 00:08:20.657845 [ 708 ] {} <Debug> AsyncLoader: Change current priority: 0 -> none
2025.01.05 00:08:20.657800 [ 48 ] {e83e6939-908d-483d-a784-5608ac24989d} <Debug> DynamicQueryHandler: Done processing query
2025.01.05 00:08:20.658154 [ 48 ] {} <Debug> HTTP-Session: f1ea3455-e1e0-4da6-a425-f86d63f21792 Logout, user_id: 94309d50-4f52-5250-31bd-74fecac179db
2025.01.05 00:08:21.411927 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushing system log, 4305 entries to flush up to offset 134194
2025.01.05 00:08:21.415243 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:08:21.417286 [ 687 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.93 GiB.
2025.01.05 00:08:21.441008 [ 687 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_31_31_0 (state Temporary)
2025.01.05 00:08:21.457111 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Renaming temporary part tmp_insert_202501_31_31_0 to 202501_31_31_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:08:21.461284 [ 687 ] {} <Error> void DB::SystemLog<DB::AsynchronousMetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::AsynchronousMetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/tmp_insert_202501_31_31_0/"] ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/202501_31_31_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::AsynchronousMetricLogElement>::savingThreadFunction() @ 0x000000001104f30c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000cccfe94
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:08:21.461605 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushed system log up to offset 134194
2025.01.05 00:08:23.387638 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushing system log, 8 entries to flush up to offset 221
2025.01.05 00:08:23.413531 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:08:23.415407 [ 694 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.93 GiB.
2025.01.05 00:08:23.447507 [ 694 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_29_29_0 (state Temporary)
2025.01.05 00:08:23.471038 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Renaming temporary part tmp_insert_202501_29_29_0 to 202501_29_29_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:08:23.477908 [ 694 ] {} <Error> void DB::SystemLog<DB::MetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::MetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/tmp_insert_202501_29_29_0/"] ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/202501_29_29_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::MetricLogElement>::savingThreadFunction() @ 0x000000001105dfec
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000ccd0554
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:08:23.478732 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushed system log up to offset 221
2025.01.05 00:08:24.000486 [ 696 ] {} <Trace> AsynchronousMetrics: MemoryTracking: was 575.43 MiB, peak 593.36 MiB, free memory in arenas 103.57 MiB, will set to 589.96 MiB (RSS), difference: 14.54 MiB
2025.01.05 00:08:27.816227 [ 616 ] {} <Trace> CgroupsMemoryUsageObserver: Read current memory usage 298.33 MiB from cgroups
2025.01.05 00:08:27.904310 [ 223 ] {} <Debug> DNSResolver: Updating DNS cache
2025.01.05 00:08:27.905623 [ 223 ] {} <Debug> DNSResolver: Updated DNS cache
2025.01.05 00:08:28.014513 [ 682 ] {} <Trace> SystemLog (system.query_log): Flushing system log, 2 entries to flush up to offset 4
2025.01.05 00:08:28.021024 [ 682 ] {} <Trace> system.query_log (e8fd04c9-4eac-43ac-800b-3ecfbd18c5b3): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:08:28.021913 [ 682 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.93 GiB.
2025.01.05 00:08:28.039472 [ 682 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_2_2_0 (state Temporary)
2025.01.05 00:08:28.053819 [ 682 ] {} <Trace> system.query_log (e8fd04c9-4eac-43ac-800b-3ecfbd18c5b3): Renaming temporary part tmp_insert_202501_2_2_0 to 202501_2_2_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:08:28.058616 [ 682 ] {} <Error> void DB::SystemLog<DB::QueryLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::QueryLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/e8f/e8fd04c9-4eac-43ac-800b-3ecfbd18c5b3/tmp_insert_202501_2_2_0/"] ["/var/lib/clickhouse/store/e8f/e8fd04c9-4eac-43ac-800b-3ecfbd18c5b3/202501_2_2_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::QueryLogElement>::savingThreadFunction() @ 0x000000001107432c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::QueryLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::QueryLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000ccd0f14
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:08:28.059032 [ 682 ] {} <Trace> SystemLog (system.query_log): Flushed system log up to offset 4
2025.01.05 00:08:28.462453 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushing system log, 4305 entries to flush up to offset 138499
2025.01.05 00:08:28.465699 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:08:28.467541 [ 687 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.93 GiB.
2025.01.05 00:08:28.486652 [ 687 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_32_32_0 (state Temporary)
2025.01.05 00:08:28.500867 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Renaming temporary part tmp_insert_202501_32_32_0 to 202501_32_32_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:08:28.505634 [ 687 ] {} <Error> void DB::SystemLog<DB::AsynchronousMetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::AsynchronousMetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/tmp_insert_202501_32_32_0/"] ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/202501_32_32_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::AsynchronousMetricLogElement>::savingThreadFunction() @ 0x000000001104f30c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000cccfe94
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:08:28.506210 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushed system log up to offset 138499
2025.01.05 00:08:30.979740 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushing system log, 8 entries to flush up to offset 229
2025.01.05 00:08:31.000674 [ 696 ] {} <Trace> AsynchronousMetrics: MemoryTracking: was 594.15 MiB, peak 598.20 MiB, free memory in arenas 94.77 MiB, will set to 588.72 MiB (RSS), difference: -5.43 MiB
2025.01.05 00:08:31.008442 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:08:31.009973 [ 694 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.93 GiB.
2025.01.05 00:08:31.036671 [ 694 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_30_30_0 (state Temporary)
2025.01.05 00:08:31.061820 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Renaming temporary part tmp_insert_202501_30_30_0 to 202501_30_30_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:08:31.069581 [ 694 ] {} <Error> void DB::SystemLog<DB::MetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::MetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/tmp_insert_202501_30_30_0/"] ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/202501_30_30_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::MetricLogElement>::savingThreadFunction() @ 0x000000001105dfec
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000ccd0554
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:08:31.070035 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushed system log up to offset 229
2025.01.05 00:08:32.001882 [ 696 ] {} <Trace> AsynchronousMetrics: MemoryTracking: was 584.65 MiB, peak 598.20 MiB, free memory in arenas 106.15 MiB, will set to 591.36 MiB (RSS), difference: 6.70 MiB
2025.01.05 00:08:35.506716 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushing system log, 4305 entries to flush up to offset 142804
2025.01.05 00:08:35.510105 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:08:35.511796 [ 687 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.93 GiB.
2025.01.05 00:08:35.528745 [ 687 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_33_33_0 (state Temporary)
2025.01.05 00:08:35.542820 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Renaming temporary part tmp_insert_202501_33_33_0 to 202501_33_33_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:08:35.548159 [ 687 ] {} <Error> void DB::SystemLog<DB::AsynchronousMetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::AsynchronousMetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/tmp_insert_202501_33_33_0/"] ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/202501_33_33_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::AsynchronousMetricLogElement>::savingThreadFunction() @ 0x000000001104f30c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000cccfe94
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:08:35.548895 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushed system log up to offset 142804
2025.01.05 00:08:35.817670 [ 688 ] {} <Trace> SystemLog (system.trace_log): Flushing system log, 2 entries to flush up to offset 37
2025.01.05 00:08:35.819002 [ 688 ] {} <Trace> system.trace_log (e1acc488-6507-4627-a115-261d46c24a4a): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:08:35.820710 [ 688 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.93 GiB.
2025.01.05 00:08:35.839613 [ 688 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_9_9_0 (state Temporary)
2025.01.05 00:08:35.853375 [ 688 ] {} <Trace> system.trace_log (e1acc488-6507-4627-a115-261d46c24a4a): Renaming temporary part tmp_insert_202501_9_9_0 to 202501_9_9_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:08:35.860122 [ 688 ] {} <Error> void DB::SystemLog<DB::TraceLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::TraceLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/e1a/e1acc488-6507-4627-a115-261d46c24a4a/tmp_insert_202501_9_9_0/"] ["/var/lib/clickhouse/store/e1a/e1acc488-6507-4627-a115-261d46c24a4a/202501_9_9_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::TraceLogElement>::savingThreadFunction() @ 0x0000000011091a8c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::TraceLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::TraceLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000ccd1c14
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:08:35.860437 [ 688 ] {} <Trace> SystemLog (system.trace_log): Flushed system log up to offset 37
2025.01.05 00:08:38.570763 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushing system log, 7 entries to flush up to offset 236
2025.01.05 00:08:38.589430 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:08:38.591304 [ 694 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.93 GiB.
2025.01.05 00:08:38.622835 [ 694 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_31_31_0 (state Temporary)
2025.01.05 00:08:38.648063 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Renaming temporary part tmp_insert_202501_31_31_0 to 202501_31_31_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:08:38.655542 [ 694 ] {} <Error> void DB::SystemLog<DB::MetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::MetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/tmp_insert_202501_31_31_0/"] ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/202501_31_31_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::MetricLogElement>::savingThreadFunction() @ 0x000000001105dfec
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000ccd0554
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:08:38.655977 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushed system log up to offset 236
2025.01.05 00:08:39.001404 [ 696 ] {} <Trace> AsynchronousMetrics: MemoryTracking: was 591.39 MiB, peak 604.33 MiB, free memory in arenas 97.64 MiB, will set to 588.86 MiB (RSS), difference: -2.54 MiB
2025.01.05 00:08:42.550191 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushing system log, 4305 entries to flush up to offset 147109
2025.01.05 00:08:42.555022 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:08:42.556847 [ 687 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.93 GiB.
2025.01.05 00:08:42.580249 [ 687 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_34_34_0 (state Temporary)
2025.01.05 00:08:42.592908 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Renaming temporary part tmp_insert_202501_34_34_0 to 202501_34_34_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:08:42.596567 [ 687 ] {} <Error> void DB::SystemLog<DB::AsynchronousMetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::AsynchronousMetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/tmp_insert_202501_34_34_0/"] ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/202501_34_34_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::AsynchronousMetricLogElement>::savingThreadFunction() @ 0x000000001104f30c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000cccfe94
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:08:42.596870 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushed system log up to offset 147109
2025.01.05 00:08:42.816845 [ 616 ] {} <Trace> CgroupsMemoryUsageObserver: Read current memory usage 297.18 MiB from cgroups
2025.01.05 00:08:42.906103 [ 243 ] {} <Debug> DNSResolver: Updating DNS cache
2025.01.05 00:08:42.906652 [ 243 ] {} <Debug> DNSResolver: Updated DNS cache
2025.01.05 00:08:43.361130 [ 688 ] {} <Trace> SystemLog (system.trace_log): Flushing system log, 4 entries to flush up to offset 41
2025.01.05 00:08:43.362841 [ 688 ] {} <Trace> system.trace_log (e1acc488-6507-4627-a115-261d46c24a4a): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:08:43.365831 [ 688 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.93 GiB.
2025.01.05 00:08:43.390721 [ 688 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_10_10_0 (state Temporary)
2025.01.05 00:08:43.402942 [ 688 ] {} <Trace> system.trace_log (e1acc488-6507-4627-a115-261d46c24a4a): Renaming temporary part tmp_insert_202501_10_10_0 to 202501_10_10_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:08:43.408647 [ 688 ] {} <Error> void DB::SystemLog<DB::TraceLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::TraceLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/e1a/e1acc488-6507-4627-a115-261d46c24a4a/tmp_insert_202501_10_10_0/"] ["/var/lib/clickhouse/store/e1a/e1acc488-6507-4627-a115-261d46c24a4a/202501_10_10_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::TraceLogElement>::savingThreadFunction() @ 0x0000000011091a8c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::TraceLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::TraceLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000ccd1c14
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:08:43.409141 [ 688 ] {} <Trace> SystemLog (system.trace_log): Flushed system log up to offset 41
2025.01.05 00:08:44.042725 [ 696 ] {} <Trace> AsynchronousMetrics: Update heavy metrics. Update period 1 sec. Update heavy metrics period 120 sec. Heavy metrics calculation elapsed: 0.0334562 sec.
2025.01.05 00:08:46.156587 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushing system log, 8 entries to flush up to offset 244
2025.01.05 00:08:46.177621 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:08:46.179897 [ 694 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.93 GiB.
2025.01.05 00:08:46.210143 [ 694 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_32_32_0 (state Temporary)
2025.01.05 00:08:46.234406 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Renaming temporary part tmp_insert_202501_32_32_0 to 202501_32_32_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:08:46.242417 [ 694 ] {} <Error> void DB::SystemLog<DB::MetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::MetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/tmp_insert_202501_32_32_0/"] ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/202501_32_32_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::MetricLogElement>::savingThreadFunction() @ 0x000000001105dfec
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000ccd0554
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:08:46.242860 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushed system log up to offset 244
2025.01.05 00:08:47.001414 [ 696 ] {} <Trace> AsynchronousMetrics: MemoryTracking: was 588.46 MiB, peak 604.33 MiB, free memory in arenas 97.50 MiB, will set to 586.43 MiB (RSS), difference: -2.03 MiB
2025.01.05 00:08:49.597124 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushing system log, 4305 entries to flush up to offset 151414
2025.01.05 00:08:49.599986 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:08:49.601304 [ 687 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.93 GiB.
2025.01.05 00:08:49.618846 [ 687 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_35_35_0 (state Temporary)
2025.01.05 00:08:49.633627 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Renaming temporary part tmp_insert_202501_35_35_0 to 202501_35_35_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:08:49.637906 [ 687 ] {} <Error> void DB::SystemLog<DB::AsynchronousMetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::AsynchronousMetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/tmp_insert_202501_35_35_0/"] ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/202501_35_35_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::AsynchronousMetricLogElement>::savingThreadFunction() @ 0x000000001104f30c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000cccfe94
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:08:49.638346 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushed system log up to offset 151414
2025.01.05 00:08:53.743732 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushing system log, 7 entries to flush up to offset 251
2025.01.05 00:08:53.762967 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:08:53.764945 [ 694 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.93 GiB.
2025.01.05 00:08:53.798931 [ 694 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_33_33_0 (state Temporary)
2025.01.05 00:08:53.824132 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Renaming temporary part tmp_insert_202501_33_33_0 to 202501_33_33_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:08:53.831998 [ 694 ] {} <Error> void DB::SystemLog<DB::MetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::MetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/tmp_insert_202501_33_33_0/"] ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/202501_33_33_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::MetricLogElement>::savingThreadFunction() @ 0x000000001105dfec
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000ccd0554
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:08:53.832589 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushed system log up to offset 251
2025.01.05 00:08:56.639057 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushing system log, 4305 entries to flush up to offset 155719
2025.01.05 00:08:56.642468 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:08:56.643195 [ 687 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.93 GiB.
2025.01.05 00:08:56.664596 [ 687 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_36_36_0 (state Temporary)
2025.01.05 00:08:56.677716 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Renaming temporary part tmp_insert_202501_36_36_0 to 202501_36_36_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:08:56.682346 [ 687 ] {} <Error> void DB::SystemLog<DB::AsynchronousMetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::AsynchronousMetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/tmp_insert_202501_36_36_0/"] ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/202501_36_36_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::AsynchronousMetricLogElement>::savingThreadFunction() @ 0x000000001104f30c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000cccfe94
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:08:56.682757 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushed system log up to offset 155719
2025.01.05 00:08:57.817731 [ 616 ] {} <Trace> CgroupsMemoryUsageObserver: Read current memory usage 294.75 MiB from cgroups
2025.01.05 00:08:57.907297 [ 249 ] {} <Debug> DNSResolver: Updating DNS cache
2025.01.05 00:08:57.907711 [ 249 ] {} <Debug> DNSResolver: Updated DNS cache
2025.01.05 00:09:01.332973 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushing system log, 8 entries to flush up to offset 259
2025.01.05 00:09:01.351942 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:09:01.353189 [ 694 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.93 GiB.
2025.01.05 00:09:01.375986 [ 694 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_34_34_0 (state Temporary)
2025.01.05 00:09:01.396562 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Renaming temporary part tmp_insert_202501_34_34_0 to 202501_34_34_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:09:01.404495 [ 694 ] {} <Error> void DB::SystemLog<DB::MetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::MetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/tmp_insert_202501_34_34_0/"] ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/202501_34_34_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::MetricLogElement>::savingThreadFunction() @ 0x000000001105dfec
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000ccd0554
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:09:01.404973 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushed system log up to offset 259
2025.01.05 00:09:03.683074 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushing system log, 4305 entries to flush up to offset 160024
2025.01.05 00:09:03.691314 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:09:03.695726 [ 687 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.93 GiB.
2025.01.05 00:09:03.722242 [ 687 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_37_37_0 (state Temporary)
2025.01.05 00:09:03.733806 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Renaming temporary part tmp_insert_202501_37_37_0 to 202501_37_37_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:09:03.737890 [ 687 ] {} <Error> void DB::SystemLog<DB::AsynchronousMetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::AsynchronousMetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/tmp_insert_202501_37_37_0/"] ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/202501_37_37_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::AsynchronousMetricLogElement>::savingThreadFunction() @ 0x000000001104f30c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000cccfe94
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:09:03.738223 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushed system log up to offset 160024
2025.01.05 00:09:04.000557 [ 696 ] {} <Trace> AsynchronousMetrics: MemoryTracking: was 586.08 MiB, peak 604.33 MiB, free memory in arenas 78.86 MiB, will set to 577.55 MiB (RSS), difference: -8.53 MiB
2025.01.05 00:09:08.905274 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushing system log, 8 entries to flush up to offset 267
2025.01.05 00:09:08.923891 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:09:08.925368 [ 694 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.93 GiB.
2025.01.05 00:09:08.956723 [ 694 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_35_35_0 (state Temporary)
2025.01.05 00:09:08.981953 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Renaming temporary part tmp_insert_202501_35_35_0 to 202501_35_35_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:09:08.989584 [ 694 ] {} <Error> void DB::SystemLog<DB::MetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::MetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/tmp_insert_202501_35_35_0/"] ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/202501_35_35_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::MetricLogElement>::savingThreadFunction() @ 0x000000001105dfec
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000ccd0554
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:09:08.990023 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushed system log up to offset 267
2025.01.05 00:09:10.738610 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushing system log, 4305 entries to flush up to offset 164329
2025.01.05 00:09:10.745635 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:09:10.747246 [ 687 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.93 GiB.
2025.01.05 00:09:10.769238 [ 687 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_38_38_0 (state Temporary)
2025.01.05 00:09:10.784614 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Renaming temporary part tmp_insert_202501_38_38_0 to 202501_38_38_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:09:10.788993 [ 687 ] {} <Error> void DB::SystemLog<DB::AsynchronousMetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::AsynchronousMetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/tmp_insert_202501_38_38_0/"] ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/202501_38_38_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::AsynchronousMetricLogElement>::savingThreadFunction() @ 0x000000001104f30c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000cccfe94
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:09:10.789933 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushed system log up to offset 164329
2025.01.05 00:09:11.000651 [ 696 ] {} <Trace> AsynchronousMetrics: MemoryTracking: was 578.72 MiB, peak 604.33 MiB, free memory in arenas 67.91 MiB, will set to 575.87 MiB (RSS), difference: -2.85 MiB
2025.01.05 00:09:12.818738 [ 616 ] {} <Trace> CgroupsMemoryUsageObserver: Read current memory usage 284.09 MiB from cgroups
2025.01.05 00:09:12.908630 [ 264 ] {} <Debug> DNSResolver: Updating DNS cache
2025.01.05 00:09:12.909323 [ 264 ] {} <Debug> DNSResolver: Updated DNS cache
2025.01.05 00:09:16.490349 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushing system log, 7 entries to flush up to offset 274
2025.01.05 00:09:16.513412 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:09:16.515516 [ 694 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.93 GiB.
2025.01.05 00:09:16.544188 [ 694 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_36_36_0 (state Temporary)
2025.01.05 00:09:16.567046 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Renaming temporary part tmp_insert_202501_36_36_0 to 202501_36_36_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:09:16.574700 [ 694 ] {} <Error> void DB::SystemLog<DB::MetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::MetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/tmp_insert_202501_36_36_0/"] ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/202501_36_36_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::MetricLogElement>::savingThreadFunction() @ 0x000000001105dfec
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000ccd0554
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:09:16.575337 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushed system log up to offset 274
2025.01.05 00:09:17.001590 [ 696 ] {} <Trace> AsynchronousMetrics: MemoryTracking: was 575.81 MiB, peak 604.33 MiB, free memory in arenas 67.91 MiB, will set to 574.45 MiB (RSS), difference: -1.37 MiB
2025.01.05 00:09:17.790572 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushing system log, 4305 entries to flush up to offset 168634
2025.01.05 00:09:17.793517 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:09:17.794896 [ 687 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.93 GiB.
2025.01.05 00:09:17.825722 [ 687 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_39_39_0 (state Temporary)
2025.01.05 00:09:17.837992 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Renaming temporary part tmp_insert_202501_39_39_0 to 202501_39_39_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:09:17.842201 [ 687 ] {} <Error> void DB::SystemLog<DB::AsynchronousMetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::AsynchronousMetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/tmp_insert_202501_39_39_0/"] ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/202501_39_39_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::AsynchronousMetricLogElement>::savingThreadFunction() @ 0x000000001104f30c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000cccfe94
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:09:17.842602 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushed system log up to offset 168634
2025.01.05 00:09:24.075885 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushing system log, 8 entries to flush up to offset 282
2025.01.05 00:09:24.096836 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:09:24.098559 [ 694 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.93 GiB.
2025.01.05 00:09:24.121998 [ 694 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_37_37_0 (state Temporary)
2025.01.05 00:09:24.145293 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Renaming temporary part tmp_insert_202501_37_37_0 to 202501_37_37_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:09:24.154690 [ 694 ] {} <Error> void DB::SystemLog<DB::MetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::MetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/tmp_insert_202501_37_37_0/"] ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/202501_37_37_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::MetricLogElement>::savingThreadFunction() @ 0x000000001105dfec
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000ccd0554
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:09:24.155415 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushed system log up to offset 282
2025.01.05 00:09:24.843293 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushing system log, 4305 entries to flush up to offset 172939
2025.01.05 00:09:24.846329 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:09:24.847912 [ 687 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.93 GiB.
2025.01.05 00:09:24.874194 [ 687 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_40_40_0 (state Temporary)
2025.01.05 00:09:24.888316 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Renaming temporary part tmp_insert_202501_40_40_0 to 202501_40_40_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:09:24.893910 [ 687 ] {} <Error> void DB::SystemLog<DB::AsynchronousMetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::AsynchronousMetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/tmp_insert_202501_40_40_0/"] ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/202501_40_40_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::AsynchronousMetricLogElement>::savingThreadFunction() @ 0x000000001104f30c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000cccfe94
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:09:24.894641 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushed system log up to offset 172939
2025.01.05 00:09:25.000836 [ 696 ] {} <Trace> AsynchronousMetrics: MemoryTracking: was 574.06 MiB, peak 604.33 MiB, free memory in arenas 76.41 MiB, will set to 576.54 MiB (RSS), difference: 2.48 MiB
2025.01.05 00:09:27.820694 [ 616 ] {} <Trace> CgroupsMemoryUsageObserver: Read current memory usage 284.91 MiB from cgroups
2025.01.05 00:09:27.911220 [ 265 ] {} <Debug> DNSResolver: Updating DNS cache
2025.01.05 00:09:27.913161 [ 265 ] {} <Debug> DNSResolver: Updated DNS cache
2025.01.05 00:09:31.656757 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushing system log, 7 entries to flush up to offset 289
2025.01.05 00:09:31.681254 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:09:31.683069 [ 694 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.93 GiB.
2025.01.05 00:09:31.714483 [ 694 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_38_38_0 (state Temporary)
2025.01.05 00:09:31.738745 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Renaming temporary part tmp_insert_202501_38_38_0 to 202501_38_38_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:09:31.746987 [ 694 ] {} <Error> void DB::SystemLog<DB::MetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::MetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/tmp_insert_202501_38_38_0/"] ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/202501_38_38_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::MetricLogElement>::savingThreadFunction() @ 0x000000001105dfec
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000ccd0554
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:09:31.747507 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushed system log up to offset 289
2025.01.05 00:09:31.895618 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushing system log, 4305 entries to flush up to offset 177244
2025.01.05 00:09:31.898661 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:09:31.900393 [ 687 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.93 GiB.
2025.01.05 00:09:31.917190 [ 687 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_41_41_0 (state Temporary)
2025.01.05 00:09:31.930116 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Renaming temporary part tmp_insert_202501_41_41_0 to 202501_41_41_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:09:31.933710 [ 687 ] {} <Error> void DB::SystemLog<DB::AsynchronousMetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::AsynchronousMetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/tmp_insert_202501_41_41_0/"] ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/202501_41_41_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::AsynchronousMetricLogElement>::savingThreadFunction() @ 0x000000001104f30c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000cccfe94
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:09:31.934245 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushed system log up to offset 177244
2025.01.05 00:09:32.001428 [ 696 ] {} <Trace> AsynchronousMetrics: MemoryTracking: was 576.47 MiB, peak 604.33 MiB, free memory in arenas 66.05 MiB, will set to 573.90 MiB (RSS), difference: -2.58 MiB
2025.01.05 00:09:38.934703 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushing system log, 4305 entries to flush up to offset 181549
2025.01.05 00:09:38.938047 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:09:38.939731 [ 687 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.93 GiB.
2025.01.05 00:09:38.962423 [ 687 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_42_42_0 (state Temporary)
2025.01.05 00:09:38.976643 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Renaming temporary part tmp_insert_202501_42_42_0 to 202501_42_42_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:09:38.980592 [ 687 ] {} <Error> void DB::SystemLog<DB::AsynchronousMetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::AsynchronousMetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/tmp_insert_202501_42_42_0/"] ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/202501_42_42_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::AsynchronousMetricLogElement>::savingThreadFunction() @ 0x000000001104f30c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000cccfe94
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:09:38.981039 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushed system log up to offset 181549
2025.01.05 00:09:39.000645 [ 696 ] {} <Trace> AsynchronousMetrics: MemoryTracking: was 573.89 MiB, peak 604.33 MiB, free memory in arenas 76.37 MiB, will set to 576.14 MiB (RSS), difference: 2.25 MiB
2025.01.05 00:09:39.248379 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushing system log, 8 entries to flush up to offset 297
2025.01.05 00:09:39.265856 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:09:39.267826 [ 694 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.93 GiB.
2025.01.05 00:09:39.297339 [ 694 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_39_39_0 (state Temporary)
2025.01.05 00:09:39.322722 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Renaming temporary part tmp_insert_202501_39_39_0 to 202501_39_39_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:09:39.330659 [ 694 ] {} <Error> void DB::SystemLog<DB::MetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::MetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/tmp_insert_202501_39_39_0/"] ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/202501_39_39_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::MetricLogElement>::savingThreadFunction() @ 0x000000001105dfec
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000ccd0554
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:09:39.331313 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushed system log up to offset 297
2025.01.05 00:09:42.822207 [ 616 ] {} <Trace> CgroupsMemoryUsageObserver: Read current memory usage 285.14 MiB from cgroups
2025.01.05 00:09:42.915253 [ 267 ] {} <Debug> DNSResolver: Updating DNS cache
2025.01.05 00:09:42.915907 [ 267 ] {} <Debug> DNSResolver: Updated DNS cache
2025.01.05 00:09:43.002736 [ 696 ] {} <Trace> AsynchronousMetrics: Scanning /sys/block
2025.01.05 00:09:45.981475 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushing system log, 4305 entries to flush up to offset 185854
2025.01.05 00:09:45.984979 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:09:45.986128 [ 687 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.93 GiB.
2025.01.05 00:09:46.000648 [ 696 ] {} <Trace> AsynchronousMetrics: MemoryTracking: was 576.67 MiB, peak 604.33 MiB, free memory in arenas 70.01 MiB, will set to 574.62 MiB (RSS), difference: -2.05 MiB
2025.01.05 00:09:46.003381 [ 687 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_43_43_0 (state Temporary)
2025.01.05 00:09:46.015903 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Renaming temporary part tmp_insert_202501_43_43_0 to 202501_43_43_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:09:46.020497 [ 687 ] {} <Error> void DB::SystemLog<DB::AsynchronousMetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::AsynchronousMetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/tmp_insert_202501_43_43_0/"] ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/202501_43_43_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::AsynchronousMetricLogElement>::savingThreadFunction() @ 0x000000001104f30c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000cccfe94
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:09:46.021059 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushed system log up to offset 185854
2025.01.05 00:09:46.831753 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushing system log, 7 entries to flush up to offset 304
2025.01.05 00:09:46.851634 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:09:46.853278 [ 694 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.93 GiB.
2025.01.05 00:09:46.888088 [ 694 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_40_40_0 (state Temporary)
2025.01.05 00:09:46.912650 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Renaming temporary part tmp_insert_202501_40_40_0 to 202501_40_40_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:09:46.921327 [ 694 ] {} <Error> void DB::SystemLog<DB::MetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::MetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/tmp_insert_202501_40_40_0/"] ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/202501_40_40_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::MetricLogElement>::savingThreadFunction() @ 0x000000001105dfec
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000ccd0554
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:09:46.921986 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushed system log up to offset 304
2025.01.05 00:09:47.000616 [ 696 ] {} <Trace> AsynchronousMetrics: MemoryTracking: was 574.54 MiB, peak 604.33 MiB, free memory in arenas 77.59 MiB, will set to 576.98 MiB (RSS), difference: 2.43 MiB
2025.01.05 00:09:53.021603 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushing system log, 4920 entries to flush up to offset 190774
2025.01.05 00:09:53.025115 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:09:53.026733 [ 687 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.93 GiB.
2025.01.05 00:09:53.044949 [ 687 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_44_44_0 (state Temporary)
2025.01.05 00:09:53.058043 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Renaming temporary part tmp_insert_202501_44_44_0 to 202501_44_44_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:09:53.062098 [ 687 ] {} <Error> void DB::SystemLog<DB::AsynchronousMetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::AsynchronousMetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/tmp_insert_202501_44_44_0/"] ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/202501_44_44_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::AsynchronousMetricLogElement>::savingThreadFunction() @ 0x000000001104f30c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000cccfe94
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:09:53.062708 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushed system log up to offset 190774
2025.01.05 00:09:54.422479 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushing system log, 8 entries to flush up to offset 312
2025.01.05 00:09:54.440229 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:09:54.441815 [ 694 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.93 GiB.
2025.01.05 00:09:54.467340 [ 694 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_41_41_0 (state Temporary)
2025.01.05 00:09:54.494605 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Renaming temporary part tmp_insert_202501_41_41_0 to 202501_41_41_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:09:54.503110 [ 694 ] {} <Error> void DB::SystemLog<DB::MetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::MetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/tmp_insert_202501_41_41_0/"] ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/202501_41_41_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::MetricLogElement>::savingThreadFunction() @ 0x000000001105dfec
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000ccd0554
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:09:54.503898 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushed system log up to offset 312
2025.01.05 00:09:57.823668 [ 616 ] {} <Trace> CgroupsMemoryUsageObserver: Read current memory usage 286.41 MiB from cgroups
2025.01.05 00:09:57.917560 [ 257 ] {} <Debug> DNSResolver: Updating DNS cache
2025.01.05 00:09:57.919568 [ 257 ] {} <Debug> DNSResolver: Updated DNS cache
2025.01.05 00:10:00.063857 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushing system log, 4305 entries to flush up to offset 195079
2025.01.05 00:10:00.067572 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:10:00.069447 [ 687 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.93 GiB.
2025.01.05 00:10:00.087878 [ 687 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_45_45_0 (state Temporary)
2025.01.05 00:10:00.101524 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Renaming temporary part tmp_insert_202501_45_45_0 to 202501_45_45_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:10:00.106409 [ 687 ] {} <Error> void DB::SystemLog<DB::AsynchronousMetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::AsynchronousMetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/tmp_insert_202501_45_45_0/"] ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/202501_45_45_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::AsynchronousMetricLogElement>::savingThreadFunction() @ 0x000000001104f30c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000cccfe94
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:10:00.106718 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushed system log up to offset 195079
2025.01.05 00:10:01.000835 [ 696 ] {} <Trace> AsynchronousMetrics: MemoryTracking: was 577.60 MiB, peak 604.33 MiB, free memory in arenas 66.11 MiB, will set to 574.58 MiB (RSS), difference: -3.02 MiB
2025.01.05 00:10:02.004570 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushing system log, 8 entries to flush up to offset 320
2025.01.05 00:10:02.023854 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:10:02.025552 [ 694 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.93 GiB.
2025.01.05 00:10:02.050026 [ 694 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_42_42_0 (state Temporary)
2025.01.05 00:10:02.074631 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Renaming temporary part tmp_insert_202501_42_42_0 to 202501_42_42_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:10:02.082077 [ 694 ] {} <Error> void DB::SystemLog<DB::MetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::MetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/tmp_insert_202501_42_42_0/"] ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/202501_42_42_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::MetricLogElement>::savingThreadFunction() @ 0x000000001105dfec
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000ccd0554
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:10:02.082459 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushed system log up to offset 320
2025.01.05 00:10:07.107051 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushing system log, 4305 entries to flush up to offset 199384
2025.01.05 00:10:07.110598 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:10:07.112144 [ 687 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.93 GiB.
2025.01.05 00:10:07.131817 [ 687 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_46_46_0 (state Temporary)
2025.01.05 00:10:07.143405 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Renaming temporary part tmp_insert_202501_46_46_0 to 202501_46_46_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:10:07.147206 [ 687 ] {} <Error> void DB::SystemLog<DB::AsynchronousMetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::AsynchronousMetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/tmp_insert_202501_46_46_0/"] ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/202501_46_46_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::AsynchronousMetricLogElement>::savingThreadFunction() @ 0x000000001104f30c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000cccfe94
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:10:07.147541 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushed system log up to offset 199384
2025.01.05 00:10:08.002275 [ 696 ] {} <Trace> AsynchronousMetrics: MemoryTracking: was 574.01 MiB, peak 604.33 MiB, free memory in arenas 76.30 MiB, will set to 576.08 MiB (RSS), difference: 2.07 MiB
2025.01.05 00:10:09.582738 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushing system log, 7 entries to flush up to offset 327
2025.01.05 00:10:09.603777 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:10:09.604970 [ 694 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.93 GiB.
2025.01.05 00:10:09.632900 [ 694 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_43_43_0 (state Temporary)
2025.01.05 00:10:09.660150 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Renaming temporary part tmp_insert_202501_43_43_0 to 202501_43_43_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:10:09.670658 [ 694 ] {} <Error> void DB::SystemLog<DB::MetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::MetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/tmp_insert_202501_43_43_0/"] ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/202501_43_43_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::MetricLogElement>::savingThreadFunction() @ 0x000000001105dfec
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000ccd0554
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:10:09.671086 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushed system log up to offset 327
2025.01.05 00:10:12.825066 [ 616 ] {} <Trace> CgroupsMemoryUsageObserver: Read current memory usage 285.37 MiB from cgroups
2025.01.05 00:10:12.921896 [ 270 ] {} <Debug> DNSResolver: Updating DNS cache
2025.01.05 00:10:12.923938 [ 270 ] {} <Debug> DNSResolver: Updated DNS cache
2025.01.05 00:10:14.147957 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushing system log, 4305 entries to flush up to offset 203689
2025.01.05 00:10:14.161749 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:10:14.166519 [ 687 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.93 GiB.
2025.01.05 00:10:14.192508 [ 687 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_47_47_0 (state Temporary)
2025.01.05 00:10:14.207509 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Renaming temporary part tmp_insert_202501_47_47_0 to 202501_47_47_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:10:14.212102 [ 687 ] {} <Error> void DB::SystemLog<DB::AsynchronousMetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::AsynchronousMetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/tmp_insert_202501_47_47_0/"] ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/202501_47_47_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::AsynchronousMetricLogElement>::savingThreadFunction() @ 0x000000001104f30c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000cccfe94
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:10:14.212909 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushed system log up to offset 203689
2025.01.05 00:10:17.171412 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushing system log, 8 entries to flush up to offset 335
2025.01.05 00:10:17.198149 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:10:17.199561 [ 694 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.93 GiB.
2025.01.05 00:10:17.232511 [ 694 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_44_44_0 (state Temporary)
2025.01.05 00:10:17.259072 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Renaming temporary part tmp_insert_202501_44_44_0 to 202501_44_44_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:10:17.269976 [ 694 ] {} <Error> void DB::SystemLog<DB::MetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::MetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/tmp_insert_202501_44_44_0/"] ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/202501_44_44_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::MetricLogElement>::savingThreadFunction() @ 0x000000001105dfec
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000ccd0554
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:10:17.270912 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushed system log up to offset 335
2025.01.05 00:10:21.213478 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushing system log, 4305 entries to flush up to offset 207994
2025.01.05 00:10:21.216562 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:10:21.217414 [ 687 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.93 GiB.
2025.01.05 00:10:21.235728 [ 687 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_48_48_0 (state Temporary)
2025.01.05 00:10:21.249936 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Renaming temporary part tmp_insert_202501_48_48_0 to 202501_48_48_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:10:21.254807 [ 687 ] {} <Error> void DB::SystemLog<DB::AsynchronousMetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::AsynchronousMetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/tmp_insert_202501_48_48_0/"] ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/202501_48_48_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::AsynchronousMetricLogElement>::savingThreadFunction() @ 0x000000001104f30c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000cccfe94
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:10:21.255384 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushed system log up to offset 207994
2025.01.05 00:10:22.000572 [ 696 ] {} <Trace> AsynchronousMetrics: MemoryTracking: was 576.28 MiB, peak 604.33 MiB, free memory in arenas 66.16 MiB, will set to 574.04 MiB (RSS), difference: -2.24 MiB
2025.01.05 00:10:24.771257 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushing system log, 7 entries to flush up to offset 342
2025.01.05 00:10:24.791043 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:10:24.793408 [ 694 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.93 GiB.
2025.01.05 00:10:24.825657 [ 694 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_45_45_0 (state Temporary)
2025.01.05 00:10:24.851800 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Renaming temporary part tmp_insert_202501_45_45_0 to 202501_45_45_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:10:24.860350 [ 694 ] {} <Error> void DB::SystemLog<DB::MetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::MetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/tmp_insert_202501_45_45_0/"] ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/202501_45_45_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::MetricLogElement>::savingThreadFunction() @ 0x000000001105dfec
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000ccd0554
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:10:24.860899 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushed system log up to offset 342
2025.01.05 00:10:25.000522 [ 696 ] {} <Trace> AsynchronousMetrics: MemoryTracking: was 573.98 MiB, peak 604.33 MiB, free memory in arenas 66.98 MiB, will set to 575.71 MiB (RSS), difference: 1.73 MiB
2025.01.05 00:10:27.826065 [ 616 ] {} <Trace> CgroupsMemoryUsageObserver: Read current memory usage 284.49 MiB from cgroups
2025.01.05 00:10:27.925818 [ 248 ] {} <Debug> DNSResolver: Updating DNS cache
2025.01.05 00:10:27.927427 [ 248 ] {} <Debug> DNSResolver: Updated DNS cache
2025.01.05 00:10:28.255966 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushing system log, 4305 entries to flush up to offset 212299
2025.01.05 00:10:28.264279 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:10:28.266164 [ 687 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.93 GiB.
2025.01.05 00:10:28.288895 [ 687 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_49_49_0 (state Temporary)
2025.01.05 00:10:28.301883 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Renaming temporary part tmp_insert_202501_49_49_0 to 202501_49_49_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:10:28.305766 [ 687 ] {} <Error> void DB::SystemLog<DB::AsynchronousMetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::AsynchronousMetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/tmp_insert_202501_49_49_0/"] ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/202501_49_49_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::AsynchronousMetricLogElement>::savingThreadFunction() @ 0x000000001104f30c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000cccfe94
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:10:28.306202 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushed system log up to offset 212299
2025.01.05 00:10:29.000862 [ 696 ] {} <Trace> AsynchronousMetrics: MemoryTracking: was 575.69 MiB, peak 604.33 MiB, free memory in arenas 77.15 MiB, will set to 577.71 MiB (RSS), difference: 2.01 MiB
2025.01.05 00:10:32.361295 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushing system log, 8 entries to flush up to offset 350
2025.01.05 00:10:32.382768 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:10:32.384057 [ 694 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.93 GiB.
2025.01.05 00:10:32.413048 [ 694 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_46_46_0 (state Temporary)
2025.01.05 00:10:32.436042 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Renaming temporary part tmp_insert_202501_46_46_0 to 202501_46_46_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:10:32.445116 [ 694 ] {} <Error> void DB::SystemLog<DB::MetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::MetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/tmp_insert_202501_46_46_0/"] ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/202501_46_46_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::MetricLogElement>::savingThreadFunction() @ 0x000000001105dfec
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000ccd0554
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:10:32.445732 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushed system log up to offset 350
2025.01.05 00:10:33.000651 [ 696 ] {} <Trace> AsynchronousMetrics: MemoryTracking: was 577.66 MiB, peak 604.33 MiB, free memory in arenas 76.32 MiB, will set to 574.53 MiB (RSS), difference: -3.13 MiB
2025.01.05 00:10:35.307304 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushing system log, 4305 entries to flush up to offset 216604
2025.01.05 00:10:35.315672 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:10:35.317718 [ 687 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.93 GiB.
2025.01.05 00:10:35.334969 [ 687 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_50_50_0 (state Temporary)
2025.01.05 00:10:35.346536 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Renaming temporary part tmp_insert_202501_50_50_0 to 202501_50_50_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:10:35.350082 [ 687 ] {} <Error> void DB::SystemLog<DB::AsynchronousMetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::AsynchronousMetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/tmp_insert_202501_50_50_0/"] ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/202501_50_50_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::AsynchronousMetricLogElement>::savingThreadFunction() @ 0x000000001104f30c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000cccfe94
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:10:35.350384 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushed system log up to offset 216604
2025.01.05 00:10:39.946329 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushing system log, 8 entries to flush up to offset 358
2025.01.05 00:10:39.965380 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:10:39.967292 [ 694 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.93 GiB.
2025.01.05 00:10:39.993521 [ 694 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_47_47_0 (state Temporary)
2025.01.05 00:10:40.000811 [ 696 ] {} <Trace> AsynchronousMetrics: MemoryTracking: was 588.13 MiB, peak 604.33 MiB, free memory in arenas 59.60 MiB, will set to 573.49 MiB (RSS), difference: -14.64 MiB
2025.01.05 00:10:40.016705 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Renaming temporary part tmp_insert_202501_47_47_0 to 202501_47_47_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:10:40.023794 [ 694 ] {} <Error> void DB::SystemLog<DB::MetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::MetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/tmp_insert_202501_47_47_0/"] ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/202501_47_47_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::MetricLogElement>::savingThreadFunction() @ 0x000000001105dfec
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000ccd0554
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:10:40.024289 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushed system log up to offset 358
2025.01.05 00:10:41.000595 [ 696 ] {} <Trace> AsynchronousMetrics: MemoryTracking: was 560.55 MiB, peak 604.33 MiB, free memory in arenas 77.61 MiB, will set to 574.97 MiB (RSS), difference: 14.42 MiB
2025.01.05 00:10:42.350611 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushing system log, 4305 entries to flush up to offset 220909
2025.01.05 00:10:42.354581 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:10:42.355403 [ 687 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.93 GiB.
2025.01.05 00:10:42.372060 [ 687 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_51_51_0 (state Temporary)
2025.01.05 00:10:42.383941 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Renaming temporary part tmp_insert_202501_51_51_0 to 202501_51_51_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:10:42.387790 [ 687 ] {} <Error> void DB::SystemLog<DB::AsynchronousMetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::AsynchronousMetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/tmp_insert_202501_51_51_0/"] ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/202501_51_51_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::AsynchronousMetricLogElement>::savingThreadFunction() @ 0x000000001104f30c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000cccfe94
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:10:42.388188 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushed system log up to offset 220909
2025.01.05 00:10:42.828210 [ 616 ] {} <Trace> CgroupsMemoryUsageObserver: Read current memory usage 283.94 MiB from cgroups
2025.01.05 00:10:42.928677 [ 259 ] {} <Debug> DNSResolver: Updating DNS cache
2025.01.05 00:10:42.929653 [ 259 ] {} <Debug> DNSResolver: Updated DNS cache
2025.01.05 00:10:44.051644 [ 696 ] {} <Trace> AsynchronousMetrics: Update heavy metrics. Update period 1 sec. Update heavy metrics period 120 sec. Heavy metrics calculation elapsed: 0.0460651 sec.
2025.01.05 00:10:47.524659 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushing system log, 7 entries to flush up to offset 365
2025.01.05 00:10:47.545302 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:10:47.546612 [ 694 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.93 GiB.
2025.01.05 00:10:47.576290 [ 694 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_48_48_0 (state Temporary)
2025.01.05 00:10:47.601742 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Renaming temporary part tmp_insert_202501_48_48_0 to 202501_48_48_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:10:47.610635 [ 694 ] {} <Error> void DB::SystemLog<DB::MetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::MetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/tmp_insert_202501_48_48_0/"] ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/202501_48_48_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::MetricLogElement>::savingThreadFunction() @ 0x000000001105dfec
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000ccd0554
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:10:47.611407 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushed system log up to offset 365
2025.01.05 00:10:49.388576 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushing system log, 4305 entries to flush up to offset 225214
2025.01.05 00:10:49.397098 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:10:49.399127 [ 687 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.93 GiB.
2025.01.05 00:10:49.423581 [ 687 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_52_52_0 (state Temporary)
2025.01.05 00:10:49.437749 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Renaming temporary part tmp_insert_202501_52_52_0 to 202501_52_52_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:10:49.442024 [ 687 ] {} <Error> void DB::SystemLog<DB::AsynchronousMetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::AsynchronousMetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/tmp_insert_202501_52_52_0/"] ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/202501_52_52_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::AsynchronousMetricLogElement>::savingThreadFunction() @ 0x000000001104f30c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000cccfe94
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:10:49.442673 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushed system log up to offset 225214
2025.01.05 00:10:50.002129 [ 696 ] {} <Trace> AsynchronousMetrics: MemoryTracking: was 575.29 MiB, peak 604.33 MiB, free memory in arenas 72.96 MiB, will set to 573.08 MiB (RSS), difference: -2.21 MiB
2025.01.05 00:10:55.112471 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushing system log, 8 entries to flush up to offset 373
2025.01.05 00:10:55.141348 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:10:55.143338 [ 694 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.93 GiB.
2025.01.05 00:10:55.173103 [ 694 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_49_49_0 (state Temporary)
2025.01.05 00:10:55.199330 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Renaming temporary part tmp_insert_202501_49_49_0 to 202501_49_49_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:10:55.206844 [ 694 ] {} <Error> void DB::SystemLog<DB::MetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::MetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/tmp_insert_202501_49_49_0/"] ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/202501_49_49_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::MetricLogElement>::savingThreadFunction() @ 0x000000001105dfec
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000ccd0554
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:10:55.207310 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushed system log up to offset 373
2025.01.05 00:10:56.443183 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushing system log, 4305 entries to flush up to offset 229519
2025.01.05 00:10:56.446249 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:10:56.447703 [ 687 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.93 GiB.
2025.01.05 00:10:56.469799 [ 687 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_53_53_0 (state Temporary)
2025.01.05 00:10:56.480749 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Renaming temporary part tmp_insert_202501_53_53_0 to 202501_53_53_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:10:56.484396 [ 687 ] {} <Error> void DB::SystemLog<DB::AsynchronousMetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::AsynchronousMetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/tmp_insert_202501_53_53_0/"] ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/202501_53_53_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::AsynchronousMetricLogElement>::savingThreadFunction() @ 0x000000001104f30c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000cccfe94
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:10:56.484687 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushed system log up to offset 229519
2025.01.05 00:10:57.829318 [ 616 ] {} <Trace> CgroupsMemoryUsageObserver: Read current memory usage 281.36 MiB from cgroups
2025.01.05 00:10:57.931263 [ 247 ] {} <Debug> DNSResolver: Updating DNS cache
2025.01.05 00:10:57.932992 [ 247 ] {} <Debug> DNSResolver: Updated DNS cache
2025.01.05 00:11:02.707607 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushing system log, 7 entries to flush up to offset 380
2025.01.05 00:11:02.727798 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:11:02.729501 [ 694 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.93 GiB.
2025.01.05 00:11:02.757319 [ 694 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_50_50_0 (state Temporary)
2025.01.05 00:11:02.783209 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Renaming temporary part tmp_insert_202501_50_50_0 to 202501_50_50_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:11:02.792337 [ 694 ] {} <Error> void DB::SystemLog<DB::MetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::MetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/tmp_insert_202501_50_50_0/"] ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/202501_50_50_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::MetricLogElement>::savingThreadFunction() @ 0x000000001105dfec
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000ccd0554
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:11:02.793407 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushed system log up to offset 380
2025.01.05 00:11:03.485326 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushing system log, 4305 entries to flush up to offset 233824
2025.01.05 00:11:03.488653 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:11:03.490704 [ 687 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.93 GiB.
2025.01.05 00:11:03.508050 [ 687 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_54_54_0 (state Temporary)
2025.01.05 00:11:03.519484 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Renaming temporary part tmp_insert_202501_54_54_0 to 202501_54_54_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:11:03.523222 [ 687 ] {} <Error> void DB::SystemLog<DB::AsynchronousMetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::AsynchronousMetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/tmp_insert_202501_54_54_0/"] ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/202501_54_54_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::AsynchronousMetricLogElement>::savingThreadFunction() @ 0x000000001104f30c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000cccfe94
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:11:03.523633 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushed system log up to offset 233824
2025.01.05 00:11:04.000596 [ 696 ] {} <Trace> AsynchronousMetrics: MemoryTracking: was 572.42 MiB, peak 604.33 MiB, free memory in arenas 77.08 MiB, will set to 574.89 MiB (RSS), difference: 2.46 MiB
2025.01.05 00:11:10.293805 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushing system log, 8 entries to flush up to offset 388
2025.01.05 00:11:10.314153 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:11:10.314888 [ 694 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.93 GiB.
2025.01.05 00:11:10.335595 [ 694 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_51_51_0 (state Temporary)
2025.01.05 00:11:10.360904 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Renaming temporary part tmp_insert_202501_51_51_0 to 202501_51_51_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:11:10.368432 [ 694 ] {} <Error> void DB::SystemLog<DB::MetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::MetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/tmp_insert_202501_51_51_0/"] ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/202501_51_51_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::MetricLogElement>::savingThreadFunction() @ 0x000000001105dfec
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000ccd0554
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:11:10.368878 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushed system log up to offset 388
2025.01.05 00:11:10.524070 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushing system log, 4305 entries to flush up to offset 238129
2025.01.05 00:11:10.526869 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:11:10.527509 [ 687 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.93 GiB.
2025.01.05 00:11:10.542053 [ 687 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_55_55_0 (state Temporary)
2025.01.05 00:11:10.554565 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Renaming temporary part tmp_insert_202501_55_55_0 to 202501_55_55_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:11:10.558602 [ 687 ] {} <Error> void DB::SystemLog<DB::AsynchronousMetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::AsynchronousMetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/tmp_insert_202501_55_55_0/"] ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/202501_55_55_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::AsynchronousMetricLogElement>::savingThreadFunction() @ 0x000000001104f30c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000cccfe94
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:11:10.559400 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushed system log up to offset 238129
2025.01.05 00:11:12.831107 [ 616 ] {} <Trace> CgroupsMemoryUsageObserver: Read current memory usage 284.37 MiB from cgroups
2025.01.05 00:11:12.935059 [ 279 ] {} <Debug> DNSResolver: Updating DNS cache
2025.01.05 00:11:12.935758 [ 279 ] {} <Debug> DNSResolver: Updated DNS cache
2025.01.05 00:11:17.560350 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushing system log, 4305 entries to flush up to offset 242434
2025.01.05 00:11:17.569207 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:11:17.575239 [ 687 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.93 GiB.
2025.01.05 00:11:17.592002 [ 687 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_56_56_0 (state Temporary)
2025.01.05 00:11:17.605128 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Renaming temporary part tmp_insert_202501_56_56_0 to 202501_56_56_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:11:17.609315 [ 687 ] {} <Error> void DB::SystemLog<DB::AsynchronousMetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::AsynchronousMetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/tmp_insert_202501_56_56_0/"] ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/202501_56_56_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::AsynchronousMetricLogElement>::savingThreadFunction() @ 0x000000001104f30c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000cccfe94
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:11:17.609645 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushed system log up to offset 242434
2025.01.05 00:11:17.869181 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushing system log, 7 entries to flush up to offset 395
2025.01.05 00:11:17.890869 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:11:17.891615 [ 694 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.93 GiB.
2025.01.05 00:11:17.919215 [ 694 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_52_52_0 (state Temporary)
2025.01.05 00:11:17.950362 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Renaming temporary part tmp_insert_202501_52_52_0 to 202501_52_52_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:11:17.958174 [ 694 ] {} <Error> void DB::SystemLog<DB::MetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::MetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/tmp_insert_202501_52_52_0/"] ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/202501_52_52_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::MetricLogElement>::savingThreadFunction() @ 0x000000001105dfec
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000ccd0554
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:11:17.958809 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushed system log up to offset 395
2025.01.05 00:11:24.610328 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushing system log, 4305 entries to flush up to offset 246739
2025.01.05 00:11:24.623718 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:11:24.625387 [ 687 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.92 GiB.
2025.01.05 00:11:24.647588 [ 687 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_57_57_0 (state Temporary)
2025.01.05 00:11:24.660443 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Renaming temporary part tmp_insert_202501_57_57_0 to 202501_57_57_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:11:24.664126 [ 687 ] {} <Error> void DB::SystemLog<DB::AsynchronousMetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::AsynchronousMetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/tmp_insert_202501_57_57_0/"] ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/202501_57_57_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::AsynchronousMetricLogElement>::savingThreadFunction() @ 0x000000001104f30c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000cccfe94
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:11:24.664450 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushed system log up to offset 246739
2025.01.05 00:11:25.459264 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushing system log, 8 entries to flush up to offset 403
2025.01.05 00:11:25.477332 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:11:25.479274 [ 694 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.92 GiB.
2025.01.05 00:11:25.511610 [ 694 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_53_53_0 (state Temporary)
2025.01.05 00:11:25.535099 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Renaming temporary part tmp_insert_202501_53_53_0 to 202501_53_53_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:11:25.542867 [ 694 ] {} <Error> void DB::SystemLog<DB::MetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::MetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/tmp_insert_202501_53_53_0/"] ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/202501_53_53_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::MetricLogElement>::savingThreadFunction() @ 0x000000001105dfec
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000ccd0554
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:11:25.543287 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushed system log up to offset 403
2025.01.05 00:11:27.833286 [ 616 ] {} <Trace> CgroupsMemoryUsageObserver: Read current memory usage 284.20 MiB from cgroups
2025.01.05 00:11:27.936854 [ 280 ] {} <Debug> DNSResolver: Updating DNS cache
2025.01.05 00:11:27.938369 [ 280 ] {} <Debug> DNSResolver: Updated DNS cache
2025.01.05 00:11:31.665587 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushing system log, 4305 entries to flush up to offset 251044
2025.01.05 00:11:31.674209 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:11:31.676085 [ 687 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.92 GiB.
2025.01.05 00:11:31.694560 [ 687 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_58_58_0 (state Temporary)
2025.01.05 00:11:31.707008 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Renaming temporary part tmp_insert_202501_58_58_0 to 202501_58_58_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:11:31.711005 [ 687 ] {} <Error> void DB::SystemLog<DB::AsynchronousMetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::AsynchronousMetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/tmp_insert_202501_58_58_0/"] ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/202501_58_58_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::AsynchronousMetricLogElement>::savingThreadFunction() @ 0x000000001104f30c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000cccfe94
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:11:31.711303 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushed system log up to offset 251044
2025.01.05 00:11:32.002319 [ 696 ] {} <Trace> AsynchronousMetrics: MemoryTracking: was 574.98 MiB, peak 604.33 MiB, free memory in arenas 65.91 MiB, will set to 572.42 MiB (RSS), difference: -2.56 MiB
2025.01.05 00:11:33.043843 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushing system log, 8 entries to flush up to offset 411
2025.01.05 00:11:33.062730 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:11:33.064389 [ 694 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.92 GiB.
2025.01.05 00:11:33.095193 [ 694 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_54_54_0 (state Temporary)
2025.01.05 00:11:33.119117 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Renaming temporary part tmp_insert_202501_54_54_0 to 202501_54_54_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:11:33.128266 [ 694 ] {} <Error> void DB::SystemLog<DB::MetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::MetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/tmp_insert_202501_54_54_0/"] ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/202501_54_54_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::MetricLogElement>::savingThreadFunction() @ 0x000000001105dfec
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000ccd0554
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:11:33.128908 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushed system log up to offset 411
2025.01.05 00:11:38.712303 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushing system log, 4305 entries to flush up to offset 255349
2025.01.05 00:11:38.719872 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:11:38.721731 [ 687 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.92 GiB.
2025.01.05 00:11:38.744480 [ 687 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_59_59_0 (state Temporary)
2025.01.05 00:11:38.757602 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Renaming temporary part tmp_insert_202501_59_59_0 to 202501_59_59_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:11:38.761597 [ 687 ] {} <Error> void DB::SystemLog<DB::AsynchronousMetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::AsynchronousMetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/tmp_insert_202501_59_59_0/"] ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/202501_59_59_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::AsynchronousMetricLogElement>::savingThreadFunction() @ 0x000000001104f30c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000cccfe94
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:11:38.761905 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushed system log up to offset 255349
2025.01.05 00:11:40.629431 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushing system log, 7 entries to flush up to offset 418
2025.01.05 00:11:40.649402 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:11:40.650890 [ 694 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.92 GiB.
2025.01.05 00:11:40.682001 [ 694 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_55_55_0 (state Temporary)
2025.01.05 00:11:40.705206 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Renaming temporary part tmp_insert_202501_55_55_0 to 202501_55_55_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:11:40.711729 [ 694 ] {} <Error> void DB::SystemLog<DB::MetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::MetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/tmp_insert_202501_55_55_0/"] ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/202501_55_55_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::MetricLogElement>::savingThreadFunction() @ 0x000000001105dfec
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000ccd0554
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:11:40.712447 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushed system log up to offset 418
2025.01.05 00:11:42.834168 [ 616 ] {} <Trace> CgroupsMemoryUsageObserver: Read current memory usage 281.93 MiB from cgroups
2025.01.05 00:11:42.939506 [ 278 ] {} <Debug> DNSResolver: Updating DNS cache
2025.01.05 00:11:42.940060 [ 278 ] {} <Debug> DNSResolver: Updated DNS cache
2025.01.05 00:11:45.762308 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushing system log, 4305 entries to flush up to offset 259654
2025.01.05 00:11:45.765597 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:11:45.767160 [ 687 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.92 GiB.
2025.01.05 00:11:45.784422 [ 687 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_60_60_0 (state Temporary)
2025.01.05 00:11:45.795789 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Renaming temporary part tmp_insert_202501_60_60_0 to 202501_60_60_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:11:45.799172 [ 687 ] {} <Error> void DB::SystemLog<DB::AsynchronousMetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::AsynchronousMetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/tmp_insert_202501_60_60_0/"] ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/202501_60_60_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::AsynchronousMetricLogElement>::savingThreadFunction() @ 0x000000001104f30c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000cccfe94
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:11:45.799473 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushed system log up to offset 259654
2025.01.05 00:11:46.001403 [ 696 ] {} <Trace> AsynchronousMetrics: MemoryTracking: was 572.84 MiB, peak 604.33 MiB, free memory in arenas 77.07 MiB, will set to 575.62 MiB (RSS), difference: 2.78 MiB
2025.01.05 00:11:48.213294 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushing system log, 8 entries to flush up to offset 426
2025.01.05 00:11:48.231946 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:11:48.233829 [ 694 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.92 GiB.
2025.01.05 00:11:48.259793 [ 694 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_56_56_0 (state Temporary)
2025.01.05 00:11:48.283786 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Renaming temporary part tmp_insert_202501_56_56_0 to 202501_56_56_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:11:48.291357 [ 694 ] {} <Error> void DB::SystemLog<DB::MetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::MetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/tmp_insert_202501_56_56_0/"] ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/202501_56_56_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::MetricLogElement>::savingThreadFunction() @ 0x000000001105dfec
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000ccd0554
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:11:48.291770 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushed system log up to offset 426
2025.01.05 00:11:52.799811 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushing system log, 4305 entries to flush up to offset 263959
2025.01.05 00:11:52.808025 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:11:52.809838 [ 687 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.92 GiB.
2025.01.05 00:11:52.830350 [ 687 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_61_61_0 (state Temporary)
2025.01.05 00:11:52.842854 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Renaming temporary part tmp_insert_202501_61_61_0 to 202501_61_61_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:11:52.847966 [ 687 ] {} <Error> void DB::SystemLog<DB::AsynchronousMetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::AsynchronousMetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/tmp_insert_202501_61_61_0/"] ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/202501_61_61_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::AsynchronousMetricLogElement>::savingThreadFunction() @ 0x000000001104f30c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000cccfe94
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:11:52.848453 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushed system log up to offset 263959
2025.01.05 00:11:55.794485 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushing system log, 7 entries to flush up to offset 433
2025.01.05 00:11:55.824102 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:11:55.825854 [ 694 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.92 GiB.
2025.01.05 00:11:55.854178 [ 694 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_57_57_0 (state Temporary)
2025.01.05 00:11:55.877921 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Renaming temporary part tmp_insert_202501_57_57_0 to 202501_57_57_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:11:55.885537 [ 694 ] {} <Error> void DB::SystemLog<DB::MetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::MetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/tmp_insert_202501_57_57_0/"] ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/202501_57_57_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::MetricLogElement>::savingThreadFunction() @ 0x000000001105dfec
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000ccd0554
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:11:55.885957 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushed system log up to offset 433
2025.01.05 00:11:57.837422 [ 616 ] {} <Trace> CgroupsMemoryUsageObserver: Read current memory usage 284.76 MiB from cgroups
2025.01.05 00:11:57.941494 [ 321 ] {} <Debug> DNSResolver: Updating DNS cache
2025.01.05 00:11:57.943322 [ 321 ] {} <Debug> DNSResolver: Updated DNS cache
2025.01.05 00:11:59.850581 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushing system log, 4305 entries to flush up to offset 268264
2025.01.05 00:11:59.853455 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:11:59.854729 [ 687 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.92 GiB.
2025.01.05 00:11:59.871548 [ 687 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_62_62_0 (state Temporary)
2025.01.05 00:11:59.885527 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Renaming temporary part tmp_insert_202501_62_62_0 to 202501_62_62_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:11:59.889341 [ 687 ] {} <Error> void DB::SystemLog<DB::AsynchronousMetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::AsynchronousMetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/tmp_insert_202501_62_62_0/"] ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/202501_62_62_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::AsynchronousMetricLogElement>::savingThreadFunction() @ 0x000000001104f30c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000cccfe94
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:11:59.889647 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushed system log up to offset 268264
2025.01.05 00:12:03.387031 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushing system log, 8 entries to flush up to offset 441
2025.01.05 00:12:03.411074 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:12:03.413034 [ 694 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.92 GiB.
2025.01.05 00:12:03.443390 [ 694 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_58_58_0 (state Temporary)
2025.01.05 00:12:03.471142 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Renaming temporary part tmp_insert_202501_58_58_0 to 202501_58_58_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:12:03.479140 [ 694 ] {} <Error> void DB::SystemLog<DB::MetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::MetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/tmp_insert_202501_58_58_0/"] ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/202501_58_58_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::MetricLogElement>::savingThreadFunction() @ 0x000000001105dfec
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000ccd0554
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:12:03.479839 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushed system log up to offset 441
2025.01.05 00:12:06.890354 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushing system log, 4305 entries to flush up to offset 272569
2025.01.05 00:12:06.899142 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:12:06.900674 [ 687 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.92 GiB.
2025.01.05 00:12:06.927207 [ 687 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_63_63_0 (state Temporary)
2025.01.05 00:12:06.939604 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Renaming temporary part tmp_insert_202501_63_63_0 to 202501_63_63_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:12:06.943947 [ 687 ] {} <Error> void DB::SystemLog<DB::AsynchronousMetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::AsynchronousMetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/tmp_insert_202501_63_63_0/"] ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/202501_63_63_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::AsynchronousMetricLogElement>::savingThreadFunction() @ 0x000000001104f30c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000cccfe94
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:12:06.944487 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushed system log up to offset 272569
2025.01.05 00:12:10.980998 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushing system log, 8 entries to flush up to offset 449
2025.01.05 00:12:11.000594 [ 696 ] {} <Trace> AsynchronousMetrics: MemoryTracking: was 578.91 MiB, peak 604.33 MiB, free memory in arenas 60.11 MiB, will set to 569.74 MiB (RSS), difference: -9.17 MiB
2025.01.05 00:12:11.000882 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:12:11.002723 [ 694 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.92 GiB.
2025.01.05 00:12:11.033118 [ 694 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_59_59_0 (state Temporary)
2025.01.05 00:12:11.055854 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Renaming temporary part tmp_insert_202501_59_59_0 to 202501_59_59_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:12:11.062349 [ 694 ] {} <Error> void DB::SystemLog<DB::MetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::MetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/tmp_insert_202501_59_59_0/"] ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/202501_59_59_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::MetricLogElement>::savingThreadFunction() @ 0x000000001105dfec
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000ccd0554
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:12:11.062757 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushed system log up to offset 449
2025.01.05 00:12:12.000717 [ 696 ] {} <Trace> AsynchronousMetrics: MemoryTracking: was 565.68 MiB, peak 604.33 MiB, free memory in arenas 76.92 MiB, will set to 574.55 MiB (RSS), difference: 8.88 MiB
2025.01.05 00:12:12.839542 [ 616 ] {} <Trace> CgroupsMemoryUsageObserver: Read current memory usage 283.98 MiB from cgroups
2025.01.05 00:12:12.944952 [ 315 ] {} <Debug> DNSResolver: Updating DNS cache
2025.01.05 00:12:12.946451 [ 315 ] {} <Debug> DNSResolver: Updated DNS cache
2025.01.05 00:12:13.945419 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushing system log, 4305 entries to flush up to offset 276874
2025.01.05 00:12:13.953467 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:12:13.955147 [ 687 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.93 GiB.
2025.01.05 00:12:13.975249 [ 687 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_64_64_0 (state Temporary)
2025.01.05 00:12:13.989538 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Renaming temporary part tmp_insert_202501_64_64_0 to 202501_64_64_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:12:13.994283 [ 687 ] {} <Error> void DB::SystemLog<DB::AsynchronousMetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::AsynchronousMetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/tmp_insert_202501_64_64_0/"] ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/202501_64_64_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::AsynchronousMetricLogElement>::savingThreadFunction() @ 0x000000001104f30c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000cccfe94
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:12:13.994878 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushed system log up to offset 276874
2025.01.05 00:12:18.563003 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushing system log, 7 entries to flush up to offset 456
2025.01.05 00:12:18.582724 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:12:18.584275 [ 694 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.93 GiB.
2025.01.05 00:12:18.613249 [ 694 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_60_60_0 (state Temporary)
2025.01.05 00:12:18.634816 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Renaming temporary part tmp_insert_202501_60_60_0 to 202501_60_60_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:12:18.643484 [ 694 ] {} <Error> void DB::SystemLog<DB::MetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::MetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/tmp_insert_202501_60_60_0/"] ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/202501_60_60_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::MetricLogElement>::savingThreadFunction() @ 0x000000001105dfec
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000ccd0554
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:12:18.643949 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushed system log up to offset 456
2025.01.05 00:12:20.995296 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushing system log, 4305 entries to flush up to offset 281179
2025.01.05 00:12:20.999866 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:12:21.002053 [ 687 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.93 GiB.
2025.01.05 00:12:21.024640 [ 687 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_65_65_0 (state Temporary)
2025.01.05 00:12:21.037275 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Renaming temporary part tmp_insert_202501_65_65_0 to 202501_65_65_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:12:21.042251 [ 687 ] {} <Error> void DB::SystemLog<DB::AsynchronousMetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::AsynchronousMetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/tmp_insert_202501_65_65_0/"] ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/202501_65_65_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::AsynchronousMetricLogElement>::savingThreadFunction() @ 0x000000001104f30c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000cccfe94
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:12:21.042760 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushed system log up to offset 281179
2025.01.05 00:12:22.002372 [ 696 ] {} <Trace> AsynchronousMetrics: MemoryTracking: was 575.16 MiB, peak 604.33 MiB, free memory in arenas 75.88 MiB, will set to 573.75 MiB (RSS), difference: -1.42 MiB
2025.01.05 00:12:26.144680 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushing system log, 8 entries to flush up to offset 464
2025.01.05 00:12:26.179126 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:12:26.180730 [ 694 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.92 GiB.
2025.01.05 00:12:26.209817 [ 694 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_61_61_0 (state Temporary)
2025.01.05 00:12:26.233838 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Renaming temporary part tmp_insert_202501_61_61_0 to 202501_61_61_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:12:26.240941 [ 694 ] {} <Error> void DB::SystemLog<DB::MetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::MetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/tmp_insert_202501_61_61_0/"] ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/202501_61_61_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::MetricLogElement>::savingThreadFunction() @ 0x000000001105dfec
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000ccd0554
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:12:26.241391 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushed system log up to offset 464
2025.01.05 00:12:27.840756 [ 616 ] {} <Trace> CgroupsMemoryUsageObserver: Read current memory usage 283.29 MiB from cgroups
2025.01.05 00:12:27.948147 [ 297 ] {} <Debug> DNSResolver: Updating DNS cache
2025.01.05 00:12:27.949763 [ 297 ] {} <Debug> DNSResolver: Updated DNS cache
2025.01.05 00:12:28.043509 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushing system log, 4920 entries to flush up to offset 286099
2025.01.05 00:12:28.047291 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:12:28.048992 [ 687 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.92 GiB.
2025.01.05 00:12:28.073069 [ 687 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_66_66_0 (state Temporary)
2025.01.05 00:12:28.087331 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Renaming temporary part tmp_insert_202501_66_66_0 to 202501_66_66_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:12:28.091897 [ 687 ] {} <Error> void DB::SystemLog<DB::AsynchronousMetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::AsynchronousMetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/tmp_insert_202501_66_66_0/"] ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/202501_66_66_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::AsynchronousMetricLogElement>::savingThreadFunction() @ 0x000000001104f30c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000cccfe94
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:12:28.092784 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushed system log up to offset 286099
2025.01.05 00:12:33.741715 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushing system log, 7 entries to flush up to offset 471
2025.01.05 00:12:33.772308 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:12:33.775259 [ 694 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.92 GiB.
2025.01.05 00:12:33.818483 [ 694 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_62_62_0 (state Temporary)
2025.01.05 00:12:33.858178 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Renaming temporary part tmp_insert_202501_62_62_0 to 202501_62_62_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:12:33.866747 [ 694 ] {} <Error> void DB::SystemLog<DB::MetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::MetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/tmp_insert_202501_62_62_0/"] ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/202501_62_62_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::MetricLogElement>::savingThreadFunction() @ 0x000000001105dfec
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000ccd0554
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:12:33.867419 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushed system log up to offset 471
2025.01.05 00:12:34.002017 [ 696 ] {} <Trace> AsynchronousMetrics: MemoryTracking: was 573.54 MiB, peak 604.33 MiB, free memory in arenas 76.36 MiB, will set to 574.79 MiB (RSS), difference: 1.25 MiB
2025.01.05 00:12:35.093375 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushing system log, 4305 entries to flush up to offset 290404
2025.01.05 00:12:35.097464 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:12:35.099182 [ 687 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.92 GiB.
2025.01.05 00:12:35.127312 [ 687 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_67_67_0 (state Temporary)
2025.01.05 00:12:35.138483 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Renaming temporary part tmp_insert_202501_67_67_0 to 202501_67_67_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:12:35.142062 [ 687 ] {} <Error> void DB::SystemLog<DB::AsynchronousMetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::AsynchronousMetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/tmp_insert_202501_67_67_0/"] ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/202501_67_67_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::AsynchronousMetricLogElement>::savingThreadFunction() @ 0x000000001104f30c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000cccfe94
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:12:35.142367 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushed system log up to offset 290404
2025.01.05 00:12:41.368620 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushing system log, 8 entries to flush up to offset 479
2025.01.05 00:12:41.391469 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:12:41.393567 [ 694 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.92 GiB.
2025.01.05 00:12:41.424972 [ 694 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_63_63_0 (state Temporary)
2025.01.05 00:12:41.449198 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Renaming temporary part tmp_insert_202501_63_63_0 to 202501_63_63_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:12:41.458521 [ 694 ] {} <Error> void DB::SystemLog<DB::MetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::MetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/tmp_insert_202501_63_63_0/"] ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/202501_63_63_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::MetricLogElement>::savingThreadFunction() @ 0x000000001105dfec
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000ccd0554
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:12:41.459007 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushed system log up to offset 479
2025.01.05 00:12:42.142688 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushing system log, 4305 entries to flush up to offset 294709
2025.01.05 00:12:42.145655 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:12:42.147638 [ 687 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.92 GiB.
2025.01.05 00:12:42.164762 [ 687 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_68_68_0 (state Temporary)
2025.01.05 00:12:42.178004 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Renaming temporary part tmp_insert_202501_68_68_0 to 202501_68_68_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:12:42.182003 [ 687 ] {} <Error> void DB::SystemLog<DB::AsynchronousMetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::AsynchronousMetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/tmp_insert_202501_68_68_0/"] ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/202501_68_68_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::AsynchronousMetricLogElement>::savingThreadFunction() @ 0x000000001104f30c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000cccfe94
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:12:42.182342 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushed system log up to offset 294709
2025.01.05 00:12:42.842391 [ 616 ] {} <Trace> CgroupsMemoryUsageObserver: Read current memory usage 283.25 MiB from cgroups
2025.01.05 00:12:42.951073 [ 357 ] {} <Debug> DNSResolver: Updating DNS cache
2025.01.05 00:12:42.951597 [ 357 ] {} <Debug> DNSResolver: Updated DNS cache
2025.01.05 00:12:44.053049 [ 696 ] {} <Trace> AsynchronousMetrics: Update heavy metrics. Update period 1 sec. Update heavy metrics period 120 sec. Heavy metrics calculation elapsed: 0.0339833 sec.
2025.01.05 00:12:48.959792 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushing system log, 8 entries to flush up to offset 487
2025.01.05 00:12:48.981186 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:12:48.983196 [ 694 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.92 GiB.
2025.01.05 00:12:49.000641 [ 696 ] {} <Trace> AsynchronousMetrics: MemoryTracking: was 578.03 MiB, peak 604.33 MiB, free memory in arenas 57.47 MiB, will set to 568.44 MiB (RSS), difference: -9.60 MiB
2025.01.05 00:12:49.012531 [ 694 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_64_64_0 (state Temporary)
2025.01.05 00:12:49.035066 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Renaming temporary part tmp_insert_202501_64_64_0 to 202501_64_64_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:12:49.042657 [ 694 ] {} <Error> void DB::SystemLog<DB::MetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::MetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/tmp_insert_202501_64_64_0/"] ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/202501_64_64_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::MetricLogElement>::savingThreadFunction() @ 0x000000001105dfec
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000ccd0554
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:12:49.043411 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushed system log up to offset 487
2025.01.05 00:12:49.182953 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushing system log, 4305 entries to flush up to offset 299014
2025.01.05 00:12:49.185964 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:12:49.188053 [ 687 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.92 GiB.
2025.01.05 00:12:49.208005 [ 687 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_69_69_0 (state Temporary)
2025.01.05 00:12:49.221396 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Renaming temporary part tmp_insert_202501_69_69_0 to 202501_69_69_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:12:49.226284 [ 687 ] {} <Error> void DB::SystemLog<DB::AsynchronousMetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::AsynchronousMetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/tmp_insert_202501_69_69_0/"] ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/202501_69_69_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::AsynchronousMetricLogElement>::savingThreadFunction() @ 0x000000001104f30c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000cccfe94
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:12:49.226664 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushed system log up to offset 299014
2025.01.05 00:12:50.000517 [ 696 ] {} <Trace> AsynchronousMetrics: MemoryTracking: was 564.36 MiB, peak 604.33 MiB, free memory in arenas 71.81 MiB, will set to 572.34 MiB (RSS), difference: 7.98 MiB
2025.01.05 00:12:56.227478 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushing system log, 4305 entries to flush up to offset 303319
2025.01.05 00:12:56.230810 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:12:56.232498 [ 687 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.92 GiB.
2025.01.05 00:12:56.249075 [ 687 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_70_70_0 (state Temporary)
2025.01.05 00:12:56.261940 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Renaming temporary part tmp_insert_202501_70_70_0 to 202501_70_70_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:12:56.266358 [ 687 ] {} <Error> void DB::SystemLog<DB::AsynchronousMetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::AsynchronousMetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/tmp_insert_202501_70_70_0/"] ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/202501_70_70_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::AsynchronousMetricLogElement>::savingThreadFunction() @ 0x000000001104f30c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000cccfe94
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:12:56.266780 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushed system log up to offset 303319
2025.01.05 00:12:56.543899 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushing system log, 7 entries to flush up to offset 494
2025.01.05 00:12:56.568271 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:12:56.570174 [ 694 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.92 GiB.
2025.01.05 00:12:56.596324 [ 694 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_65_65_0 (state Temporary)
2025.01.05 00:12:56.617645 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Renaming temporary part tmp_insert_202501_65_65_0 to 202501_65_65_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:12:56.625352 [ 694 ] {} <Error> void DB::SystemLog<DB::MetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::MetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/tmp_insert_202501_65_65_0/"] ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/202501_65_65_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::MetricLogElement>::savingThreadFunction() @ 0x000000001105dfec
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000ccd0554
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:12:56.625864 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushed system log up to offset 494
2025.01.05 00:12:57.001186 [ 696 ] {} <Trace> AsynchronousMetrics: MemoryTracking: was 572.26 MiB, peak 604.33 MiB, free memory in arenas 80.63 MiB, will set to 577.95 MiB (RSS), difference: 5.68 MiB
2025.01.05 00:12:57.844460 [ 616 ] {} <Trace> CgroupsMemoryUsageObserver: Read current memory usage 287.23 MiB from cgroups
2025.01.05 00:12:57.953026 [ 300 ] {} <Debug> DNSResolver: Updating DNS cache
2025.01.05 00:12:57.954071 [ 300 ] {} <Debug> DNSResolver: Updated DNS cache
2025.01.05 00:13:03.267333 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushing system log, 4305 entries to flush up to offset 307624
2025.01.05 00:13:03.272886 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:13:03.274510 [ 687 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.92 GiB.
2025.01.05 00:13:03.300246 [ 687 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_71_71_0 (state Temporary)
2025.01.05 00:13:03.311826 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Renaming temporary part tmp_insert_202501_71_71_0 to 202501_71_71_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:13:03.315875 [ 687 ] {} <Error> void DB::SystemLog<DB::AsynchronousMetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::AsynchronousMetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/tmp_insert_202501_71_71_0/"] ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/202501_71_71_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::AsynchronousMetricLogElement>::savingThreadFunction() @ 0x000000001104f30c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000cccfe94
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:13:03.316288 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushed system log up to offset 307624
2025.01.05 00:13:04.126517 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushing system log, 8 entries to flush up to offset 502
2025.01.05 00:13:04.148132 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:13:04.150078 [ 694 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.92 GiB.
2025.01.05 00:13:04.189873 [ 694 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_66_66_0 (state Temporary)
2025.01.05 00:13:04.218073 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Renaming temporary part tmp_insert_202501_66_66_0 to 202501_66_66_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:13:04.227662 [ 694 ] {} <Error> void DB::SystemLog<DB::MetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::MetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/tmp_insert_202501_66_66_0/"] ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/202501_66_66_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::MetricLogElement>::savingThreadFunction() @ 0x000000001105dfec
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000ccd0554
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:13:04.228311 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushed system log up to offset 502
2025.01.05 00:13:10.317006 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushing system log, 4305 entries to flush up to offset 311929
2025.01.05 00:13:10.319964 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:13:10.321726 [ 687 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.92 GiB.
2025.01.05 00:13:10.343286 [ 687 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_72_72_0 (state Temporary)
2025.01.05 00:13:10.357908 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Renaming temporary part tmp_insert_202501_72_72_0 to 202501_72_72_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:13:10.364298 [ 687 ] {} <Error> void DB::SystemLog<DB::AsynchronousMetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::AsynchronousMetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/tmp_insert_202501_72_72_0/"] ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/202501_72_72_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::AsynchronousMetricLogElement>::savingThreadFunction() @ 0x000000001104f30c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000cccfe94
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:13:10.364862 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushed system log up to offset 311929
2025.01.05 00:13:11.729488 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushing system log, 7 entries to flush up to offset 509
2025.01.05 00:13:11.772011 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:13:11.773353 [ 694 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.92 GiB.
2025.01.05 00:13:11.805846 [ 694 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_67_67_0 (state Temporary)
2025.01.05 00:13:11.837939 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Renaming temporary part tmp_insert_202501_67_67_0 to 202501_67_67_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:13:11.846101 [ 694 ] {} <Error> void DB::SystemLog<DB::MetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::MetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/tmp_insert_202501_67_67_0/"] ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/202501_67_67_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::MetricLogElement>::savingThreadFunction() @ 0x000000001105dfec
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000ccd0554
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:13:11.846569 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushed system log up to offset 509
2025.01.05 00:13:12.845153 [ 616 ] {} <Trace> CgroupsMemoryUsageObserver: Read current memory usage 287.32 MiB from cgroups
2025.01.05 00:13:12.955439 [ 302 ] {} <Debug> DNSResolver: Updating DNS cache
2025.01.05 00:13:12.956100 [ 302 ] {} <Debug> DNSResolver: Updated DNS cache
2025.01.05 00:13:17.365097 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushing system log, 4305 entries to flush up to offset 316234
2025.01.05 00:13:17.368188 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:13:17.369860 [ 687 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.92 GiB.
2025.01.05 00:13:17.393792 [ 687 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_73_73_0 (state Temporary)
2025.01.05 00:13:17.409267 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Renaming temporary part tmp_insert_202501_73_73_0 to 202501_73_73_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:13:17.413983 [ 687 ] {} <Error> void DB::SystemLog<DB::AsynchronousMetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::AsynchronousMetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/tmp_insert_202501_73_73_0/"] ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/202501_73_73_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::AsynchronousMetricLogElement>::savingThreadFunction() @ 0x000000001104f30c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000cccfe94
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:13:17.414435 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushed system log up to offset 316234
2025.01.05 00:13:19.346936 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushing system log, 8 entries to flush up to offset 517
2025.01.05 00:13:19.368373 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:13:19.370419 [ 694 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.92 GiB.
2025.01.05 00:13:19.405477 [ 694 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_68_68_0 (state Temporary)
2025.01.05 00:13:19.432414 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Renaming temporary part tmp_insert_202501_68_68_0 to 202501_68_68_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:13:19.440738 [ 694 ] {} <Error> void DB::SystemLog<DB::MetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::MetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/tmp_insert_202501_68_68_0/"] ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/202501_68_68_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::MetricLogElement>::savingThreadFunction() @ 0x000000001105dfec
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000ccd0554
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:13:19.441179 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushed system log up to offset 517
2025.01.05 00:13:24.414765 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushing system log, 4305 entries to flush up to offset 320539
2025.01.05 00:13:24.417770 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:13:24.418528 [ 687 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.92 GiB.
2025.01.05 00:13:24.433244 [ 687 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_74_74_0 (state Temporary)
2025.01.05 00:13:24.444535 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Renaming temporary part tmp_insert_202501_74_74_0 to 202501_74_74_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:13:24.448487 [ 687 ] {} <Error> void DB::SystemLog<DB::AsynchronousMetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::AsynchronousMetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/tmp_insert_202501_74_74_0/"] ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/202501_74_74_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::AsynchronousMetricLogElement>::savingThreadFunction() @ 0x000000001104f30c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000cccfe94
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:13:24.448889 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushed system log up to offset 320539
2025.01.05 00:13:26.941567 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushing system log, 8 entries to flush up to offset 525
2025.01.05 00:13:26.973586 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:13:26.975568 [ 694 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.92 GiB.
2025.01.05 00:13:27.000621 [ 696 ] {} <Trace> AsynchronousMetrics: MemoryTracking: was 587.37 MiB, peak 604.33 MiB, free memory in arenas 62.61 MiB, will set to 574.21 MiB (RSS), difference: -13.17 MiB
2025.01.05 00:13:27.001129 [ 694 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_69_69_0 (state Temporary)
2025.01.05 00:13:27.022915 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Renaming temporary part tmp_insert_202501_69_69_0 to 202501_69_69_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:13:27.030514 [ 694 ] {} <Error> void DB::SystemLog<DB::MetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::MetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/tmp_insert_202501_69_69_0/"] ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/202501_69_69_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::MetricLogElement>::savingThreadFunction() @ 0x000000001105dfec
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000ccd0554
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:13:27.031253 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushed system log up to offset 525
2025.01.05 00:13:27.845915 [ 616 ] {} <Trace> CgroupsMemoryUsageObserver: Read current memory usage 287.10 MiB from cgroups
2025.01.05 00:13:27.956813 [ 325 ] {} <Debug> DNSResolver: Updating DNS cache
2025.01.05 00:13:27.957190 [ 325 ] {} <Debug> DNSResolver: Updated DNS cache
2025.01.05 00:13:28.001096 [ 696 ] {} <Trace> AsynchronousMetrics: MemoryTracking: was 565.27 MiB, peak 604.33 MiB, free memory in arenas 82.07 MiB, will set to 577.75 MiB (RSS), difference: 12.48 MiB
2025.01.05 00:13:31.449404 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushing system log, 4305 entries to flush up to offset 324844
2025.01.05 00:13:31.453114 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:13:31.454821 [ 687 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.92 GiB.
2025.01.05 00:13:31.476263 [ 687 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_75_75_0 (state Temporary)
2025.01.05 00:13:31.490543 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Renaming temporary part tmp_insert_202501_75_75_0 to 202501_75_75_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:13:31.496290 [ 687 ] {} <Error> void DB::SystemLog<DB::AsynchronousMetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::AsynchronousMetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/tmp_insert_202501_75_75_0/"] ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/202501_75_75_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::AsynchronousMetricLogElement>::savingThreadFunction() @ 0x000000001104f30c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000cccfe94
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:13:31.496724 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushed system log up to offset 324844
2025.01.05 00:13:34.531669 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushing system log, 7 entries to flush up to offset 532
2025.01.05 00:13:34.553104 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:13:34.554363 [ 694 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.92 GiB.
2025.01.05 00:13:34.580883 [ 694 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_70_70_0 (state Temporary)
2025.01.05 00:13:34.602114 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Renaming temporary part tmp_insert_202501_70_70_0 to 202501_70_70_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:13:34.609824 [ 694 ] {} <Error> void DB::SystemLog<DB::MetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::MetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/tmp_insert_202501_70_70_0/"] ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/202501_70_70_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::MetricLogElement>::savingThreadFunction() @ 0x000000001105dfec
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000ccd0554
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:13:34.610213 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushed system log up to offset 532
2025.01.05 00:13:38.497115 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushing system log, 4305 entries to flush up to offset 329149
2025.01.05 00:13:38.500367 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:13:38.501957 [ 687 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.92 GiB.
2025.01.05 00:13:38.523917 [ 687 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_76_76_0 (state Temporary)
2025.01.05 00:13:38.535937 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Renaming temporary part tmp_insert_202501_76_76_0 to 202501_76_76_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:13:38.539887 [ 687 ] {} <Error> void DB::SystemLog<DB::AsynchronousMetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::AsynchronousMetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/tmp_insert_202501_76_76_0/"] ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/202501_76_76_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::AsynchronousMetricLogElement>::savingThreadFunction() @ 0x000000001104f30c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000cccfe94
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:13:38.540489 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushed system log up to offset 329149
2025.01.05 00:13:42.110469 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushing system log, 8 entries to flush up to offset 540
2025.01.05 00:13:42.130867 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:13:42.132251 [ 694 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.92 GiB.
2025.01.05 00:13:42.155617 [ 694 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_71_71_0 (state Temporary)
2025.01.05 00:13:42.178751 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Renaming temporary part tmp_insert_202501_71_71_0 to 202501_71_71_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:13:42.186056 [ 694 ] {} <Error> void DB::SystemLog<DB::MetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::MetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/tmp_insert_202501_71_71_0/"] ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/202501_71_71_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::MetricLogElement>::savingThreadFunction() @ 0x000000001105dfec
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000ccd0554
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:13:42.186468 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushed system log up to offset 540
2025.01.05 00:13:42.849795 [ 616 ] {} <Trace> CgroupsMemoryUsageObserver: Read current memory usage 287.24 MiB from cgroups
2025.01.05 00:13:42.957662 [ 282 ] {} <Debug> DNSResolver: Updating DNS cache
2025.01.05 00:13:42.958827 [ 282 ] {} <Debug> DNSResolver: Updated DNS cache
2025.01.05 00:13:45.540968 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushing system log, 4305 entries to flush up to offset 333454
2025.01.05 00:13:45.544437 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:13:45.546102 [ 687 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.92 GiB.
2025.01.05 00:13:45.571524 [ 687 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_77_77_0 (state Temporary)
2025.01.05 00:13:45.586124 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Renaming temporary part tmp_insert_202501_77_77_0 to 202501_77_77_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:13:45.591178 [ 687 ] {} <Error> void DB::SystemLog<DB::AsynchronousMetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::AsynchronousMetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/tmp_insert_202501_77_77_0/"] ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/202501_77_77_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::AsynchronousMetricLogElement>::savingThreadFunction() @ 0x000000001104f30c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000cccfe94
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:13:45.592258 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushed system log up to offset 333454
2025.01.05 00:13:48.000650 [ 696 ] {} <Trace> AsynchronousMetrics: MemoryTracking: was 581.72 MiB, peak 604.33 MiB, free memory in arenas 82.25 MiB, will set to 577.72 MiB (RSS), difference: -4.00 MiB
2025.01.05 00:13:49.687460 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushing system log, 7 entries to flush up to offset 547
2025.01.05 00:13:49.709574 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:13:49.711303 [ 694 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.92 GiB.
2025.01.05 00:13:49.745116 [ 694 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_72_72_0 (state Temporary)
2025.01.05 00:13:49.767568 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Renaming temporary part tmp_insert_202501_72_72_0 to 202501_72_72_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:13:49.774710 [ 694 ] {} <Error> void DB::SystemLog<DB::MetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::MetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/tmp_insert_202501_72_72_0/"] ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/202501_72_72_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::MetricLogElement>::savingThreadFunction() @ 0x000000001105dfec
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000ccd0554
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:13:49.775380 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushed system log up to offset 547
2025.01.05 00:13:52.592662 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushing system log, 4305 entries to flush up to offset 337759
2025.01.05 00:13:52.595707 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:13:52.596750 [ 687 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.92 GiB.
2025.01.05 00:13:52.611264 [ 687 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_78_78_0 (state Temporary)
2025.01.05 00:13:52.623331 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Renaming temporary part tmp_insert_202501_78_78_0 to 202501_78_78_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:13:52.627666 [ 687 ] {} <Error> void DB::SystemLog<DB::AsynchronousMetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::AsynchronousMetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/tmp_insert_202501_78_78_0/"] ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/202501_78_78_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::AsynchronousMetricLogElement>::savingThreadFunction() @ 0x000000001104f30c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000cccfe94
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:13:52.628111 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushed system log up to offset 337759
2025.01.05 00:13:57.276414 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushing system log, 8 entries to flush up to offset 555
2025.01.05 00:13:57.310754 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:13:57.312838 [ 694 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.92 GiB.
2025.01.05 00:13:57.338815 [ 694 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_73_73_0 (state Temporary)
2025.01.05 00:13:57.361887 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Renaming temporary part tmp_insert_202501_73_73_0 to 202501_73_73_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:13:57.369013 [ 694 ] {} <Error> void DB::SystemLog<DB::MetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::MetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/tmp_insert_202501_73_73_0/"] ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/202501_73_73_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::MetricLogElement>::savingThreadFunction() @ 0x000000001105dfec
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000ccd0554
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:13:57.369461 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushed system log up to offset 555
2025.01.05 00:13:57.851008 [ 616 ] {} <Trace> CgroupsMemoryUsageObserver: Read current memory usage 287.05 MiB from cgroups
2025.01.05 00:13:57.960305 [ 304 ] {} <Debug> DNSResolver: Updating DNS cache
2025.01.05 00:13:57.961371 [ 304 ] {} <Debug> DNSResolver: Updated DNS cache
2025.01.05 00:13:58.001129 [ 696 ] {} <Trace> AsynchronousMetrics: MemoryTracking: was 577.11 MiB, peak 604.33 MiB, free memory in arenas 71.22 MiB, will set to 579.61 MiB (RSS), difference: 2.50 MiB
2025.01.05 00:13:59.628928 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushing system log, 4305 entries to flush up to offset 342064
2025.01.05 00:13:59.632231 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:13:59.634071 [ 687 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.92 GiB.
2025.01.05 00:13:59.655209 [ 687 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_79_79_0 (state Temporary)
2025.01.05 00:13:59.666657 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Renaming temporary part tmp_insert_202501_79_79_0 to 202501_79_79_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:13:59.670282 [ 687 ] {} <Error> void DB::SystemLog<DB::AsynchronousMetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::AsynchronousMetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/tmp_insert_202501_79_79_0/"] ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/202501_79_79_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::AsynchronousMetricLogElement>::savingThreadFunction() @ 0x000000001104f30c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000cccfe94
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:13:59.670705 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushed system log up to offset 342064
2025.01.05 00:14:04.870149 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushing system log, 7 entries to flush up to offset 562
2025.01.05 00:14:04.892417 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:14:04.894571 [ 694 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.92 GiB.
2025.01.05 00:14:04.934722 [ 694 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_74_74_0 (state Temporary)
2025.01.05 00:14:04.959968 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Renaming temporary part tmp_insert_202501_74_74_0 to 202501_74_74_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:14:04.967118 [ 694 ] {} <Error> void DB::SystemLog<DB::MetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::MetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/tmp_insert_202501_74_74_0/"] ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/202501_74_74_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::MetricLogElement>::savingThreadFunction() @ 0x000000001105dfec
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000ccd0554
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:14:04.967536 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushed system log up to offset 562
2025.01.05 00:14:06.671838 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushing system log, 4305 entries to flush up to offset 346369
2025.01.05 00:14:06.679389 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:14:06.681179 [ 687 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.92 GiB.
2025.01.05 00:14:06.698571 [ 687 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_80_80_0 (state Temporary)
2025.01.05 00:14:06.713236 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Renaming temporary part tmp_insert_202501_80_80_0 to 202501_80_80_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:14:06.717463 [ 687 ] {} <Error> void DB::SystemLog<DB::AsynchronousMetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::AsynchronousMetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/tmp_insert_202501_80_80_0/"] ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/202501_80_80_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::AsynchronousMetricLogElement>::savingThreadFunction() @ 0x000000001104f30c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000cccfe94
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:14:06.717973 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushed system log up to offset 346369
2025.01.05 00:14:12.467799 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushing system log, 8 entries to flush up to offset 570
2025.01.05 00:14:12.489182 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:14:12.490137 [ 694 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.92 GiB.
2025.01.05 00:14:12.515553 [ 694 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_75_75_0 (state Temporary)
2025.01.05 00:14:12.539736 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Renaming temporary part tmp_insert_202501_75_75_0 to 202501_75_75_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:14:12.546861 [ 694 ] {} <Error> void DB::SystemLog<DB::MetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::MetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/tmp_insert_202501_75_75_0/"] ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/202501_75_75_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::MetricLogElement>::savingThreadFunction() @ 0x000000001105dfec
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000ccd0554
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:14:12.547303 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushed system log up to offset 570
2025.01.05 00:14:12.851790 [ 616 ] {} <Trace> CgroupsMemoryUsageObserver: Read current memory usage 290.37 MiB from cgroups
2025.01.05 00:14:12.962189 [ 329 ] {} <Debug> DNSResolver: Updating DNS cache
2025.01.05 00:14:12.963007 [ 329 ] {} <Debug> DNSResolver: Updated DNS cache
2025.01.05 00:14:13.718375 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushing system log, 4305 entries to flush up to offset 350674
2025.01.05 00:14:13.721996 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:14:13.722694 [ 687 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.92 GiB.
2025.01.05 00:14:13.736759 [ 687 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_81_81_0 (state Temporary)
2025.01.05 00:14:13.750382 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Renaming temporary part tmp_insert_202501_81_81_0 to 202501_81_81_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:14:13.754482 [ 687 ] {} <Error> void DB::SystemLog<DB::AsynchronousMetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::AsynchronousMetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/tmp_insert_202501_81_81_0/"] ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/202501_81_81_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::AsynchronousMetricLogElement>::savingThreadFunction() @ 0x000000001104f30c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000cccfe94
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:14:13.754827 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushed system log up to offset 350674
2025.01.05 00:14:20.047646 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushing system log, 8 entries to flush up to offset 578
2025.01.05 00:14:20.073742 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:14:20.075914 [ 694 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.92 GiB.
2025.01.05 00:14:20.105488 [ 694 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_76_76_0 (state Temporary)
2025.01.05 00:14:20.129104 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Renaming temporary part tmp_insert_202501_76_76_0 to 202501_76_76_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:14:20.137022 [ 694 ] {} <Error> void DB::SystemLog<DB::MetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::MetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/tmp_insert_202501_76_76_0/"] ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/202501_76_76_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::MetricLogElement>::savingThreadFunction() @ 0x000000001105dfec
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000ccd0554
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:14:20.137564 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushed system log up to offset 578
2025.01.05 00:14:20.755119 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushing system log, 4305 entries to flush up to offset 354979
2025.01.05 00:14:20.758882 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:14:20.760957 [ 687 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.92 GiB.
2025.01.05 00:14:20.778270 [ 687 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_82_82_0 (state Temporary)
2025.01.05 00:14:20.792415 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Renaming temporary part tmp_insert_202501_82_82_0 to 202501_82_82_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:14:20.796339 [ 687 ] {} <Error> void DB::SystemLog<DB::AsynchronousMetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::AsynchronousMetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/tmp_insert_202501_82_82_0/"] ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/202501_82_82_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::AsynchronousMetricLogElement>::savingThreadFunction() @ 0x000000001104f30c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000cccfe94
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:14:20.796676 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushed system log up to offset 354979
2025.01.05 00:14:27.638942 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushing system log, 7 entries to flush up to offset 585
2025.01.05 00:14:27.658613 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:14:27.659528 [ 694 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.92 GiB.
2025.01.05 00:14:27.690068 [ 694 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_77_77_0 (state Temporary)
2025.01.05 00:14:27.716551 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Renaming temporary part tmp_insert_202501_77_77_0 to 202501_77_77_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:14:27.724954 [ 694 ] {} <Error> void DB::SystemLog<DB::MetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::MetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/tmp_insert_202501_77_77_0/"] ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/202501_77_77_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::MetricLogElement>::savingThreadFunction() @ 0x000000001105dfec
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000ccd0554
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:14:27.725904 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushed system log up to offset 585
2025.01.05 00:14:27.798057 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushing system log, 4305 entries to flush up to offset 359284
2025.01.05 00:14:27.801278 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:14:27.802056 [ 687 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.92 GiB.
2025.01.05 00:14:27.817500 [ 687 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_83_83_0 (state Temporary)
2025.01.05 00:14:27.829786 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Renaming temporary part tmp_insert_202501_83_83_0 to 202501_83_83_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:14:27.833613 [ 687 ] {} <Error> void DB::SystemLog<DB::AsynchronousMetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::AsynchronousMetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/tmp_insert_202501_83_83_0/"] ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/202501_83_83_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::AsynchronousMetricLogElement>::savingThreadFunction() @ 0x000000001104f30c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000cccfe94
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:14:27.833938 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushed system log up to offset 359284
2025.01.05 00:14:27.853363 [ 616 ] {} <Trace> CgroupsMemoryUsageObserver: Read current memory usage 290.25 MiB from cgroups
2025.01.05 00:14:27.963745 [ 333 ] {} <Debug> DNSResolver: Updating DNS cache
2025.01.05 00:14:27.964213 [ 333 ] {} <Debug> DNSResolver: Updated DNS cache
2025.01.05 00:14:28.000654 [ 696 ] {} <Trace> AsynchronousMetrics: MemoryTracking: was 579.42 MiB, peak 604.33 MiB, free memory in arenas 82.20 MiB, will set to 580.84 MiB (RSS), difference: 1.42 MiB
2025.01.05 00:14:34.834254 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushing system log, 4305 entries to flush up to offset 363589
2025.01.05 00:14:34.837543 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:14:34.839481 [ 687 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.92 GiB.
2025.01.05 00:14:34.856876 [ 687 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_84_84_0 (state Temporary)
2025.01.05 00:14:34.871433 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Renaming temporary part tmp_insert_202501_84_84_0 to 202501_84_84_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:14:34.875655 [ 687 ] {} <Error> void DB::SystemLog<DB::AsynchronousMetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::AsynchronousMetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/tmp_insert_202501_84_84_0/"] ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/202501_84_84_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::AsynchronousMetricLogElement>::savingThreadFunction() @ 0x000000001104f30c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000cccfe94
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:14:34.876119 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushed system log up to offset 363589
2025.01.05 00:14:35.226361 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushing system log, 8 entries to flush up to offset 593
2025.01.05 00:14:35.246429 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:14:35.248385 [ 694 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.92 GiB.
2025.01.05 00:14:35.277826 [ 694 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_78_78_0 (state Temporary)
2025.01.05 00:14:35.303575 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Renaming temporary part tmp_insert_202501_78_78_0 to 202501_78_78_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:14:35.312500 [ 694 ] {} <Error> void DB::SystemLog<DB::MetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::MetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/tmp_insert_202501_78_78_0/"] ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/202501_78_78_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::MetricLogElement>::savingThreadFunction() @ 0x000000001105dfec
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000ccd0554
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:14:35.313152 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushed system log up to offset 593
2025.01.05 00:14:41.876641 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushing system log, 4305 entries to flush up to offset 367894
2025.01.05 00:14:41.879774 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:14:41.881219 [ 687 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.92 GiB.
2025.01.05 00:14:41.904029 [ 687 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_85_85_0 (state Temporary)
2025.01.05 00:14:41.915369 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Renaming temporary part tmp_insert_202501_85_85_0 to 202501_85_85_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:14:41.919451 [ 687 ] {} <Error> void DB::SystemLog<DB::AsynchronousMetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::AsynchronousMetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/tmp_insert_202501_85_85_0/"] ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/202501_85_85_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::AsynchronousMetricLogElement>::savingThreadFunction() @ 0x000000001104f30c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000cccfe94
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:14:41.919985 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushed system log up to offset 367894
2025.01.05 00:14:42.813509 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushing system log, 7 entries to flush up to offset 600
2025.01.05 00:14:42.833572 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:14:42.835631 [ 694 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.92 GiB.
2025.01.05 00:14:42.853932 [ 616 ] {} <Trace> CgroupsMemoryUsageObserver: Read current memory usage 285.98 MiB from cgroups
2025.01.05 00:14:42.862893 [ 694 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_79_79_0 (state Temporary)
2025.01.05 00:14:42.885771 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Renaming temporary part tmp_insert_202501_79_79_0 to 202501_79_79_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:14:42.892721 [ 694 ] {} <Error> void DB::SystemLog<DB::MetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::MetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/tmp_insert_202501_79_79_0/"] ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/202501_79_79_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::MetricLogElement>::savingThreadFunction() @ 0x000000001105dfec
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000ccd0554
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:14:42.893189 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushed system log up to offset 600
2025.01.05 00:14:42.964850 [ 306 ] {} <Debug> DNSResolver: Updating DNS cache
2025.01.05 00:14:42.965643 [ 306 ] {} <Debug> DNSResolver: Updated DNS cache
2025.01.05 00:14:44.000856 [ 696 ] {} <Trace> AsynchronousMetrics: Scanning /sys/block
2025.01.05 00:14:44.038567 [ 696 ] {} <Trace> AsynchronousMetrics: Update heavy metrics. Update period 1 sec. Update heavy metrics period 120 sec. Heavy metrics calculation elapsed: 0.0347311 sec.
2025.01.05 00:14:48.920267 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushing system log, 4305 entries to flush up to offset 372199
2025.01.05 00:14:48.925039 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:14:48.926265 [ 687 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.92 GiB.
2025.01.05 00:14:48.943431 [ 687 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_86_86_0 (state Temporary)
2025.01.05 00:14:48.957179 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Renaming temporary part tmp_insert_202501_86_86_0 to 202501_86_86_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:14:48.961802 [ 687 ] {} <Error> void DB::SystemLog<DB::AsynchronousMetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::AsynchronousMetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/tmp_insert_202501_86_86_0/"] ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/202501_86_86_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::AsynchronousMetricLogElement>::savingThreadFunction() @ 0x000000001104f30c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000cccfe94
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:14:48.962334 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushed system log up to offset 372199
2025.01.05 00:14:50.393489 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushing system log, 8 entries to flush up to offset 608
2025.01.05 00:14:50.414949 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:14:50.416173 [ 694 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.92 GiB.
2025.01.05 00:14:50.446490 [ 694 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_80_80_0 (state Temporary)
2025.01.05 00:14:50.473494 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Renaming temporary part tmp_insert_202501_80_80_0 to 202501_80_80_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:14:50.482819 [ 694 ] {} <Error> void DB::SystemLog<DB::MetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::MetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/tmp_insert_202501_80_80_0/"] ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/202501_80_80_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::MetricLogElement>::savingThreadFunction() @ 0x000000001105dfec
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000ccd0554
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:14:50.483385 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushed system log up to offset 608
2025.01.05 00:14:55.963131 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushing system log, 4305 entries to flush up to offset 376504
2025.01.05 00:14:55.966097 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:14:55.967939 [ 687 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.92 GiB.
2025.01.05 00:14:55.990057 [ 687 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_87_87_0 (state Temporary)
2025.01.05 00:14:56.000688 [ 696 ] {} <Trace> AsynchronousMetrics: MemoryTracking: was 588.30 MiB, peak 604.33 MiB, free memory in arenas 72.16 MiB, will set to 579.85 MiB (RSS), difference: -8.46 MiB
2025.01.05 00:14:56.001496 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Renaming temporary part tmp_insert_202501_87_87_0 to 202501_87_87_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:14:56.005516 [ 687 ] {} <Error> void DB::SystemLog<DB::AsynchronousMetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::AsynchronousMetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/tmp_insert_202501_87_87_0/"] ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/202501_87_87_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::AsynchronousMetricLogElement>::savingThreadFunction() @ 0x000000001104f30c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000cccfe94
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:14:56.006051 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushed system log up to offset 376504
2025.01.05 00:14:57.000687 [ 696 ] {} <Trace> AsynchronousMetrics: MemoryTracking: was 571.60 MiB, peak 604.33 MiB, free memory in arenas 82.30 MiB, will set to 580.05 MiB (RSS), difference: 8.45 MiB
2025.01.05 00:14:57.854663 [ 616 ] {} <Trace> CgroupsMemoryUsageObserver: Read current memory usage 289.50 MiB from cgroups
2025.01.05 00:14:57.967137 [ 287 ] {} <Debug> DNSResolver: Updating DNS cache
2025.01.05 00:14:57.968923 [ 287 ] {} <Debug> DNSResolver: Updated DNS cache
2025.01.05 00:14:57.984309 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushing system log, 8 entries to flush up to offset 616
2025.01.05 00:14:58.000771 [ 696 ] {} <Trace> AsynchronousMetrics: MemoryTracking: was 584.05 MiB, peak 604.33 MiB, free memory in arenas 66.10 MiB, will set to 575.13 MiB (RSS), difference: -8.92 MiB
2025.01.05 00:14:58.007206 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:14:58.009024 [ 694 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.92 GiB.
2025.01.05 00:14:58.039353 [ 694 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_81_81_0 (state Temporary)
2025.01.05 00:14:58.061596 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Renaming temporary part tmp_insert_202501_81_81_0 to 202501_81_81_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:14:58.069237 [ 694 ] {} <Error> void DB::SystemLog<DB::MetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::MetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/tmp_insert_202501_81_81_0/"] ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/202501_81_81_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::MetricLogElement>::savingThreadFunction() @ 0x000000001105dfec
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000ccd0554
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:14:58.069789 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushed system log up to offset 616
2025.01.05 00:14:59.000636 [ 696 ] {} <Trace> AsynchronousMetrics: MemoryTracking: was 571.07 MiB, peak 604.33 MiB, free memory in arenas 82.61 MiB, will set to 580.70 MiB (RSS), difference: 9.64 MiB
2025.01.05 00:15:03.006397 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushing system log, 4920 entries to flush up to offset 381424
2025.01.05 00:15:03.009623 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:15:03.011032 [ 687 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.92 GiB.
2025.01.05 00:15:03.031091 [ 687 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_88_88_0 (state Temporary)
2025.01.05 00:15:03.045051 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Renaming temporary part tmp_insert_202501_88_88_0 to 202501_88_88_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:15:03.050144 [ 687 ] {} <Error> void DB::SystemLog<DB::AsynchronousMetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::AsynchronousMetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/tmp_insert_202501_88_88_0/"] ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/202501_88_88_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::AsynchronousMetricLogElement>::savingThreadFunction() @ 0x000000001104f30c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000cccfe94
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:15:03.050953 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushed system log up to offset 381424
2025.01.05 00:15:05.570078 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushing system log, 7 entries to flush up to offset 623
2025.01.05 00:15:05.591997 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:15:05.594301 [ 694 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.92 GiB.
2025.01.05 00:15:05.629666 [ 694 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_82_82_0 (state Temporary)
2025.01.05 00:15:05.655800 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Renaming temporary part tmp_insert_202501_82_82_0 to 202501_82_82_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:15:05.663298 [ 694 ] {} <Error> void DB::SystemLog<DB::MetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::MetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/tmp_insert_202501_82_82_0/"] ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/202501_82_82_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::MetricLogElement>::savingThreadFunction() @ 0x000000001105dfec
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000ccd0554
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:15:05.664208 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushed system log up to offset 623
2025.01.05 00:15:06.000642 [ 696 ] {} <Trace> AsynchronousMetrics: MemoryTracking: was 580.74 MiB, peak 604.33 MiB, free memory in arenas 82.37 MiB, will set to 579.52 MiB (RSS), difference: -1.22 MiB
2025.01.05 00:15:10.051907 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushing system log, 4305 entries to flush up to offset 385729
2025.01.05 00:15:10.056040 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:15:10.057988 [ 687 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.92 GiB.
2025.01.05 00:15:10.084099 [ 687 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_89_89_0 (state Temporary)
2025.01.05 00:15:10.096912 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Renaming temporary part tmp_insert_202501_89_89_0 to 202501_89_89_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:15:10.100860 [ 687 ] {} <Error> void DB::SystemLog<DB::AsynchronousMetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::AsynchronousMetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/tmp_insert_202501_89_89_0/"] ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/202501_89_89_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::AsynchronousMetricLogElement>::savingThreadFunction() @ 0x000000001104f30c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000cccfe94
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:15:10.101296 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushed system log up to offset 385729
2025.01.05 00:15:12.855511 [ 616 ] {} <Trace> CgroupsMemoryUsageObserver: Read current memory usage 288.91 MiB from cgroups
2025.01.05 00:15:12.970256 [ 334 ] {} <Debug> DNSResolver: Updating DNS cache
2025.01.05 00:15:12.970909 [ 334 ] {} <Debug> DNSResolver: Updated DNS cache
2025.01.05 00:15:13.164737 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushing system log, 8 entries to flush up to offset 631
2025.01.05 00:15:13.184686 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:15:13.185834 [ 694 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.92 GiB.
2025.01.05 00:15:13.209389 [ 694 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_83_83_0 (state Temporary)
2025.01.05 00:15:13.234474 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Renaming temporary part tmp_insert_202501_83_83_0 to 202501_83_83_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:15:13.242513 [ 694 ] {} <Error> void DB::SystemLog<DB::MetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::MetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/tmp_insert_202501_83_83_0/"] ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/202501_83_83_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::MetricLogElement>::savingThreadFunction() @ 0x000000001105dfec
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000ccd0554
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:15:13.243048 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushed system log up to offset 631
2025.01.05 00:15:14.000659 [ 696 ] {} <Trace> AsynchronousMetrics: MemoryTracking: was 579.36 MiB, peak 604.33 MiB, free memory in arenas 82.71 MiB, will set to 581.49 MiB (RSS), difference: 2.13 MiB
2025.01.05 00:15:17.101931 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushing system log, 4305 entries to flush up to offset 390034
2025.01.05 00:15:17.104948 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:15:17.106768 [ 687 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.92 GiB.
2025.01.05 00:15:17.129286 [ 687 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_90_90_0 (state Temporary)
2025.01.05 00:15:17.143171 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Renaming temporary part tmp_insert_202501_90_90_0 to 202501_90_90_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:15:17.147608 [ 687 ] {} <Error> void DB::SystemLog<DB::AsynchronousMetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::AsynchronousMetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/tmp_insert_202501_90_90_0/"] ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/202501_90_90_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::AsynchronousMetricLogElement>::savingThreadFunction() @ 0x000000001104f30c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000cccfe94
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:15:17.147880 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushed system log up to offset 390034
2025.01.05 00:15:20.743663 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushing system log, 7 entries to flush up to offset 638
2025.01.05 00:15:20.764854 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:15:20.766656 [ 694 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.92 GiB.
2025.01.05 00:15:20.793622 [ 694 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_84_84_0 (state Temporary)
2025.01.05 00:15:20.819999 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Renaming temporary part tmp_insert_202501_84_84_0 to 202501_84_84_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:15:20.828290 [ 694 ] {} <Error> void DB::SystemLog<DB::MetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::MetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/tmp_insert_202501_84_84_0/"] ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/202501_84_84_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::MetricLogElement>::savingThreadFunction() @ 0x000000001105dfec
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000ccd0554
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:15:20.828801 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushed system log up to offset 638
2025.01.05 00:15:21.001343 [ 696 ] {} <Trace> AsynchronousMetrics: MemoryTracking: was 581.32 MiB, peak 604.33 MiB, free memory in arenas 82.27 MiB, will set to 579.27 MiB (RSS), difference: -2.05 MiB
2025.01.05 00:15:24.148168 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushing system log, 4305 entries to flush up to offset 394339
2025.01.05 00:15:24.151513 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:15:24.152940 [ 687 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.92 GiB.
2025.01.05 00:15:24.173059 [ 687 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_91_91_0 (state Temporary)
2025.01.05 00:15:24.189410 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Renaming temporary part tmp_insert_202501_91_91_0 to 202501_91_91_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:15:24.193897 [ 687 ] {} <Error> void DB::SystemLog<DB::AsynchronousMetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::AsynchronousMetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/tmp_insert_202501_91_91_0/"] ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/202501_91_91_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::AsynchronousMetricLogElement>::savingThreadFunction() @ 0x000000001104f30c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000cccfe94
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:15:24.194207 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushed system log up to offset 394339
2025.01.05 00:15:27.856635 [ 616 ] {} <Trace> CgroupsMemoryUsageObserver: Read current memory usage 289.09 MiB from cgroups
2025.01.05 00:15:27.971464 [ 340 ] {} <Debug> DNSResolver: Updating DNS cache
2025.01.05 00:15:27.972038 [ 340 ] {} <Debug> DNSResolver: Updated DNS cache
2025.01.05 00:15:28.329139 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushing system log, 8 entries to flush up to offset 646
2025.01.05 00:15:28.347228 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:15:28.349280 [ 694 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.92 GiB.
2025.01.05 00:15:28.376439 [ 694 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_85_85_0 (state Temporary)
2025.01.05 00:15:28.401188 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Renaming temporary part tmp_insert_202501_85_85_0 to 202501_85_85_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:15:28.408721 [ 694 ] {} <Error> void DB::SystemLog<DB::MetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::MetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/tmp_insert_202501_85_85_0/"] ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/202501_85_85_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::MetricLogElement>::savingThreadFunction() @ 0x000000001105dfec
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000ccd0554
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:15:28.409754 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushed system log up to offset 646
2025.01.05 00:15:31.194778 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushing system log, 4305 entries to flush up to offset 398644
2025.01.05 00:15:31.197627 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:15:31.198871 [ 687 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.92 GiB.
2025.01.05 00:15:31.214935 [ 687 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_92_92_0 (state Temporary)
2025.01.05 00:15:31.228427 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Renaming temporary part tmp_insert_202501_92_92_0 to 202501_92_92_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:15:31.232396 [ 687 ] {} <Error> void DB::SystemLog<DB::AsynchronousMetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::AsynchronousMetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/tmp_insert_202501_92_92_0/"] ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/202501_92_92_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::AsynchronousMetricLogElement>::savingThreadFunction() @ 0x000000001104f30c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000cccfe94
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:15:31.232774 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushed system log up to offset 398644
2025.01.05 00:15:35.910160 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushing system log, 8 entries to flush up to offset 654
2025.01.05 00:15:35.930807 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:15:35.932056 [ 694 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.92 GiB.
2025.01.05 00:15:35.963462 [ 694 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_86_86_0 (state Temporary)
2025.01.05 00:15:35.989018 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Renaming temporary part tmp_insert_202501_86_86_0 to 202501_86_86_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:15:35.996273 [ 694 ] {} <Error> void DB::SystemLog<DB::MetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::MetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/tmp_insert_202501_86_86_0/"] ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/202501_86_86_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::MetricLogElement>::savingThreadFunction() @ 0x000000001105dfec
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000ccd0554
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:15:35.996688 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushed system log up to offset 654
2025.01.05 00:15:38.233157 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushing system log, 4305 entries to flush up to offset 402949
2025.01.05 00:15:38.237395 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:15:38.238548 [ 687 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.92 GiB.
2025.01.05 00:15:38.324431 [ 687 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_93_93_0 (state Temporary)
2025.01.05 00:15:38.359224 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Renaming temporary part tmp_insert_202501_93_93_0 to 202501_93_93_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:15:38.364099 [ 687 ] {} <Error> void DB::SystemLog<DB::AsynchronousMetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::AsynchronousMetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/tmp_insert_202501_93_93_0/"] ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/202501_93_93_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::AsynchronousMetricLogElement>::savingThreadFunction() @ 0x000000001104f30c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000cccfe94
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:15:38.364675 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushed system log up to offset 402949
2025.01.05 00:15:42.857992 [ 616 ] {} <Trace> CgroupsMemoryUsageObserver: Read current memory usage 288.89 MiB from cgroups
2025.01.05 00:15:42.972800 [ 310 ] {} <Debug> DNSResolver: Updating DNS cache
2025.01.05 00:15:42.973526 [ 310 ] {} <Debug> DNSResolver: Updated DNS cache
2025.01.05 00:15:43.496970 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushing system log, 7 entries to flush up to offset 661
2025.01.05 00:15:43.515475 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:15:43.517422 [ 694 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.92 GiB.
2025.01.05 00:15:43.542431 [ 694 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_87_87_0 (state Temporary)
2025.01.05 00:15:43.567701 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Renaming temporary part tmp_insert_202501_87_87_0 to 202501_87_87_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:15:43.575409 [ 694 ] {} <Error> void DB::SystemLog<DB::MetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::MetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/tmp_insert_202501_87_87_0/"] ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/202501_87_87_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::MetricLogElement>::savingThreadFunction() @ 0x000000001105dfec
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000ccd0554
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:15:43.577779 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushed system log up to offset 661
2025.01.05 00:15:45.365155 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushing system log, 4305 entries to flush up to offset 407254
2025.01.05 00:15:45.372375 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:15:45.373824 [ 687 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.92 GiB.
2025.01.05 00:15:45.397170 [ 687 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_94_94_0 (state Temporary)
2025.01.05 00:15:45.410848 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Renaming temporary part tmp_insert_202501_94_94_0 to 202501_94_94_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:15:45.415183 [ 687 ] {} <Error> void DB::SystemLog<DB::AsynchronousMetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::AsynchronousMetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/tmp_insert_202501_94_94_0/"] ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/202501_94_94_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::AsynchronousMetricLogElement>::savingThreadFunction() @ 0x000000001104f30c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000cccfe94
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:15:45.415473 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushed system log up to offset 407254
2025.01.05 00:15:51.078348 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushing system log, 8 entries to flush up to offset 669
2025.01.05 00:15:51.099113 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:15:51.101071 [ 694 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.92 GiB.
2025.01.05 00:15:51.132442 [ 694 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_88_88_0 (state Temporary)
2025.01.05 00:15:51.155522 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Renaming temporary part tmp_insert_202501_88_88_0 to 202501_88_88_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:15:51.163595 [ 694 ] {} <Error> void DB::SystemLog<DB::MetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::MetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/tmp_insert_202501_88_88_0/"] ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/202501_88_88_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::MetricLogElement>::savingThreadFunction() @ 0x000000001105dfec
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000ccd0554
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:15:51.164045 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushed system log up to offset 669
2025.01.05 00:15:52.415761 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushing system log, 4305 entries to flush up to offset 411559
2025.01.05 00:15:52.418517 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:15:52.419774 [ 687 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.92 GiB.
2025.01.05 00:15:52.440267 [ 687 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_95_95_0 (state Temporary)
2025.01.05 00:15:52.450632 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Renaming temporary part tmp_insert_202501_95_95_0 to 202501_95_95_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:15:52.454148 [ 687 ] {} <Error> void DB::SystemLog<DB::AsynchronousMetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::AsynchronousMetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/tmp_insert_202501_95_95_0/"] ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/202501_95_95_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::AsynchronousMetricLogElement>::savingThreadFunction() @ 0x000000001104f30c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000cccfe94
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:15:52.454461 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushed system log up to offset 411559
2025.01.05 00:15:57.863611 [ 616 ] {} <Trace> CgroupsMemoryUsageObserver: Read current memory usage 288.48 MiB from cgroups
2025.01.05 00:15:57.974920 [ 335 ] {} <Debug> DNSResolver: Updating DNS cache
2025.01.05 00:15:57.976501 [ 335 ] {} <Debug> DNSResolver: Updated DNS cache
2025.01.05 00:15:58.664740 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushing system log, 7 entries to flush up to offset 676
2025.01.05 00:15:58.683917 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:15:58.685984 [ 694 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.92 GiB.
2025.01.05 00:15:58.710915 [ 694 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_89_89_0 (state Temporary)
2025.01.05 00:15:58.732654 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Renaming temporary part tmp_insert_202501_89_89_0 to 202501_89_89_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:15:58.740252 [ 694 ] {} <Error> void DB::SystemLog<DB::MetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::MetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/tmp_insert_202501_89_89_0/"] ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/202501_89_89_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::MetricLogElement>::savingThreadFunction() @ 0x000000001105dfec
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000ccd0554
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:15:58.740648 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushed system log up to offset 676
2025.01.05 00:15:59.455026 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushing system log, 4305 entries to flush up to offset 415864
2025.01.05 00:15:59.458787 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:15:59.460218 [ 687 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.92 GiB.
2025.01.05 00:15:59.482801 [ 687 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_96_96_0 (state Temporary)
2025.01.05 00:15:59.497119 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Renaming temporary part tmp_insert_202501_96_96_0 to 202501_96_96_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:15:59.503052 [ 687 ] {} <Error> void DB::SystemLog<DB::AsynchronousMetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::AsynchronousMetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/tmp_insert_202501_96_96_0/"] ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/202501_96_96_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::AsynchronousMetricLogElement>::savingThreadFunction() @ 0x000000001104f30c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000cccfe94
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:15:59.503665 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushed system log up to offset 415864
2025.01.05 00:16:06.241005 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushing system log, 8 entries to flush up to offset 684
2025.01.05 00:16:06.259719 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:16:06.261166 [ 694 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.92 GiB.
2025.01.05 00:16:06.285267 [ 694 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_90_90_0 (state Temporary)
2025.01.05 00:16:06.309560 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Renaming temporary part tmp_insert_202501_90_90_0 to 202501_90_90_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:16:06.318137 [ 694 ] {} <Error> void DB::SystemLog<DB::MetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::MetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/tmp_insert_202501_90_90_0/"] ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/202501_90_90_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::MetricLogElement>::savingThreadFunction() @ 0x000000001105dfec
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000ccd0554
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:16:06.318880 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushed system log up to offset 684
2025.01.05 00:16:06.504600 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushing system log, 4305 entries to flush up to offset 420169
2025.01.05 00:16:06.509614 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:16:06.512092 [ 687 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.92 GiB.
2025.01.05 00:16:06.530858 [ 687 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_97_97_0 (state Temporary)
2025.01.05 00:16:06.543291 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Renaming temporary part tmp_insert_202501_97_97_0 to 202501_97_97_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:16:06.547034 [ 687 ] {} <Error> void DB::SystemLog<DB::AsynchronousMetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::AsynchronousMetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/tmp_insert_202501_97_97_0/"] ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/202501_97_97_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::AsynchronousMetricLogElement>::savingThreadFunction() @ 0x000000001104f30c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000cccfe94
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:16:06.547383 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushed system log up to offset 420169
2025.01.05 00:16:08.001497 [ 696 ] {} <Trace> AsynchronousMetrics: MemoryTracking: was 579.18 MiB, peak 604.33 MiB, free memory in arenas 77.99 MiB, will set to 581.45 MiB (RSS), difference: 2.28 MiB
2025.01.05 00:16:12.865016 [ 616 ] {} <Trace> CgroupsMemoryUsageObserver: Read current memory usage 291.11 MiB from cgroups
2025.01.05 00:16:12.977852 [ 336 ] {} <Debug> DNSResolver: Updating DNS cache
2025.01.05 00:16:12.979008 [ 336 ] {} <Debug> DNSResolver: Updated DNS cache
2025.01.05 00:16:13.547824 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushing system log, 4305 entries to flush up to offset 424474
2025.01.05 00:16:13.551777 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:16:13.553785 [ 687 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.92 GiB.
2025.01.05 00:16:13.575574 [ 687 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_98_98_0 (state Temporary)
2025.01.05 00:16:13.589999 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Renaming temporary part tmp_insert_202501_98_98_0 to 202501_98_98_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:16:13.595205 [ 687 ] {} <Error> void DB::SystemLog<DB::AsynchronousMetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::AsynchronousMetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/tmp_insert_202501_98_98_0/"] ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/202501_98_98_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::AsynchronousMetricLogElement>::savingThreadFunction() @ 0x000000001104f30c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000cccfe94
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:16:13.595532 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushed system log up to offset 424474
2025.01.05 00:16:13.819193 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushing system log, 7 entries to flush up to offset 691
2025.01.05 00:16:13.838831 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:16:13.840798 [ 694 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.92 GiB.
2025.01.05 00:16:13.871823 [ 694 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_91_91_0 (state Temporary)
2025.01.05 00:16:13.893824 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Renaming temporary part tmp_insert_202501_91_91_0 to 202501_91_91_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:16:13.901040 [ 694 ] {} <Error> void DB::SystemLog<DB::MetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::MetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/tmp_insert_202501_91_91_0/"] ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/202501_91_91_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::MetricLogElement>::savingThreadFunction() @ 0x000000001105dfec
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000ccd0554
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:16:13.901689 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushed system log up to offset 691
2025.01.05 00:16:18.000835 [ 696 ] {} <Trace> AsynchronousMetrics: MemoryTracking: was 581.93 MiB, peak 604.33 MiB, free memory in arenas 83.17 MiB, will set to 590.31 MiB (RSS), difference: 8.38 MiB
2025.01.05 00:16:20.596326 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushing system log, 4305 entries to flush up to offset 428779
2025.01.05 00:16:20.604760 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:16:20.606853 [ 687 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.92 GiB.
2025.01.05 00:16:20.631724 [ 687 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_99_99_0 (state Temporary)
2025.01.05 00:16:20.644452 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Renaming temporary part tmp_insert_202501_99_99_0 to 202501_99_99_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:16:20.648499 [ 687 ] {} <Error> void DB::SystemLog<DB::AsynchronousMetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::AsynchronousMetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/tmp_insert_202501_99_99_0/"] ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/202501_99_99_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::AsynchronousMetricLogElement>::savingThreadFunction() @ 0x000000001104f30c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000cccfe94
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:16:20.648817 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushed system log up to offset 428779
2025.01.05 00:16:21.402108 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushing system log, 8 entries to flush up to offset 699
2025.01.05 00:16:21.425991 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:16:21.427077 [ 694 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.92 GiB.
2025.01.05 00:16:21.450165 [ 694 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_92_92_0 (state Temporary)
2025.01.05 00:16:21.472214 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Renaming temporary part tmp_insert_202501_92_92_0 to 202501_92_92_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:16:21.479183 [ 694 ] {} <Error> void DB::SystemLog<DB::MetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::MetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/tmp_insert_202501_92_92_0/"] ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/202501_92_92_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::MetricLogElement>::savingThreadFunction() @ 0x000000001105dfec
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000ccd0554
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:16:21.479572 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushed system log up to offset 699
2025.01.05 00:16:22.002112 [ 696 ] {} <Trace> AsynchronousMetrics: MemoryTracking: was 590.43 MiB, peak 604.33 MiB, free memory in arenas 83.11 MiB, will set to 591.80 MiB (RSS), difference: 1.38 MiB
2025.01.05 00:16:27.649597 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushing system log, 4305 entries to flush up to offset 433084
2025.01.05 00:16:27.657076 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:16:27.659086 [ 687 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.92 GiB.
2025.01.05 00:16:27.682827 [ 687 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_100_100_0 (state Temporary)
2025.01.05 00:16:27.696494 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Renaming temporary part tmp_insert_202501_100_100_0 to 202501_100_100_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:16:27.701636 [ 687 ] {} <Error> void DB::SystemLog<DB::AsynchronousMetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::AsynchronousMetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/tmp_insert_202501_100_100_0/"] ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/202501_100_100_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::AsynchronousMetricLogElement>::savingThreadFunction() @ 0x000000001104f30c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000cccfe94
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:16:27.702329 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushed system log up to offset 433084
2025.01.05 00:16:27.866005 [ 616 ] {} <Trace> CgroupsMemoryUsageObserver: Read current memory usage 299.69 MiB from cgroups
2025.01.05 00:16:27.980726 [ 294 ] {} <Debug> DNSResolver: Updating DNS cache
2025.01.05 00:16:27.982355 [ 294 ] {} <Debug> DNSResolver: Updated DNS cache
2025.01.05 00:16:28.000781 [ 696 ] {} <Trace> AsynchronousMetrics: MemoryTracking: was 591.55 MiB, peak 604.33 MiB, free memory in arenas 80.80 MiB, will set to 589.79 MiB (RSS), difference: -1.76 MiB
2025.01.05 00:16:28.979839 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushing system log, 8 entries to flush up to offset 707
2025.01.05 00:16:28.998415 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:16:29.000090 [ 694 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.92 GiB.
2025.01.05 00:16:29.000486 [ 696 ] {} <Trace> AsynchronousMetrics: MemoryTracking: was 593.80 MiB, peak 604.33 MiB, free memory in arenas 63.04 MiB, will set to 585.08 MiB (RSS), difference: -8.72 MiB
2025.01.05 00:16:29.022962 [ 694 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_93_93_0 (state Temporary)
2025.01.05 00:16:29.043883 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Renaming temporary part tmp_insert_202501_93_93_0 to 202501_93_93_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:16:29.050676 [ 694 ] {} <Error> void DB::SystemLog<DB::MetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::MetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/tmp_insert_202501_93_93_0/"] ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/202501_93_93_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::MetricLogElement>::savingThreadFunction() @ 0x000000001105dfec
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000ccd0554
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:16:29.051141 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushed system log up to offset 707
2025.01.05 00:16:30.001466 [ 696 ] {} <Trace> AsynchronousMetrics: MemoryTracking: was 581.02 MiB, peak 604.33 MiB, free memory in arenas 81.11 MiB, will set to 588.47 MiB (RSS), difference: 7.45 MiB
2025.01.05 00:16:31.000891 [ 696 ] {} <Trace> AsynchronousMetrics: MemoryTracking: was 588.47 MiB, peak 604.33 MiB, free memory in arenas 69.20 MiB, will set to 576.71 MiB (RSS), difference: -11.76 MiB
2025.01.05 00:16:34.702684 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushing system log, 4305 entries to flush up to offset 437389
2025.01.05 00:16:34.707233 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:16:34.708936 [ 687 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.92 GiB.
2025.01.05 00:16:34.736248 [ 687 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_101_101_0 (state Temporary)
2025.01.05 00:16:34.761151 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Renaming temporary part tmp_insert_202501_101_101_0 to 202501_101_101_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:16:34.767515 [ 687 ] {} <Error> void DB::SystemLog<DB::AsynchronousMetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::AsynchronousMetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/tmp_insert_202501_101_101_0/"] ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/202501_101_101_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::AsynchronousMetricLogElement>::savingThreadFunction() @ 0x000000001104f30c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000cccfe94
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:16:34.767835 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushed system log up to offset 437389
2025.01.05 00:16:36.551866 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushing system log, 7 entries to flush up to offset 714
2025.01.05 00:16:36.574154 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:16:36.576284 [ 694 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.92 GiB.
2025.01.05 00:16:36.601551 [ 694 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_94_94_0 (state Temporary)
2025.01.05 00:16:36.629073 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Renaming temporary part tmp_insert_202501_94_94_0 to 202501_94_94_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:16:36.637916 [ 694 ] {} <Error> void DB::SystemLog<DB::MetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::MetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/tmp_insert_202501_94_94_0/"] ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/202501_94_94_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::MetricLogElement>::savingThreadFunction() @ 0x000000001105dfec
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000ccd0554
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:16:36.638589 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushed system log up to offset 714
2025.01.05 00:16:39.000902 [ 696 ] {} <Trace> AsynchronousMetrics: MemoryTracking: was 576.79 MiB, peak 604.33 MiB, free memory in arenas 69.17 MiB, will set to 578.17 MiB (RSS), difference: 1.39 MiB
2025.01.05 00:16:41.769012 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushing system log, 4305 entries to flush up to offset 441694
2025.01.05 00:16:41.772155 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:16:41.774220 [ 687 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.92 GiB.
2025.01.05 00:16:41.795100 [ 687 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_102_102_0 (state Temporary)
2025.01.05 00:16:41.807755 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Renaming temporary part tmp_insert_202501_102_102_0 to 202501_102_102_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:16:41.812114 [ 687 ] {} <Error> void DB::SystemLog<DB::AsynchronousMetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::AsynchronousMetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/tmp_insert_202501_102_102_0/"] ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/202501_102_102_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::AsynchronousMetricLogElement>::savingThreadFunction() @ 0x000000001104f30c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000cccfe94
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:16:41.812638 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushed system log up to offset 441694
2025.01.05 00:16:42.866723 [ 616 ] {} <Trace> CgroupsMemoryUsageObserver: Read current memory usage 288.10 MiB from cgroups
2025.01.05 00:16:42.983514 [ 308 ] {} <Debug> DNSResolver: Updating DNS cache
2025.01.05 00:16:42.983953 [ 308 ] {} <Debug> DNSResolver: Updated DNS cache
2025.01.05 00:16:44.043985 [ 696 ] {} <Trace> AsynchronousMetrics: Update heavy metrics. Update period 1 sec. Update heavy metrics period 120 sec. Heavy metrics calculation elapsed: 0.0337405 sec.
2025.01.05 00:16:44.139707 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushing system log, 8 entries to flush up to offset 722
2025.01.05 00:16:44.163691 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:16:44.165596 [ 694 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.92 GiB.
2025.01.05 00:16:44.199044 [ 694 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_95_95_0 (state Temporary)
2025.01.05 00:16:44.223066 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Renaming temporary part tmp_insert_202501_95_95_0 to 202501_95_95_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:16:44.231086 [ 694 ] {} <Error> void DB::SystemLog<DB::MetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::MetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/tmp_insert_202501_95_95_0/"] ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/202501_95_95_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::MetricLogElement>::savingThreadFunction() @ 0x000000001105dfec
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000ccd0554
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:16:44.231548 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushed system log up to offset 722
2025.01.05 00:16:48.813118 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushing system log, 4305 entries to flush up to offset 445999
2025.01.05 00:16:48.816505 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:16:48.818176 [ 687 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.92 GiB.
2025.01.05 00:16:48.834093 [ 687 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_103_103_0 (state Temporary)
2025.01.05 00:16:48.848342 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Renaming temporary part tmp_insert_202501_103_103_0 to 202501_103_103_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:16:48.852991 [ 687 ] {} <Error> void DB::SystemLog<DB::AsynchronousMetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::AsynchronousMetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/tmp_insert_202501_103_103_0/"] ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/202501_103_103_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::AsynchronousMetricLogElement>::savingThreadFunction() @ 0x000000001104f30c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000cccfe94
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:16:48.853482 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushed system log up to offset 445999
2025.01.05 00:16:49.000976 [ 696 ] {} <Trace> AsynchronousMetrics: MemoryTracking: was 578.54 MiB, peak 604.33 MiB, free memory in arenas 69.09 MiB, will set to 580.30 MiB (RSS), difference: 1.76 MiB
2025.01.05 00:16:51.732349 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushing system log, 7 entries to flush up to offset 729
2025.01.05 00:16:51.754976 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:16:51.757075 [ 694 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.92 GiB.
2025.01.05 00:16:51.793611 [ 694 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_96_96_0 (state Temporary)
2025.01.05 00:16:51.818787 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Renaming temporary part tmp_insert_202501_96_96_0 to 202501_96_96_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:16:51.825505 [ 694 ] {} <Error> void DB::SystemLog<DB::MetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::MetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/tmp_insert_202501_96_96_0/"] ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/202501_96_96_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::MetricLogElement>::savingThreadFunction() @ 0x000000001105dfec
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000ccd0554
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:16:51.825952 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushed system log up to offset 729
2025.01.05 00:16:55.854544 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushing system log, 4305 entries to flush up to offset 450304
2025.01.05 00:16:55.868634 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:16:55.873574 [ 687 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.92 GiB.
2025.01.05 00:16:55.905572 [ 687 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_104_104_0 (state Temporary)
2025.01.05 00:16:55.920138 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Renaming temporary part tmp_insert_202501_104_104_0 to 202501_104_104_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:16:55.923925 [ 687 ] {} <Error> void DB::SystemLog<DB::AsynchronousMetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::AsynchronousMetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/tmp_insert_202501_104_104_0/"] ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/202501_104_104_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::AsynchronousMetricLogElement>::savingThreadFunction() @ 0x000000001104f30c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000cccfe94
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:16:55.924443 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushed system log up to offset 450304
2025.01.05 00:16:57.867688 [ 616 ] {} <Trace> CgroupsMemoryUsageObserver: Read current memory usage 290.23 MiB from cgroups
2025.01.05 00:16:57.984464 [ 284 ] {} <Debug> DNSResolver: Updating DNS cache
2025.01.05 00:16:57.984959 [ 284 ] {} <Debug> DNSResolver: Updated DNS cache
2025.01.05 00:16:59.002089 [ 696 ] {} <Trace> AsynchronousMetrics: MemoryTracking: was 580.26 MiB, peak 604.33 MiB, free memory in arenas 69.01 MiB, will set to 582.36 MiB (RSS), difference: 2.09 MiB
2025.01.05 00:16:59.326477 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushing system log, 8 entries to flush up to offset 737
2025.01.05 00:16:59.373941 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:16:59.375761 [ 694 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.92 GiB.
2025.01.05 00:16:59.403481 [ 694 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_97_97_0 (state Temporary)
2025.01.05 00:16:59.427686 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Renaming temporary part tmp_insert_202501_97_97_0 to 202501_97_97_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:16:59.435552 [ 694 ] {} <Error> void DB::SystemLog<DB::MetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::MetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/tmp_insert_202501_97_97_0/"] ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/202501_97_97_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::MetricLogElement>::savingThreadFunction() @ 0x000000001105dfec
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000ccd0554
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:16:59.435964 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushed system log up to offset 737
2025.01.05 00:17:02.925015 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushing system log, 4305 entries to flush up to offset 454609
2025.01.05 00:17:02.928234 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:17:02.929831 [ 687 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.92 GiB.
2025.01.05 00:17:02.952917 [ 687 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_105_105_0 (state Temporary)
2025.01.05 00:17:02.966899 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Renaming temporary part tmp_insert_202501_105_105_0 to 202501_105_105_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:17:02.971506 [ 687 ] {} <Error> void DB::SystemLog<DB::AsynchronousMetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::AsynchronousMetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/tmp_insert_202501_105_105_0/"] ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/202501_105_105_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::AsynchronousMetricLogElement>::savingThreadFunction() @ 0x000000001104f30c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000cccfe94
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:17:02.971905 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushed system log up to offset 454609
2025.01.05 00:17:06.936802 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushing system log, 8 entries to flush up to offset 745
2025.01.05 00:17:06.958538 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:17:06.960436 [ 694 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.92 GiB.
2025.01.05 00:17:07.000512 [ 696 ] {} <Trace> AsynchronousMetrics: MemoryTracking: was 591.27 MiB, peak 604.33 MiB, free memory in arenas 52.09 MiB, will set to 581.85 MiB (RSS), difference: -9.42 MiB
2025.01.05 00:17:07.002889 [ 694 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_98_98_0 (state Temporary)
2025.01.05 00:17:07.024980 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Renaming temporary part tmp_insert_202501_98_98_0 to 202501_98_98_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:17:07.032080 [ 694 ] {} <Error> void DB::SystemLog<DB::MetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::MetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/tmp_insert_202501_98_98_0/"] ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/202501_98_98_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::MetricLogElement>::savingThreadFunction() @ 0x000000001105dfec
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000ccd0554
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:17:07.032676 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushed system log up to offset 745
2025.01.05 00:17:08.000791 [ 696 ] {} <Trace> AsynchronousMetrics: MemoryTracking: was 572.91 MiB, peak 604.33 MiB, free memory in arenas 69.41 MiB, will set to 583.05 MiB (RSS), difference: 10.13 MiB
2025.01.05 00:17:09.972239 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushing system log, 4305 entries to flush up to offset 458914
2025.01.05 00:17:09.975426 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:17:09.977092 [ 687 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.92 GiB.
2025.01.05 00:17:10.000581 [ 696 ] {} <Trace> AsynchronousMetrics: MemoryTracking: was 583.05 MiB, peak 604.33 MiB, free memory in arenas 67.02 MiB, will set to 592.61 MiB (RSS), difference: 9.56 MiB
2025.01.05 00:17:10.003339 [ 687 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_106_106_0 (state Temporary)
2025.01.05 00:17:10.013819 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Renaming temporary part tmp_insert_202501_106_106_0 to 202501_106_106_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:17:10.017563 [ 687 ] {} <Error> void DB::SystemLog<DB::AsynchronousMetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::AsynchronousMetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/tmp_insert_202501_106_106_0/"] ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/202501_106_106_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::AsynchronousMetricLogElement>::savingThreadFunction() @ 0x000000001104f30c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000cccfe94
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:17:10.018002 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushed system log up to offset 458914
2025.01.05 00:17:11.001349 [ 696 ] {} <Trace> AsynchronousMetrics: MemoryTracking: was 592.59 MiB, peak 604.33 MiB, free memory in arenas 58.32 MiB, will set to 587.34 MiB (RSS), difference: -5.25 MiB
2025.01.05 00:17:12.869393 [ 616 ] {} <Trace> CgroupsMemoryUsageObserver: Read current memory usage 297.22 MiB from cgroups
2025.01.05 00:17:12.985359 [ 312 ] {} <Debug> DNSResolver: Updating DNS cache
2025.01.05 00:17:12.986217 [ 312 ] {} <Debug> DNSResolver: Updated DNS cache
2025.01.05 00:17:14.533735 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushing system log, 7 entries to flush up to offset 752
2025.01.05 00:17:14.585680 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:17:14.587531 [ 694 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.92 GiB.
2025.01.05 00:17:14.617214 [ 694 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_99_99_0 (state Temporary)
2025.01.05 00:17:14.642206 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Renaming temporary part tmp_insert_202501_99_99_0 to 202501_99_99_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:17:14.650824 [ 694 ] {} <Error> void DB::SystemLog<DB::MetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::MetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/tmp_insert_202501_99_99_0/"] ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/202501_99_99_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::MetricLogElement>::savingThreadFunction() @ 0x000000001105dfec
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000ccd0554
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:17:14.651285 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushed system log up to offset 752
2025.01.05 00:17:17.019086 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushing system log, 4920 entries to flush up to offset 463834
2025.01.05 00:17:17.022777 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:17:17.024789 [ 687 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.92 GiB.
2025.01.05 00:17:17.045051 [ 687 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_107_107_0 (state Temporary)
2025.01.05 00:17:17.058867 [ 687 ] {} <Trace> system.asynchronous_metric_log (a87f7e66-6a75-4b65-b27b-8ef59263e9e0): Renaming temporary part tmp_insert_202501_107_107_0 to 202501_107_107_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:17:17.063348 [ 687 ] {} <Error> void DB::SystemLog<DB::AsynchronousMetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::AsynchronousMetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/tmp_insert_202501_107_107_0/"] ["/var/lib/clickhouse/store/a87/a87f7e66-6a75-4b65-b27b-8ef59263e9e0/202501_107_107_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::AsynchronousMetricLogElement>::savingThreadFunction() @ 0x000000001104f30c
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::AsynchronousMetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000cccfe94
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:17:17.064328 [ 687 ] {} <Trace> SystemLog (system.asynchronous_metric_log): Flushed system log up to offset 463834
2025.01.05 00:17:18.001499 [ 696 ] {} <Trace> AsynchronousMetrics: MemoryTracking: was 586.68 MiB, peak 604.33 MiB, free memory in arenas 69.23 MiB, will set to 589.44 MiB (RSS), difference: 2.76 MiB
2025.01.05 00:17:20.000655 [ 696 ] {} <Trace> AsynchronousMetrics: MemoryTracking: was 589.44 MiB, peak 604.33 MiB, free memory in arenas 69.21 MiB, will set to 595.70 MiB (RSS), difference: 6.26 MiB
2025.01.05 00:17:22.151555 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushing system log, 8 entries to flush up to offset 760
2025.01.05 00:17:22.169624 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Trying to reserve 1.00 MiB using storage policy from min volume index 0
2025.01.05 00:17:22.171483 [ 694 ] {} <Trace> DiskLocal: Reserved 1.00 MiB on local disk `default`, having unreserved 550.92 GiB.
2025.01.05 00:17:22.197689 [ 694 ] {} <Trace> MergedBlockOutputStream: filled checksums 202501_100_100_0 (state Temporary)
2025.01.05 00:17:22.219706 [ 694 ] {} <Trace> system.metric_log (3691b675-9810-4542-abf7-a0f3586c0257): Renaming temporary part tmp_insert_202501_100_100_0 to 202501_100_100_0 with tid (1, 1, 00000000-0000-0000-0000-000000000000).
2025.01.05 00:17:22.227995 [ 694 ] {} <Error> void DB::SystemLog<DB::MetricLogElement>::flushImpl(const std::vector<LogElement> &, uint64_t) [LogElement = DB::MetricLogElement]: std::exception. Code: 1001, type: std::__1::__fs::filesystem::filesystem_error, e.what() = filesystem error: in rename: Permission denied ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/tmp_insert_202501_100_100_0/"] ["/var/lib/clickhouse/store/369/3691b675-9810-4542-abf7-a0f3586c0257/202501_100_100_0/"], Stack trace (when copying this message, always include the lines below):

0. std::system_error::system_error(std::error_code, String const&) @ 0x000000001710f435
1. std::__fs::filesystem::filesystem_error::filesystem_error[abi:v15000](String const&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code) @ 0x00000000170c63c4
2. void std::__fs::filesystem::__throw_filesystem_error[abi:v15000]<String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&>(String&, std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code const&) @ 0x00000000170c619d
3. std::__fs::filesystem::detail::(anonymous namespace)::ErrorHandler<void>::report(std::error_code const&) const (.llvm.1044553589876245905) @ 0x00000000170c8410
4. std::__fs::filesystem::__rename(std::__fs::filesystem::path const&, std::__fs::filesystem::path const&, std::error_code*) @ 0x00000000170cc67d
5. DB::DiskLocal::moveDirectory(String const&, String const&) @ 0x000000001033d889
6. DB::DataPartStorageOnDiskBase::rename(String, String, std::shared_ptr<Poco::Logger>, bool, bool) @ 0x0000000011ca3254
7. DB::IMergeTreeDataPart::renameTo(String const&, bool) @ 0x0000000011cd7bc1
8. DB::MergeTreeData::renameTempPartAndReplaceImpl(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&, std::vector<std::shared_ptr<DB::IMergeTreeDataPart const>, std::allocator<std::shared_ptr<DB::IMergeTreeDataPart const>>>*) @ 0x0000000011da14db
9. DB::MergeTreeData::renameTempPartAndAdd(std::shared_ptr<DB::IMergeTreeDataPart>&, DB::MergeTreeData::Transaction&, DB::DataPartsLock&) @ 0x0000000011da2ee5
10. DB::MergeTreeSink::finishDelayedChunk() @ 0x00000000121584ac
11. DB::runStep(std::function<void ()>, DB::ThreadStatus*, std::atomic<unsigned long>*) @ 0x000000001266371c
12. DB::ExceptionKeepingTransform::work() @ 0x0000000012662ecc
13. DB::ExecutionThreadContext::executeTask() @ 0x00000000123f3f1a
14. DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x00000000123e8470
15. DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x00000000123e7e88
16. DB::SystemLog<DB::MetricLogElement>::savingThreadFunction() @ 0x000000001105dfec
17. void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()>(DB::SystemLogBase<DB::MetricLogElement>::startup()::'lambda'()&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x000000000ccd0554
18. void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void ThreadPoolImpl<std::thread>::scheduleImpl<void>(std::function<void ()>, Priority, std::optional<unsigned long>, bool)::'lambda0'()>>(void*) @ 0x000000000cc8a74d
19. ? @ 0x00007f2012317609
20. ? @ 0x00007f201223c353

Cannot print extra info for Poco::Exception (version 24.3.6.48 (official build))
2025.01.05 00:17:22.228438 [ 694 ] {} <Trace> SystemLog (system.metric_log): Flushed system log up to offset 760
